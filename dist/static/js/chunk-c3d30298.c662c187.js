(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c3d30298"],{"3b12":function(e,t,a){"use strict";a("bd9b")},"6e23":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"aux-card"},[a("div",{staticClass:"header"},[a("div",{staticClass:"left"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.$refs.roleDialog.open()}}},[e._v("新增角色")])],1),a("div",{staticClass:"right"},[a("el-select",{staticClass:"margin-right-sm",staticStyle:{width:"100px"},attrs:{clearable:""},on:{change:e.changeState},model:{value:e.reqData.state,callback:function(t){e.$set(e.reqData,"state",t)},expression:"reqData.state"}},e._l(e.states,(function(e,t){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.name}})})),1),a("el-input",{staticStyle:{width:"320px"},attrs:{"prefix-icon":"el-icon-search",clearable:"",placeholder:"请输入角色名称/电话搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.changeKeyword(t)}},model:{value:e.reqData.keyword,callback:function(t){e.$set(e.reqData,"keyword",t)},expression:"reqData.keyword"}})],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataLoading,expression:"dataLoading"}],staticClass:"aux-table",attrs:{data:e.dataList,border:""}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{align:"left",width:"160",label:"角色名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.role_name))]}}])}),a("el-table-column",{attrs:{align:"left",label:"角色描述"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.remark))]}}])}),a("el-table-column",{attrs:{width:"90",align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatStateText")(t.row.state||1)))])]}}])}),a("el-table-column",{attrs:{width:"260",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editPermissions(t.row,t.$index)}}},[e._v("设置权限")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editRole(t.row,t.$index)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.deleteRole(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"padding dflex-c"},[a("el-pagination",{attrs:{background:"","page-size":e.pagination.pageSize,total:e.pagination.totalCount,"current-page":e.pagination.pageNo,"page-sizes":[15,20,50],layout:"total, prev, pager, next","hide-on-single-page":""},on:{"size-change":e.changePageSize,"current-change":e.changePageNo}})],1)],1),a("RoleDialog",{ref:"roleDialog",on:{change:e.fetchDataList}})],1)},n=[],l=a("2197"),o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增角色",visible:e.dialogVisible,width:"460px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"elForm",staticClass:"demo-formData",attrs:{model:e.formData,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"role_name"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请填写角色名称",clearable:""},model:{value:e.formData.role_name,callback:function(t){e.$set(e.formData,"role_name",t)},expression:"formData.role_name"}})],1),a("el-form-item",{attrs:{label:"角色描述",prop:"remark"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请填写角色名称",clearable:""},model:{value:e.formData.remark,callback:function(t){e.$set(e.formData,"remark",t)},expression:"formData.remark"}})],1)],1),a("div",{staticClass:"dflex-e padding-top-sm"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("保存")]),a("el-button",{attrs:{type:"default"},on:{click:e.close}},[e._v("取消")])],1)],1)},s=[],r={name:"RoleDialog",props:{},data(){return{dialogVisible:!1,dataLoading:!1,id:"",formData:{_id:"",role_name:"",remark:""},rules:{role_name:[{required:!0,message:"请填写角色名称",trigger:"blur"},{min:2,max:16,message:"长度在 2 到 16 个字符",trigger:"blur"}]}}},computed:{},methods:{async fetchData(){this.dataLoading=!0,Object(l["a"])("member/getRole",{id:this.id},{functionName:"xunda"}).then(e=>{this.dataLoading=!1})},submit(){this.$refs["elForm"].validate(e=>{e&&Object(l["a"])("member/saveRole",this.formData,{functionName:"xunda"}).then(e=>{this.$message.success("保存成功"),setTimeout(()=>{this.$emit("change"),this.close()},300)})})},open(e={}){e._id&&(this.formData={_id:e._id,role_name:e.role_name,remark:e.remark||""}),this.dialogVisible=!0},close(){this.dialogVisible=!1}}},c=r,d=(a("3b12"),a("2877")),u=Object(d["a"])(c,o,s,!1,null,null,null),m=u.exports,p={components:{RoleDialog:m},filters:{formatStateText(e){return 1==e||0==e?"正常":"停用"}},data(){return{permission:"store-query",states:[{name:"全部",value:""},{name:"启用",value:1},{name:"禁用",value:2}],dataLoading:!1,dataList:[],pagination:{totalCount:1,pageSize:12,pageNo:1},reqData:{state:"",keyword:""}}},mounted(){this.fetchDataList()},methods:{fetchDataList(){this.dataLoading=!0;const e=Object.assign({},this.reqData,this.pagination);Object(l["a"])("member/listRole",e,{functionName:"xunda"}).then(e=>{this.dataList=e.data||[],1==this.pagination.pageNo&&(this.pagination.totalCount=e.totalCount),this.dataLoading=!1})},changeState(){this.$common.debounce(()=>this.fetchDataList(),300,this)()},changeKeyword(){this.fetchDataList()},changePageNo(e){this.pagination.pageNo=e,this.fetchDataList()},changePageSize(e){this.pagination.pageNo=1,this.pagination.pageSize=e,this.fetchDataList()},editPermissions(e,t){this.$router.push({path:"/basic/member/role-detail/"+e._id})},editRole(e,t){this.$refs.roleDialog.open(e)},deleteRole(e,t){this.$confirm("确定要删除该角色？","警告提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(l["a"])("member/deleteRole",{roleId:e._id},{functionName:"xunda"}).then(e=>{this.fetchDataList(),this.$message({type:"success",message:"删除成功!"})})})}}},g=p,h=Object(d["a"])(g,i,n,!1,null,null,null);t["default"]=h.exports},bd9b:function(e,t,a){}}]);