(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-commons"],{"0e32":function(t,e,a){},"15f6":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-popover",{attrs:{placement:"bottom-start",width:"800",trigger:"click","popper-class":"popper-select"},model:{value:t.popoverVisible,callback:function(e){t.popoverVisible=e},expression:"popoverVisible"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLoading,expression:"dataLoading"}],staticClass:"aux-table",attrs:{data:t.dataList,border:"",fit:"",stripe:"","max-height":"250"},on:{"row-click":t.onRowClick}},[a("el-table-column",{attrs:{align:"left",label:"商品名称","min-width":"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),a("el-table-column",{attrs:{align:"left","min-width":"180",label:"商品条码",prop:"spec"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.code))]}}])}),a("el-table-column",{attrs:{align:"left","min-width":"180",label:"规格/属性",prop:"spec"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.spec_list&&e.row.spec_list.length>0?a("div",{},t._l(e.row.spec_list,(function(e,n){return a("span",{key:n,staticClass:"padding-right-sm"},[t._v(t._s(e.name)+"："+t._s(e.values.join("/")))])})),0):a("div",[t._v(t._s(e.row.spec))])]}}])}),a("el-table-column",{attrs:{width:"100",align:"center",label:"单位",prop:"unit"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.unit_desc?a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:e.row.unit_desc,placement:"top"}},[a("span",[t._v(" "+t._s(e.row.unit)+" "),a("i",{staticClass:"el-icon-warning-outline"})])]):a("span",[t._v(t._s(e.row.unit))])]}}])}),"bid_price"==t.mainPrice?a("el-table-column",{attrs:{width:"110",align:"right",label:"进货价"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("cent2yuan")(e.row.bid_price)))]}}],null,!1,2056989652)}):t._e(),a("el-table-column",{attrs:{width:"110",align:"right",label:"批发价"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("cent2yuan")(e.row.price)))]}}])}),a("el-table-column",{attrs:{width:"110",align:"right",label:"零售价"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("cent2yuan")(e.row.market_price)))]}}])})],1),a("div",{attrs:{slot:"reference"},slot:"reference"},[a("el-input",{staticClass:"w-full",attrs:{placeholder:"输入商品名称/条码查询",clearable:"",loading:t.dataLoading},on:{input:t.changeInput,focus:t.initLoad},model:{value:t.modelValue,callback:function(e){t.modelValue=e},expression:"modelValue"}})],1)],1),a("AuxGoodsSkuDialog",{ref:"auxGoodsSkuDialog",attrs:{"enable-ok":"","main-price":t.mainPrice}})],1)},i=[],o=(a("99af"),a("a15b"),a("2197")),s=a("c031"),l=a("1ea0"),r={name:"AuxSelectGoods",components:{AuxGoodsSkuDialog:l["a"]},props:{value:{type:[String,Array],default:function(){return""}},mainPrice:{type:String,default:"price"}},data:function(){return{popoverVisible:!1,dataLoading:!1,dataList:[].concat(Object(s["d"])()),modelValue:""}},methods:{initLoad:function(){this.dataList.length>0||this.querySearch()},changeInput:function(t){var e=this;this.inputTimer&&clearTimeout(this.inputTimer),this.inputTimer=setTimeout((function(){e.querySearch(t)}),300)},querySearch:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.dataLoading=!0,Object(o["a"])("goods/list",{pageSize:10,simple:!0,keyword:e},{functionName:"xunda"}).then((function(e){t.dataLoading=!1;var a=e.data||[];t.dataList=a,Object(s["f"])(a)}))},onRowClick:function(t,e){var a=this;this.modelValue=t.goods_id,this.popoverVisible=!1;var n=Object(s["b"])(this.modelValue);n.spec_list&&n.spec_list.length>0?this.$refs.auxGoodsSkuDialog.open({goods:n,confirm:function(t){var e=Object.assign({},n,t);e.sku_id=t.sku_id,e.unit=t.unit,e.unitdesc=t.unit_desc,e.spec=t.skus.join("/"),e.price=t.price,e.bid_price=t.bid_price,e.market_price=t.market_price,e.min_price=t.min_price,e.scale=t.scale,a.$nextTick((function(){a.$emit("input",a.modelValue),a.$emit("change",{goodsId:a.modelValue,goods:e})}))},cancel:function(){a.$nextTick((function(){a.modelValue="",a.$emit("input",a.modelValue)}))}}):this.$nextTick((function(){a.$emit("input",a.modelValue),a.$emit("change",{goodsId:a.modelValue,goods:n})}))}}},c=r,u=(a("c00c"),a("2877")),d=Object(u["a"])(c,n,i,!1,null,null,null);e["a"]=d.exports},"1aba":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"material-input__component",class:t.computedClasses},[a("div",{class:{iconClass:t.icon}},[t.icon?a("i",{staticClass:"el-input__icon material-input__icon",class:["el-icon-"+t.icon]}):t._e(),"email"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autocomplete:t.autoComplete,required:t.required,type:"email"},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),"url"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autocomplete:t.autoComplete,required:t.required,type:"url"},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),"number"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:t.name,placeholder:t.fillPlaceHolder,step:t.step,readonly:t.readonly,disabled:t.disabled,autocomplete:t.autoComplete,max:t.max,min:t.min,minlength:t.minlength,maxlength:t.maxlength,required:t.required,type:"number"},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),"password"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autocomplete:t.autoComplete,max:t.max,min:t.min,required:t.required,type:"password"},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),"tel"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autocomplete:t.autoComplete,required:t.required,type:"tel"},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),"text"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autocomplete:t.autoComplete,minlength:t.minlength,maxlength:t.maxlength,required:t.required,type:"text"},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),a("span",{staticClass:"material-input-bar"}),a("label",{staticClass:"material-label"},[t._t("default")],2)])])},i=[],o=(a("a9e3"),{name:"MdInput",props:{icon:String,name:String,type:{type:String,default:"text"},value:[String,Number],placeholder:String,readonly:Boolean,disabled:Boolean,min:String,max:String,step:String,minlength:Number,maxlength:Number,required:{type:Boolean,default:!0},autoComplete:{type:String,default:"off"},validateEvent:{type:Boolean,default:!0}},data:function(){return{currentValue:this.value,focus:!1,fillPlaceHolder:null}},computed:{computedClasses:function(){return{"material--active":this.focus,"material--disabled":this.disabled,"material--raised":Boolean(this.focus||this.currentValue)}}},watch:{value:function(t){this.currentValue=t}},methods:{handleModelInput:function(t){var e=t.target.value;this.$emit("input",e),"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.change",[e]),this.$emit("change",e)},handleMdFocus:function(t){this.focus=!0,this.$emit("focus",t),this.placeholder&&""!==this.placeholder&&(this.fillPlaceHolder=this.placeholder)},handleMdBlur:function(t){this.focus=!1,this.$emit("blur",t),this.fillPlaceHolder=null,"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.blur",[this.currentValue])}}}),s=o,l=(a("8cb3"),a("2877")),r=Object(l["a"])(s,n,i,!1,null,"9d7baaf6",null);e["a"]=r.exports},"1ea0":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"选择单品",visible:t.dialogVisible,top:"10vh",width:"500","before-close":t.close,"append-to-body":"","custom-class":"goods-sku-dialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"goods-sku-area dflex-s",style:t.styles},[a("div",{staticClass:"goods-img-box"},[a("img",{attrs:{src:t.goods.img||"/static/img/img-empty.png",alt:""}})]),a("div",{staticClass:"goods-sku-content flex1"},[a("div",{staticClass:"title"},[t._v(t._s(t.goods.name))]),(t.goods.unit_list||[]).length>1?a("div",{staticClass:"border-top"},[a("div",{staticClass:"block-title"},[t._v("单位")]),a("div",{staticClass:"block-box"},t._l(t.goods.unit_list,(function(e,n){return a("div",{key:n},[a("div",{staticClass:"item",class:{active:t.form.unit==e.unit},on:{click:function(a){return t.selectGoodsUnit(e,n)}}},[t._v(" "+t._s(e.unit+(e.unit_desc||""))+" ")])])})),0)]):t._e(),a("div",{staticClass:"border-top"}),t._l(t.goods.spec_list,(function(e,n){return a("div",{key:e.name},[a("div",{staticClass:"block-title"},[t._v(t._s(e.name))]),a("div",{staticClass:"block-box"},t._l(e.values,(function(i,o){return a("div",{key:i},[a("div",{staticClass:"item",class:{active:t.form.skus.includes(i)},on:{click:function(a){return t.selectGoodsSpec(e,n,i,o)}}},[t._v(" "+t._s(i)+" ")])])})),0)])})),a("div",{staticClass:"select-box"},[(t.goods.unit_list||[]).length>1?a("div",[a("span",{staticClass:"lable"},[t._v("已选单位：")]),a("span",{staticClass:"values"},[t._v(t._s(t.form.unit))])]):t._e(),(t.goods.spec_list||[]).length>0?a("div",[a("span",{staticClass:"lable"},[t._v("已选规格：")]),t.form.skus.length>0?a("span",{staticClass:"values"},[t._v(t._s(t.form.skus.join(" / ")))]):t._e()]):t._e()]),a("div",{staticClass:"bottom-box dflex-b"},[a("div",{staticClass:"price-box"},[t._v("¥"+t._s(t.compPricespan))]),t.enableOk?a("div",{staticClass:"btn-box"},[a("el-button",{attrs:{type:"default",size:"default"},on:{click:t.handleCancel}},[t._v("取消")]),a("el-button",{attrs:{type:"primary",size:"default"},on:{click:t.handleSubmit}},[t._v("确认选择")])],1):t._e()])],2)])])},i=[],o=(a("a9e3"),a("d81d"),a("a15b"),a("4de4"),a("d3b7"),a("b0c0"),a("99af"),{name:"AuxGoodsSkuDialog",props:{enableBuy:{type:Boolean,default:!1},enableOk:{type:Boolean,default:!1},mainPrice:{type:String,default:"price"},marginTop:{type:Number,default:0},styles:{type:Object,default:function(){return{}}}},data:function(){return{dialogVisible:!1,goods:{unit:"",unit_list:[],spec:"",spec_list:"",sku_data:[]},form:this.initForm(),confirm:function(){}}},computed:{compPricespan:function(){var t=this.form[this.mainPrice];return this.$common.cent2yuan(t)}},methods:{initForm:function(){return{sku_id:"",unit:"",skus:[],unit_desc:"",price:0,bid_price:0,market_price:0,min_price:0,scale:1,number:0}},open:function(t){var e=t.goods,a=t.confirm,n=t.cancel,i=t.initOpts,o=void 0===i?{}:i;(e.unit_prices||[]).length>0&&0===(e.spec_list||[]).length&&0===(e.unit_list||[]).length&&(e.unit_list=e.unit_prices.map((function(t){return{nit:t.unit,scale:t.scale||1}}))),0===(e.sku_datas||[]).length&&(e.unit_prices||[]).length>0&&(e.sku_datas=e.unit_prices),this.goods=e,this.form=Object.assign(this.initForm(),{unit:o.unit||e.unit,skus:o.skus||[]}),this.confirm=a,this.cancel=n,this.isSelectedOk=!1,this.dialogVisible=!0,this.changeComplated()},close:function(){this.dialogVisible=!1},selectGoodsUnit:function(t,e){this.form.unit=t.unit,this.form.unit_desc=t.unit_desc,this.form.scale=Number(t.scale||1),this.changeComplated()},selectGoodsSpec:function(t,e,a,n){this.form.skus.length=(this.goods.spec_list||[]).length,this.$set(this.form.skus,e,a),this.changeComplated()},changeComplated:function(){var t=this.goods,e=t.unit,a=t.unit_list||[],n=t.spec_list||[],i=t.sku_datas||[],o=a.length>1,s=n.length>0,l=this.form,r=l.unit,c=l.skus,u=void 0===c?[]:c;if(o||s||this.updateFormData(t),!o&&s&&u.length>0){var d=u.join("/"),h=i.filter((function(t){return t.name===d}));if(h.length>0){if(1!==h.length)throw"2.发现异常，当前规格的单品存在多个金额，规格：".concat(d);this.updateFormData(h[0])}}if(o&&!s)if(r===e)this.updateFormData(t);else{var f=i.filter((function(t){return t.unit===r}));if(0===f.length){var p=a.filter((function(t){return t.unit===r})),m=p[0].scale||1;this.updateFormData(t,m)}1===f.length&&this.updateFormData(f[0])}if(o&&s&&u.length>0){var g=u.join("/"),v=i.filter((function(t){return t.name===g})),b=v.filter((function(t){return t.unit===r}));if(b.length>0){if(1!==b.length)throw"4.1发现异常，当前规格的单品存在多个金额，单位：".concat(r,", 规格：").concat(g);this.updateFormData(b[0])}else if(v.length>0){var y=v.filter((function(t){return t.unit===e}));if(1!==y.length)throw"4.2发现异常，当前规格的单品存在多个金额，单位：".concat(r,", 规格：").concat(g);var _=a.filter((function(t){return t.unit===r})),x=_[0].scale||1;this.updateFormData(y[0],x)}}},updateFormData:function(t){var e=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=["price","market_price","bid_price","min_price"];n.forEach((function(n){e.$set(e.form,n,(t[n]||0)*a)})),this.form.sku_id=t.sku_id||"",this.isSelectedOk=!0},validatForm:function(){var t=this.form;t.unit,t.skus;if(!this.isSelectedOk)throw new Error("请选择商品单位及规格/属性参数")},handleSubmit:function(){try{this.validatForm(),this.confirm&&this.confirm(this.form),this.close()}catch(t){this.$message.error(t.message||t)}},handleCancel:function(){this.dialogVisible=!1,this.cancel&&this.cancel()}}}),s=o,l=(a("33fb"),a("2877")),r=Object(l["a"])(s,n,i,!1,null,null,null);e["a"]=r.exports},2051:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("el-select",{staticClass:"w-full",attrs:{filterable:"",placeholder:"输入客户名称/联系人/电话查询",loading:t.loading,clearable:!0,remote:"","remote-method":t.remoteMethod},on:{change:t.change,focus:t.initLoad},model:{value:t.modelValue,callback:function(e){t.modelValue=e},expression:"modelValue"}},t._l(t.dataList,(function(t){return a("el-option",{key:t._id,attrs:{label:t.name,value:t._id}})})),1)],1)},i=[],o=(a("99af"),a("4de4"),a("d3b7"),a("2197")),s=(a("d81d"),a("159b"),a("caad"),a("2532"),[]);function l(t){var e=s.map((function(t){return t._id}));t.filter((function(t){return!e.includes(t._id)})).forEach((function(t){return s.push(t)}))}var r={name:"AuxSelectStore",props:{value:{type:[String,Array],default:function(){return""}},multi:Boolean},data:function(){return{loading:!1,dataList:[].concat(s),modelValue:""}},watch:{value:{handler:function(t,e){this.modelValue=t,0===this.dataList.length&&t&&this.loadStore(t)},immediate:!0}},methods:{initLoad:function(){this.dataList.length>0||this.fetchData()},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";this.loading=!0,Object(o["a"])("store/listStore",{pageSize:12,simple:!0,keyword:e},{functionName:"xunda"}).then((function(e){t.loading=!1;var a=e.data||[];l(a),t.dataList=a}))},loadStore:function(t){var e=this;Object(o["a"])("store/getStore",{storeId:t},{functionName:"xunda"}).then((function(t){e.dataList=[t.data]}))},remoteMethod:function(t){var e=this;t&&""!==t?this.$common.debounce((function(){return e.fetchData(t)}),200)():this.dataList=[]},change:function(){var t=this;this.$nextTick((function(){if(t.$emit("input",t.modelValue),!t.multi){var e=t.dataList.filter((function(e){return e._id==t.modelValue}));e.length>0&&t.$emit("change",e[0])}}))}}},c=r,u=a("2877"),d=Object(u["a"])(c,n,i,!1,null,null,null);e["a"]=d.exports},"33fb":function(t,e,a){"use strict";a("0e32")},3796:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"excel-upload"},[a("input",{ref:"upload-input",staticClass:"upload-input",attrs:{type:"file",accept:".xlsx, .xls"},on:{change:t.handleClick}}),a("div",{staticClass:"drop-box",on:{drop:t.handleDrop,dragover:t.handleDragover,dragenter:t.handleDragover,click:t.handleUpload}},[a("div",{staticClass:"icon el-icon-upload"}),a("div",{staticClass:"txt fs"},[t._v("点击或将文件拖拽到这里上传")]),a("div",{staticClass:"tip fs-xs"},[t._v("仅支持xlsx/xls/csv文件，且不超过1M")])])])},i=[],o=(a("a9e3"),a("d3b7"),a("ac1f"),a("00b4"),a("b0c0"),a("25ca")),s={props:{skinRow:{type:Number,default:1},beforeUpload:Function,onSuccess:Function,onError:Function},data:function(){return{loading:!1,excelData:{header:null,results:null}}},methods:{generateData:function(t){var e=t.header,a=t.results;this.excelData.header=e,this.excelData.results=a,this.onSuccess&&this.onSuccess(this.excelData)},handleDrop:function(t){if(t.stopPropagation(),t.preventDefault(),!this.loading){var e=t.dataTransfer.files;if(1===e.length){var a=e[0];if(!this.isExcel(a))return this.$message.error("仅支持 .xlsx, .xls, .csv文件类型"),!1;this.upload(a),t.stopPropagation(),t.preventDefault()}else this.$message.error("只支持上传一个文件！")}},handleDragover:function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},handleUpload:function(){this.$refs["upload-input"].click()},handleClick:function(t){var e=t.target.files,a=e[0];a&&this.upload(a)},upload:function(t){if(this.$refs["upload-input"].value=null,this.beforeUpload){var e=this.beforeUpload(t);e&&this.readerData(t)}else this.readerData(t)},readerData:function(t){var e=this,a=this;return this.loading=!0,new Promise((function(n,i){var s=new FileReader;s.onload=function(t){try{var s=t.target.result;console.log(o);var l=o["read"](s,{type:"array"}),r=l.SheetNames[0],c=l.Sheets[r],u=e.getHeaderRow(c),d={range:a.skinRow,defval:""},h=o["utils"].sheet_to_json(c,d);e.generateData({header:u,results:h}),e.loading=!1,n()}catch(f){i(f),e.onError&&e.onError(f),e.$message.error("Excel文件解析失败"),e.loading=!1}},s.readAsArrayBuffer(t)}))},getHeaderRow:function(t){var e,a=[],n=o["utils"].decode_range(t["!ref"]),i=n.s.r+this.skinRow;for(e=n.s.c;e<=n.e.c;++e){var s=t[o["utils"].encode_cell({c:e,r:i})],l=" ";s&&s.t&&(l=o["utils"].format_cell(s)),a.push(l)}return a},isExcel:function(t){return/\.(xlsx|xls|csv)$/.test(t.name)}}},l=s,r=(a("566b"),a("2877")),c=Object(r["a"])(l,n,i,!1,null,"a5ed51f2",null);e["a"]=c.exports},"3cbc":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"pan-item",style:{zIndex:t.zIndex,height:t.height,width:t.width}},[a("div",{staticClass:"pan-info"},[a("div",{staticClass:"pan-info-roles-container"},[t._t("default")],2)]),a("div",{staticClass:"pan-thumb",style:{backgroundImage:"url("+t.image+")"}})])},i=[],o=(a("a9e3"),{name:"PanThumb",props:{image:{type:String,required:!0},zIndex:{type:Number,default:1},width:{type:String,default:"150px"},height:{type:String,default:"150px"}}}),s=o,l=(a("c0c1"),a("2877")),r=Object(l["a"])(s,n,i,!1,null,"799537af",null);e["a"]=r.exports},"3cce":function(t,e,a){"use strict";a("5a0d")},"434e":function(t,e,a){},5337:function(t,e,a){},"566b":function(t,e,a){"use strict";a("c604")},5874:function(t,e,a){"use strict";a("7a80")},"5a0d":function(t,e,a){},"64f8":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-button",{attrs:{type:"default",icon:"el-icon-tickets",loading:t.dataLoading},on:{click:t.generate}},[t.dataLoading?a("span",[t._v("正在导出("+t._s(t.dataProgress?t.dataProgress+"%":"...")+")")]):a("span",[t._v("导出")])])},i=[],o=a("b85c"),s=a("53ca"),l=a("c7eb"),r=a("1da1");a("a9e3"),a("ac1f"),a("5319"),a("b0c0"),a("b64b"),a("d81d"),a("466d"),a("a15b"),a("2ca0"),a("ace4"),a("d3b7"),a("8a59"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("00b4"),a("5cc6"),a("1276"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861");function c(t,e,a){var n,i,o=window,s="application/octet-stream",l=a||s,r=t,u=!e&&!a&&r,d=document.createElement("a"),h=function(t){return String(t)},f=o.Blob||o.MozBlob||o.WebKitBlob||h,p=e||"download";if(f=f.call?f.bind(o):Blob,"true"===String(this)&&(r=[r,l],l=r[0],r=r[1]),u&&u.length<2048&&(p=u.split("/").pop().split("?")[0],d.href=u,-1!==d.href.indexOf(u))){var m=new XMLHttpRequest;return m.open("GET",u,!0),m.responseType="blob",m.onload=function(t){c(t.target.response,p,s)},setTimeout((function(){m.send()}),0),m}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(r)){if(!(r.length>2096103.424&&f!==h))return navigator.msSaveBlob?navigator.msSaveBlob(y(r),p):_(r);r=y(r),l=r.type||s}else if(/([\x80-\xff])/.test(r)){var g=0,v=new Uint8Array(r.length),b=v.length;for(g;g<b;++g)v[g]=r.charCodeAt(g);r=new f([v],{type:l})}function y(t){var e=t.split(/[:;,]/),a=e[1],n="base64"==e[2]?atob:decodeURIComponent,i=n(e.pop()),o=i.length,s=0,l=new Uint8Array(o);for(s;s<o;++s)l[s]=i.charCodeAt(s);return new f([l],{type:a})}function _(t,e){if("download"in d)return d.href=t,d.setAttribute("download",p),d.className="download-js-link",d.innerHTML="downloading...",d.style.display="none",document.body.appendChild(d),setTimeout((function(){d.click(),document.body.removeChild(d),!0===e&&setTimeout((function(){o.URL.revokeObjectURL(d.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,s)),window.open(t)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=t),!0;var a=document.createElement("iframe");document.body.appendChild(a),!e&&/^data:/.test(t)&&(t="data:"+t.replace(/^data:([\w\/\-\+]+)/,s)),a.src=t,setTimeout((function(){document.body.removeChild(a)}),333)}if(n=r instanceof f?r:new f([r],{type:l}),navigator.msSaveBlob)return navigator.msSaveBlob(n,p);if(o.URL)_(o.URL.createObjectURL(n),!0);else{if("string"===typeof n||n.constructor===h)try{return _("data:"+l+";base64,"+o.btoa(n))}catch(x){return _("data:"+l+","+encodeURIComponent(n))}i=new FileReader,i.onload=function(t){_(this.result)},i.readAsDataURL(n)}return!0}var u={name:"DownloadExcel",props:{type:{type:String,default:"xls"},data:{type:Array,required:!1,default:null},fields:{type:Object,default:function(){return null}},exportFields:{type:Object,default:function(){return null}},defaultValue:{type:String,required:!1,default:""},header:{default:null},footer:{default:null},name:{type:String,default:"data.xls"},fetch:{type:Function},progress:{type:Number,default:0},meta:{type:Array,default:function(){return[]}},worksheet:{type:String,default:"Sheet1"},beforeGenerate:{type:Function},beforeFinish:{type:Function},escapeCsv:{type:Boolean,default:!0},stringifyLongNum:{type:Boolean,default:!1}},data:function(){return{dataLoading:!1,dataProgress:0}},computed:{idName:function(){var t=(new Date).getTime();return"export_"+t},downloadFields:function(){return this.fields?this.fields:this.exportFields?this.exportFields:void 0}},watch:{progress:{immediate:!0,handler:function(t,e){e!=t&&(this.dataProgress=t)}}},methods:{generate:function(){var t=this;return Object(r["a"])(Object(l["a"])().mark((function e(){var a,n;return Object(l["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.dataLoading){e.next=2;break}return e.abrupt("return");case 2:if(t.dataLoading=!0,"function"!==typeof t.beforeGenerate){e.next=6;break}return e.next=6,t.beforeGenerate();case 6:if(a=t.data,"function"!==typeof t.fetch&&a){e.next=11;break}return e.next=10,t.fetch();case 10:a=e.sent;case 11:if(setTimeout((function(){t.dataProgress=0,t.dataLoading=!1}),300),a&&a.length){e.next=14;break}return e.abrupt("return");case 14:if(n=t.getProcessedJson(a,t.downloadFields),"html"!==t.type){e.next=20;break}return e.abrupt("return",t.export(t.jsonToXLS(n),t.name.replace(".xls",".html"),"text/html"));case 20:if("csv"!==t.type){e.next=22;break}return e.abrupt("return",t.export(t.jsonToCSV(n),t.name.replace(".xls",".csv"),"application/csv"));case 22:return e.abrupt("return",t.export(t.jsonToXLS(n),t.name,"application/vnd.ms-excel"));case 23:case"end":return e.stop()}}),e)})))()},export:function(){var t=Object(r["a"])(Object(l["a"])().mark((function t(e,a,n){var i;return Object(l["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=this.base64ToBlob(e,n),"function"!==typeof this.beforeFinish){t.next=4;break}return t.next=4,this.beforeFinish();case 4:c(i,a,n);case 5:case"end":return t.stop()}}),t,this)})));function e(e,a,n){return t.apply(this,arguments)}return e}(),jsonToXLS:function(t){var e='<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><meta name=ProgId content=Excel.Sheet> <meta name=Generator content="Microsoft Excel 11"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">\x3c!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>${worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e<style>br {mso-data-placement: same-cell;}</style></head><body><table>${table}</table></body></html>',a="<thead>",n=Object.keys(t[0]).length,i=this,o=this.header||this.$attrs.title;for(var s in o&&(a+=this.parseExtraData(o,'<tr><th colspan="'+n+'">${data}</th></tr>')),a+="<tr>",t[0])a+="<th>"+s+"</th>";return a+="</tr>",a+="</thead>",a+="<tbody>",t.map((function(t,e){for(var n in a+="<tr>",t)a+="<td>"+i.preprocessLongNum(i.valueReformattedForMultilines(t[n]))+"</td>";a+="</tr>"})),a+="</tbody>",null!=this.footer&&(a+="<tfoot>",a+=this.parseExtraData(this.footer,'<tr><td colspan="'+n+'">${data}</td></tr>'),a+="</tfoot>"),e.replace("${table}",a).replace("${worksheet}",this.worksheet)},jsonToCSV:function(t){var e=this,a=[],n=this.header||this.$attrs.title;for(var i in n&&a.push(this.parseExtraData(n,"${data}\r\n")),t[0])a.push(i),a.push(",");return a.pop(),a.push("\r\n"),t.map((function(t){for(var n in t){var i=t[n]+"";e.escapeCsv&&(i='="'+i+'"',i.match(/[,"\n]/)&&(i='"'+i.replace(/\"/g,'""')+'"')),a.push(i),a.push(",")}a.pop(),a.push("\r\n")})),null!=this.footer&&a.push(this.parseExtraData(this.footer,"${data}\r\n")),a.join("")},getProcessedJson:function(t,e){var a=this.getKeys(t,e),n=[],i=this;return t.map((function(t,e){var o={};for(var s in a){var l=a[s];o[s]=i.getValue(l,t)}n.push(o)})),n},getKeys:function(t,e){if(e)return e;var a={};for(var n in t[0])a[n]=n;return a},parseExtraData:function(t,e){var a="";if(Array.isArray(t))for(var n=0;n<t.length;n++)t[n]&&(a+=e.replace("${data}",t[n]));else a+=e.replace("${data}",t);return a},getValue:function(t,e){var a="object"!==Object(s["a"])(t)?t:t.field,n="string"!==typeof a?[]:a.split("."),i=this.defaultValue;return i=a?n.length>1?this.getValueFromNestedItem(e,n):this.parseValue(e[a]):e,t.hasOwnProperty("callback")&&(i=this.getValueFromCallback(i,t.callback)),i},valueReformattedForMultilines:function(t){return"string"===typeof t?t.replace(/\n/gi,"<br/>"):t},preprocessLongNum:function(t){if(this.stringifyLongNum){if(String(t).startsWith("0x"))return t;if(!isNaN(t)&&""!=t&&(t>99999999999||t<1e-13))return'="'+t+'"'}return t},getValueFromNestedItem:function(t,e){var a,n=t,i=Object(o["a"])(e);try{for(i.s();!(a=i.n()).done;){var s=a.value;n&&(n=n[s])}}catch(l){i.e(l)}finally{i.f()}return this.parseValue(n)},getValueFromCallback:function(t,e){if("function"!==typeof e)return this.defaultValue;var a=e(t);return this.parseValue(a)},parseValue:function(t){return t||0===t||"boolean"===typeof t?t:this.defaultValue},base64ToBlob:function(t,e){var a=window.btoa(window.unescape(encodeURIComponent(t))),n=atob(a),i=n.length,o=new Uint8ClampedArray(i);while(i--)o[i]=n.charCodeAt(i);return new Blob([o],{type:e})}}},d=u,h=(a("5874"),a("2877")),f=Object(h["a"])(d,n,i,!1,null,null,null);e["a"]=f.exports},"6de6":function(t,e,a){},"76f5":function(t,e,a){"use strict";a("f491")},"7a80":function(t,e,a){},8256:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"tinymce-container",class:{fullscreen:t.fullscreen},style:{width:t.containerWidth}},[a("textarea",{staticClass:"tinymce-textarea",attrs:{id:t.tinymceId}}),t._v(" "),a("div",{staticClass:"editor-custom-btn-container"},[a("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:t.imageSuccessCBK}})],1)])},i=[],o=(a("b680"),a("a9e3"),a("ac1f"),a("00b4"),a("d3b7"),a("159b"),function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload-container"},[a("el-button",{style:{background:t.color,borderColor:t.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v(" upload ")]),a("el-dialog",{attrs:{visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-upload",{staticClass:"editor-slide-upload",attrs:{multiple:!0,"file-list":t.fileList,"show-file-list":!0,"on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload,action:"https://httpbin.org/post","list-type":"picture-card"}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v(" Click upload ")])],1),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v(" Cancel ")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v(" Confirm ")])],1)],1)}),s=[],l=(a("b64b"),a("d81d"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),{name:"EditorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var t=this;return Object.keys(this.listObj).every((function(e){return t.listObj[e].hasSuccess}))},handleSubmit:function(){var t=this,e=Object.keys(this.listObj).map((function(e){return t.listObj[e]}));this.checkAllSuccess()?(this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("Please wait for all images to be uploaded successfully. If there is a network problem, please refresh the page and upload again!")},handleSuccess:function(t,e){for(var a=e.uid,n=Object.keys(this.listObj),i=0,o=n.length;i<o;i++)if(this.listObj[n[i]].uid===a)return this.listObj[n[i]].url=t.files.file,void(this.listObj[n[i]].hasSuccess=!0)},handleRemove:function(t){for(var e=t.uid,a=Object.keys(this.listObj),n=0,i=a.length;n<i;n++)if(this.listObj[a[n]].uid===e)return void delete this.listObj[a[n]]},beforeUpload:function(t){var e=this,a=window.URL||window.webkitURL,n=t.uid;return this.listObj[n]={},new Promise((function(i,o){var s=new Image;s.src=a.createObjectURL(t),s.onload=function(){e.listObj[n]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},i(!0)}))}}}),r=l,c=(a("3cce"),a("2877")),u=Object(c["a"])(r,o,s,!1,null,"3dae379b",null),d=u.exports,h=["advlist anchor autolink autosave code codesample colorpicker colorpicker contextmenu directionality emoticons fullscreen hr image imagetools insertdatetime link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],f=h,p=["searchreplace bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap preview anchor pagebreak insertdatetime media table emoticons forecolor backcolor fullscreen"],m=p,g=a("b85c"),v=[];function b(){return window.tinymce}var y=function(t,e){var a=document.getElementById(t),n=e||function(){};if(!a){var i=document.createElement("script");i.src=t,i.id=t,document.body.appendChild(i),v.push(n);var o="onload"in i?s:l;o(i)}function s(e){e.onload=function(){this.onerror=this.onload=null;var t,a=Object(g["a"])(v);try{for(a.s();!(t=a.n()).done;){var n=t.value;n(null,e)}}catch(i){a.e(i)}finally{a.f()}v=null},e.onerror=function(){this.onerror=this.onload=null,n(new Error("Failed to load "+t),e)}}function l(t){t.onreadystatechange=function(){if("complete"===this.readyState||"loaded"===this.readyState){this.onreadystatechange=null;var e,a=Object(g["a"])(v);try{for(a.s();!(e=a.n()).done;){var n=e.value;n(null,t)}}catch(i){a.e(i)}finally{a.f()}v=null}}}a&&n&&(b()?n(null,a):v.push(n))},_=y,x="https://cdn.jsdelivr.net/npm/tinymce-all-in-one@4.9.3/tinymce.min.js",k={name:"Tinymce",components:{editorImage:d},props:{id:{type:String,default:function(){return"vue-tinymce-"+ +new Date+(1e3*Math.random()).toFixed(0)}},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{type:String,default:"file edit insert view format table"},height:{type:[Number,String],required:!1,default:360},width:{type:[Number,String],required:!1,default:"auto"}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id,fullscreen:!1,languageTypeList:{en:"en",zh:"zh_CN",es:"es_MX",ja:"ja"}}},computed:{containerWidth:function(){var t=this.width;return/^[\d]+(\.[\d]+)?$/.test(t)?"".concat(t,"px"):t}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick((function(){return window.tinymce.get(e.tinymceId).setContent(t||"")}))}},mounted:function(){this.init()},activated:function(){window.tinymce&&this.initTinymce()},deactivated:function(){this.destroyTinymce()},destroyed:function(){this.destroyTinymce()},methods:{init:function(){var t=this;_(x,(function(e){e?t.$message.error(e.message):t.initTinymce()}))},initTinymce:function(){var t=this,e=this;window.tinymce.init({selector:"#".concat(this.tinymceId),language:this.languageTypeList["en"],height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:m,menubar:this.menubar,plugins:f,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",imagetools_cors_hosts:["www.tinymce.com","codepen.io"],default_link_target:"_blank",link_title:!1,nonbreaking_force_tab:!0,init_instance_callback:function(a){e.value&&a.setContent(e.value),e.hasInit=!0,a.on("NodeChange Change KeyUp SetContent",(function(){t.hasChange=!0,t.$emit("input",a.getContent())}))},setup:function(t){t.on("FullscreenStateChanged",(function(t){e.fullscreen=t.state}))},convert_urls:!1})},destroyTinymce:function(){var t=window.tinymce.get(this.tinymceId);this.fullscreen&&t.execCommand("mceFullScreen"),t&&t.destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent()},imageSuccessCBK:function(t){var e=this;t.forEach((function(t){return window.tinymce.get(e.tinymceId).insertContent('<img class="wscnph" src="'.concat(t.url,'" >'))}))}}},w=k,C=(a("e1d7"),Object(c["a"])(w,n,i,!1,null,"6c71010c",null));e["a"]=C.exports},"8cb3":function(t,e,a){"use strict";a("bef99")},b122:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"选择商品",visible:t.dialogVisible,top:"10vh",width:"70%","before-close":t.close,"append-to-body":"","custom-class":"goods-list-dialog"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("div",{staticClass:"dialog-warpper"},[a("div",{staticClass:"dflex-b padding-tb"},[a("div"),a("div",{staticClass:"dflex"},[a("el-input",{staticStyle:{width:"360px"},attrs:{"prefix-icon":"el-icon-search",clearable:"",placeholder:"输入商品名称、编号按回车键搜索"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.fetchDataList(e)}},model:{value:t.reqData.keyword,callback:function(e){t.$set(t.reqData,"keyword",e)},expression:"reqData.keyword"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-search"},on:{click:t.handleSearch},slot:"append"})],1)],1)]),a("div",{staticClass:"dflex-s"},[a("div",{staticClass:"category"},[a("div",{staticClass:"title-box dflex-b"},[a("div",{staticClass:"padding"},[t._v("商品分类")])]),a("div",{staticClass:"cate-list"},[a("div",{staticClass:"item padding-sm",class:{active:""==t.reqData.cid},on:{click:function(e){return t.changeCategory()}}},[a("span",[t._v("全部分类")])]),t._l(t.categoryList,(function(e,n){return a("div",{key:e._id,staticClass:"item padding-sm",class:{active:t.reqData.cid==e._id},on:{click:function(a){return t.changeCategory(e)}}},[a("span",[t._v(t._s(e.name))])])}))],2)]),a("div",{staticClass:"flex1"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLoading,expression:"dataLoading"}],attrs:{data:t.dataList,border:"",fit:"",stripe:""}},[a("el-table-column",{attrs:{type:"index",width:"55",align:"center",label:"序号"}}),a("el-table-column",{attrs:{width:"110",align:"center",label:"数量",prop:"code"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{class:{"is-active":e.row.goods_cnt>0}},[a("el-input",{staticClass:"tac",attrs:{oninput:"value=value.match(/^\\d+(?:\\.\\d{0,2})?/)",placeholder:"数量"},on:{focus:function(a){return t.handleItemNumberFocus(e.row,e.$index)},change:function(a){return t.handleItemNumberChange(e.row,e.$index)}},model:{value:e.row.goods_cnt,callback:function(a){t.$set(e.row,"goods_cnt",a)},expression:"scope.row.goods_cnt"}})],1)]}}])}),a("el-table-column",{attrs:{align:"left",label:"商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",{staticClass:"dflex"},[a("el-avatar",{attrs:{shape:"square",size:40,fit:"cover",src:e.row.img||"/static/img/img-empty.png"}}),a("div",{staticClass:"padding-left-sm"},[a("div",[t._v(t._s(e.row.name))]),e.row.code?a("div",{staticClass:"ft-grey fs-xs"},[t._v("No."+t._s(e.row.code))]):t._e()])],1)]}}])}),a("el-table-column",{attrs:{align:"left",label:"规格属性",prop:"spec"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.spec_list&&e.row.spec_list.length>0?a("div",{},t._l(e.row.spec_list,(function(e,n){return a("div",{key:n,staticClass:"padding-right-sm"},[t._v(t._s(e.name)+"："+t._s(e.values.join("/")))])})),0):t._e(),a("div",[t._v(t._s(e.row.spec||""))])]}}])}),a("el-table-column",{attrs:{width:"140",align:"center",label:"基本单位",prop:"unit"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.unit))])]}}])}),a("el-table-column",{attrs:{width:"140",align:"right",label:"批发价(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("cent2yuan")(e.row.price)))]}}])}),a("el-table-column",{attrs:{width:"140",align:"right",label:"可用库存"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.stock_num))]}}])})],1),a("div",{staticClass:"padding-sm dflex-c"},[a("el-pagination",{attrs:{background:"","page-size":t.pagination.pageSize,total:t.pagination.totalCount,"current-page":t.pagination.pageNo,"page-sizes":[10,20,30],layout:"total, sizes, prev, pager, next, jumper","hide-on-single-page":""},on:{"size-change":t.changePageSize,"current-change":t.changePageNo}})],1)],1)])]),a("div",{staticClass:"dflex-b border-top padding-top",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["goods-edit"],expression:"['goods-edit']"}],attrs:{type:"default",icon:"el-icon-plus"},on:{click:function(e){return t.$common.toPage("/goods/goods-create")}}},[t._v("新增商品")]),a("div",[a("el-button",{on:{click:t.close}},[t._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确定提交")])],1)],1),a("AuxGoodsSkuDialog",{ref:"auxGoodsSkuDialog",attrs:{"enable-ok":"","main-price":t.mainPrice}})],1)},i=[],o=a("2909"),s=(a("d81d"),a("a15b"),a("4de4"),a("d3b7"),a("159b"),a("2197")),l=a("1ea0"),r=a("c031"),c={components:{AuxGoodsSkuDialog:l["a"]},props:{mainPrice:{type:String,default:"price"}},data:function(){return{dialogVisible:!1,cateParentId:"",categoryList:Object(o["a"])(Object(r["c"])()),dataLoading:!1,dataList:[],pagination:{totalCount:1,pageSize:10,pageNo:1},reqData:{cid:"",keyword:""},selectedGoodsMap:{}}},methods:{open:function(){this.dialogVisible=!0,this.fetchCategory("init"),this.fetchDataList("init"),this.selectedGoodsMap={}},close:function(){this.dialogVisible=!1},fetchCategory:function(t){var e=this;"init"===t&&this.categoryList.length>0||Object(s["a"])("goods/listGoodsCategory",{parentId:this.cateParentId},{functionName:"xunda"}).then((function(t){e.categoryList=t.data||[],Object(r["e"])(e.categoryList)}))},fetchDataList:function(t){var e=this;if("init"===t&&this.dataList.length>0){var a=Object(r["d"])().map((function(t){return t.goods_cnt="",t}));this.dataList=Object(o["a"])(a)}else{this.dataLoading=!0;var n=Object.assign({},this.getReqData(),this.pagination);Object(s["a"])("goods/list",n,{functionName:"xunda"}).then((function(t){e.dataLoading=!1;var a=t.data||[];Object(r["f"])(a),e.dataList=a.map((function(t){return t.goods_cnt="",t})),1===e.pagination.pageNo&&(e.pagination.totalCount=t.totalCount)}))}},addSelected:function(t){this.selectedGoodsMap[t.goods_id]||(this.selectedGoodsMap[t.goods_id]=[]),this.selectedGoodsMap[t.goods_id].push(t)},handleItemNumberChange:function(t){},handleItemNumberFocus:function(t){var e=this;if(!(t.goods_cnt>0)&&t.spec_list&&0!==t.spec_list.length){var a=Object(r["b"])(t.goods_id);this.$refs.auxGoodsSkuDialog.open({goods:a,confirm:function(n){var i=Object.assign({},a,n);i.sku_id=n.sku_id,i.unit=n.unit,i.unit_desc=n.unit_desc,i.spec=n.skus.join("/"),i.price=n.price,i.bid_price=n.bid_price,i.market_price=n.market_price,i.min_price=n.min_price,i.scale=n.scale,t.goods_cnt=1,e.addSelected(i)}})}},getGoodsUnitSelectOptions:function(t){var e=t.unit_list||[];if(e.length>0){var a=e[0],n=[{label:"基本单位",children:[a]}],i=t.unit_list.filter((function(t){return t.unit!==a.unit}));return i.length>0&&n.push({label:"辅助单位",children:i}),n}},getReqData:function(){return Object.assign({showStock:!0},this.reqData)},handleSearch:function(){this.fetchDataList()},changePageNo:function(t){this.pagination.pageNo=t,this.fetchDataList()},changePageSize:function(t){this.pagination.pageNo=1,this.pagination.pageSize=t,this.fetchDataList()},changeCategory:function(t){this.reqData.cid=t?t._id:"",this.pagination.pageNo=1,this.fetchDataList()},handleSubmit:function(){var t=this,e=this.dataList.filter((function(t){return t.goods_cnt>0})),a=[];e.forEach((function(e){if(t.selectedGoodsMap[e.goods_id]){var n=t.selectedGoodsMap[e.goods_id].map((function(t){return t.goods_cnt=e.goods_cnt,t}));a.push.apply(a,Object(o["a"])(n))}else a.push(e)})),this.$emit("onSuccess",a),this.close()}}},u=c,d=(a("76f5"),a("2877")),h=Object(d["a"])(u,n,i,!1,null,null,null);e["a"]=h.exports},b804:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{style:{height:t.height+"px",zIndex:t.zIndex}},[a("div",{class:t.className,style:{top:t.isSticky?t.stickyTop+"px":"",zIndex:t.zIndex,position:t.position,width:t.width,height:t.height+"px"}},[t._t("default",[a("div",[t._v("sticky")])])],2)])},i=[],o=(a("a9e3"),a("2c3e"),{name:"Sticky",props:{stickyTop:{type:Number,default:0},zIndex:{type:Number,default:1},className:{type:String,default:""}},data:function(){return{active:!1,position:"",width:void 0,height:void 0,isSticky:!1}},mounted:function(){this.height=this.$el.getBoundingClientRect().height,window.addEventListener("scroll",this.handleScroll),window.addEventListener("resize",this.handleResize)},activated:function(){this.handleScroll()},destroyed:function(){window.removeEventListener("scroll",this.handleScroll),window.removeEventListener("resize",this.handleResize)},methods:{sticky:function(){this.active||(this.position="fixed",this.active=!0,this.width=this.width+"px",this.isSticky=!0)},handleReset:function(){this.active&&this.reset()},reset:function(){this.position="",this.width="auto",this.active=!1,this.isSticky=!1},handleScroll:function(){var t=this.$el.getBoundingClientRect().width;this.width=t||"auto";var e=this.$el.getBoundingClientRect().top;e<this.stickyTop?this.sticky():this.handleReset()},handleResize:function(){this.isSticky&&(this.width=this.$el.getBoundingClientRect().width+"px")}}}),s=o,l=a("2877"),r=Object(l["a"])(s,n,i,!1,null,null,null);e["a"]=r.exports},b866:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w-full"},[a("el-select",{staticClass:"w-full",attrs:{filterable:"",placeholder:"请选择成员",clearable:!0,multiple:t.multi},on:{change:t.change,focus:t.initLoad},model:{value:t.modelValue,callback:function(e){t.modelValue=e},expression:"modelValue"}},t._l(t.dataList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1)},i=[],o=(a("d81d"),a("b0c0"),a("4de4"),a("d3b7"),a("2197")),s={name:"AuxSelectMember",props:{value:{type:[String,Array],default:function(){return[]}},multi:Boolean},data:function(){return{dataList:[],modelValue:[]}},watch:{value:{handler:function(t,e){this.modelValue=t,0===this.dataList.length&&t&&this.fetchData(t)},immediate:!0}},methods:{initLoad:function(){0===this.dataList.length&&this.fetchData()},fetchData:function(){var t=this;Object(o["a"])("member/listMember",{pageSize:100,simple:!0},{functionName:"xunda"}).then((function(e){var a=(e.data||[]).map((function(t){return t.name=t.member_name,t.value=t._id,t}));t.dataList=a}))},change:function(){var t=this;this.$nextTick((function(){if(t.$emit("input",t.modelValue),!t.multi){var e=t.dataList.filter((function(e){return e._id==t.modelValue}));e.length>0&&t.$emit("change",e[0])}}))}}},l=s,r=a("2877"),c=Object(r["a"])(l,n,i,!1,null,null,null);e["a"]=c.exports},bef99:function(t,e,a){},c00c:function(t,e,a){"use strict";a("5337")},c0c1:function(t,e,a){"use strict";a("6de6")},c3dd:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"w-full"},[a("el-select",{staticClass:"w-full",attrs:{filterable:"",placeholder:"请选择商品仓库",clearable:!0,multiple:t.multi,loading:t.loading},on:{change:t.change,focus:t.initLoad},model:{value:t.modelValue,callback:function(e){t.modelValue=e},expression:"modelValue"}},t._l(t.dataList,(function(t){return a("el-option",{key:t.value,attrs:{label:t.name,value:t.value}})})),1)],1)},i=[],o=(a("d81d"),a("b0c0"),a("2197")),s={name:"AuxSelectWarehouse",props:{value:{type:[String,Array],default:function(){return[]}},multi:Boolean},data:function(){return{loading:!1,dataList:[],modelValue:[]}},methods:{initLoad:function(){0===this.dataList.length&&this.fetchData()},fetchData:function(){var t=this;Object(o["a"])("stock/listWarehouse",{pageSize:20,simple:!0},{functionName:"xunda"}).then((function(e){t.dataList=(e.data||[]).map((function(t){return t.text=t.name,t.value=t._id,t}))}))},change:function(){var t=this;this.$nextTick((function(){t.$emit("input",t.modelValue),t.$emit("change",t.modelValue)}))}}},l=s,r=a("2877"),c=Object(r["a"])(l,n,i,!1,null,null,null);e["a"]=c.exports},c604:function(t,e,a){},d262:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-select",{staticClass:"w-full",attrs:{filterable:"",placeholder:"输入供应商名称/联系人/电话查询",clearable:!0},on:{change:t.change,focus:t.initLoad},model:{value:t.modelValue,callback:function(e){t.modelValue=e},expression:"modelValue"}},t._l(t.dataList,(function(t){return a("el-option",{key:t._id,attrs:{label:t.name,value:t._id}})})),1)},i=[],o=(a("4de4"),a("d3b7"),a("2197")),s={name:"AuxSelectSupplier",props:{value:{type:[String,Array],default:function(){return""}},multi:Boolean},data:function(){return{loading:!1,dataList:[],modelValue:""}},watch:{value:{handler:function(t,e){this.modelValue=t,0===this.dataList.length&&t&&this.fetchData()},immediate:!0}},methods:{initLoad:function(){this.fetchData()},fetchData:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";Object(o["a"])("supplier/listSupplier",{pageSize:12,simple:!0,keyword:e},{functionName:"xunda"}).then((function(e){t.loading=!1,t.dataList=e.data||[]}))},change:function(){var t=this;this.$nextTick((function(){if(t.$emit("input",t.modelValue),!t.multi){var e=t.dataList.filter((function(e){return e._id==t.modelValue}));e.length>0&&t.$emit("change",e[0])}}))}}},l=s,r=a("2877"),c=Object(r["a"])(l,n,i,!1,null,null,null);e["a"]=c.exports},e1d7:function(t,e,a){"use strict";a("434e")},f491:function(t,e,a){},f63d:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-cascader",{staticClass:"w-full",attrs:{options:t.treeList,props:{expandTrigger:"hover"},clearable:"",placeholder:"选择查询区域"},on:{change:t.change,focus:t.initLoad},model:{value:t.modelValue,callback:function(e){t.modelValue=e},expression:"modelValue"}})},i=[],o=(a("d81d"),a("b0c0"),a("4de4"),a("d3b7"),a("159b"),a("caad"),a("2532"),a("2197")),s={name:"AuxPickerArea",props:{value:{type:Array,default:function(){return[]}}},data:function(){return{dataList:[],treeList:[],modelValue:[]}},watch:{value:{handler:function(t,e){this.modelValue=t,this.fetchData()},immediate:!0}},methods:{initLoad:function(){0===this.dataList.length&&this.fetchData()},fetchData:function(){var t=this;Object(o["a"])("area/listAreaAll",{},{functionName:"xunda"}).then((function(e){var a=(e.data||[]).map((function(t){return t.label=t.name,t.value=t._id,t}));t.dataList=a,t.treeList=t.buildTree(a,"")}))},buildTree:function(t,e){var a=this,n=t.filter((function(t){return e==t.parent_id})).map((function(t){return Object.assign({},t)}));return n.forEach((function(e){var n=a.buildTree(t,e._id);n&&n.length>0&&(e.children=n)})),n},change:function(t){var e=this;this.$nextTick((function(){e.$emit("input",t);var a=e.dataList.filter((function(e){return t.includes(e.value)}));e.$emit("change",a)}))}}},l=s,r=a("2877"),c=Object(r["a"])(l,n,i,!1,null,null,null);e["a"]=c.exports}}]);