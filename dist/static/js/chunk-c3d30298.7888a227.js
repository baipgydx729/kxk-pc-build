(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-c3d30298"],{"3b12":function(t,e,a){"use strict";a("bd9b")},"6e23":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"aux-card"},[a("div",{staticClass:"header"},[a("div",{staticClass:"left"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.$refs.roleDialog.open()}}},[t._v("新增角色")])],1),a("div",{staticClass:"right"},[a("el-select",{staticClass:"margin-right-sm",staticStyle:{width:"100px"},attrs:{clearable:""},on:{change:t.changeState},model:{value:t.reqData.state,callback:function(e){t.$set(t.reqData,"state",e)},expression:"reqData.state"}},t._l(t.states,(function(t,e){return a("el-option",{key:t.value,attrs:{value:t.value,label:t.name}})})),1),a("el-input",{staticStyle:{width:"320px"},attrs:{"prefix-icon":"el-icon-search",clearable:"",placeholder:"请输入角色名称/电话搜索"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.changeKeyword(e)}},model:{value:t.reqData.keyword,callback:function(e){t.$set(t.reqData,"keyword",e)},expression:"reqData.keyword"}})],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLoading,expression:"dataLoading"}],staticClass:"aux-table",attrs:{data:t.dataList,border:""}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{align:"left",width:"160",label:"角色名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.role_name))]}}])}),a("el-table-column",{attrs:{align:"left",label:"角色描述"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.remark))]}}])}),a("el-table-column",{attrs:{width:"90",align:"center",label:"状态"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("span",[t._v(t._s(t._f("formatStateText")(e.row.state||1)))])]}}])}),a("el-table-column",{attrs:{width:"260",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.editPermissions(e.row,e.$index)}}},[t._v("设置权限")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.editRole(e.row,e.$index)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.deleteRole(e.row,e.$index)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"padding dflex-c"},[a("el-pagination",{attrs:{background:"","page-size":t.pagination.pageSize,total:t.pagination.totalCount,"current-page":t.pagination.pageNo,"page-sizes":[15,20,50],layout:"total, prev, pager, next","hide-on-single-page":""},on:{"size-change":t.changePageSize,"current-change":t.changePageNo}})],1)],1),a("RoleDialog",{ref:"roleDialog",on:{change:t.fetchDataList}})],1)},i=[],o=a("2197"),l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-dialog",{attrs:{title:"新增角色",visible:t.dialogVisible,width:"460px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-form",{ref:"elForm",staticClass:"demo-formData",attrs:{model:t.formData,"status-icon":"",rules:t.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"角色名称",prop:"role_name"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请填写角色名称",clearable:""},model:{value:t.formData.role_name,callback:function(e){t.$set(t.formData,"role_name",e)},expression:"formData.role_name"}})],1),a("el-form-item",{attrs:{label:"角色描述",prop:"remark"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请填写角色名称",clearable:""},model:{value:t.formData.remark,callback:function(e){t.$set(t.formData,"remark",e)},expression:"formData.remark"}})],1)],1),a("div",{staticClass:"dflex-e padding-top-sm"},[a("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("保存")]),a("el-button",{attrs:{type:"default"},on:{click:t.close}},[t._v("取消")])],1)],1)},r=[],s=a("c7eb"),c=a("1da1"),u={name:"RoleDialog",props:{},data:function(){return{dialogVisible:!1,dataLoading:!1,id:"",formData:{_id:"",role_name:"",remark:""},rules:{role_name:[{required:!0,message:"请填写角色名称",trigger:"blur"},{min:2,max:16,message:"长度在 2 到 16 个字符",trigger:"blur"}]}}},computed:{},methods:{fetchData:function(){var t=this;return Object(c["a"])(Object(s["a"])().mark((function e(){return Object(s["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t.dataLoading=!0,Object(o["a"])("member/getRole",{id:t.id},{functionName:"xunda"}).then((function(e){t.dataLoading=!1}));case 2:case"end":return e.stop()}}),e)})))()},submit:function(){var t=this;this.$refs["elForm"].validate((function(e){e&&Object(o["a"])("member/saveRole",t.formData,{functionName:"xunda"}).then((function(e){t.$message.success("保存成功"),setTimeout((function(){t.$emit("change"),t.close()}),300)}))}))},open:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t._id&&(this.formData={_id:t._id,role_name:t.role_name,remark:t.remark||""}),this.dialogVisible=!0},close:function(){this.dialogVisible=!1}}},d=u,f=(a("3b12"),a("2877")),m=Object(f["a"])(d,l,r,!1,null,null,null),p=m.exports,g={components:{RoleDialog:p},filters:{formatStateText:function(t){return 1==t||0==t?"正常":"停用"}},data:function(){return{permission:"store-query",states:[{name:"全部",value:""},{name:"启用",value:1},{name:"禁用",value:2}],dataLoading:!1,dataList:[],pagination:{totalCount:1,pageSize:12,pageNo:1},reqData:{state:"",keyword:""}}},mounted:function(){this.fetchDataList()},methods:{fetchDataList:function(){var t=this;this.dataLoading=!0;var e=Object.assign({},this.reqData,this.pagination);Object(o["a"])("member/listRole",e,{functionName:"xunda"}).then((function(e){t.dataList=e.data||[],1==t.pagination.pageNo&&(t.pagination.totalCount=e.totalCount),t.dataLoading=!1}))},changeState:function(){var t=this;this.$common.debounce((function(){return t.fetchDataList()}),300,this)()},changeKeyword:function(){this.fetchDataList()},changePageNo:function(t){this.pagination.pageNo=t,this.fetchDataList()},changePageSize:function(t){this.pagination.pageNo=1,this.pagination.pageSize=t,this.fetchDataList()},editPermissions:function(t,e){this.$router.push({path:"/basic/member/role-detail/"+t._id})},editRole:function(t,e){this.$refs.roleDialog.open(t)},deleteRole:function(t,e){var a=this;this.$confirm("确定要删除该角色？","警告提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(o["a"])("member/deleteRole",{roleId:t._id},{functionName:"xunda"}).then((function(t){a.fetchDataList(),a.$message({type:"success",message:"删除成功!"})}))}))}}},h=g,b=Object(f["a"])(h,n,i,!1,null,null,null);e["default"]=b.exports},bd9b:function(t,e,a){}}]);