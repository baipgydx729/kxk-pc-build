(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-541b6459","chunk-2d0d34b5"],{1693:function(e,t,o){"use strict";o("d677")},"38a3":function(e,t,o){"use strict";o.r(t);var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"aux-card"},[o("div",{staticClass:"header"},[e._m(0),o("div",{staticClass:"right"},[o("el-button",{attrs:{type:"default",icon:"el-icon-tickets"},on:{click:function(t){return e.$common.closePage()}}},[e._v("取消")]),o("el-button",{attrs:{type:"primary",icon:"el-icon-document-checked"},on:{click:e.handleSave}},[e._v("保存 (Ctrl+S)")])],1)]),o("div",{staticClass:"margin-top-sm"},[o("el-form",{ref:"baseForm",attrs:{"label-width":"90px","label-align":"left",inline:!0}},[o("div",{staticClass:"dflex-s"},[o("el-form-item",{attrs:{label:"选择客户"}},[o("AuxStoreSelect",{staticStyle:{width:"300px"},on:{change:e.changeStoreSelect},model:{value:e.baseForm.store_id,callback:function(t){e.$set(e.baseForm,"store_id",t)},expression:"baseForm.store_id"}})],1),o("el-form-item",{attrs:{label:"业务日期"}},[o("el-date-picker",{staticStyle:{width:"300px"},attrs:{type:"datetime","value-format":"timestamp"},model:{value:e.baseForm.orders_date,callback:function(t){e.$set(e.baseForm,"orders_date",t)},expression:"baseForm.orders_date"}})],1)],1)])],1),o("orders-goods-table",{ref:"goodsTable",on:{change:e.changeOrdersGoodsCompleted}})],1),o("el-card",{staticClass:"aux-card margin-top",attrs:{shadow:"none","body-style":{padding:"12px"}}},[o("el-form",{ref:"baseForm",attrs:{"label-width":"80px","label-align":"left",inline:!0}},[o("el-form-item",{attrs:{label:"整单优惠"}},[o("el-input",{attrs:{oninput:"value=value.match(/^\\d+(?:\\.\\d{0,2})?/)",placeholder:"整单优惠"},on:{blur:e.changeOrdersDiscountMoney},model:{value:e.baseForm.orders_discount_money,callback:function(t){e.$set(e.baseForm,"orders_discount_money",t)},expression:"baseForm.orders_discount_money"}},[o("template",{slot:"append"},[e._v("元")])],2)],1),o("el-form-item",{attrs:{label:"其他费用"}},[o("el-input",{attrs:{oninput:"value=value.match(/^\\d+(?:\\.\\d{0,2})?/)",placeholder:"其他费用"},on:{change:e.changeOrdersCompleted},model:{value:e.baseForm.orders_extend_fee,callback:function(t){e.$set(e.baseForm,"orders_extend_fee",t)},expression:"baseForm.orders_extend_fee"}},[o("template",{slot:"append"},[e._v("元")])],2)],1),o("el-form-item",{attrs:{label:"订单金额"}},[o("el-input",{attrs:{disabled:"",placeholder:"金额"},model:{value:e.baseForm.orders_total_money,callback:function(t){e.$set(e.baseForm,"orders_total_money",t)},expression:"baseForm.orders_total_money"}},[o("template",{slot:"append"},[e._v("元")])],2)],1)],1),o("div",{staticClass:"dflex-e padding-tb border-top"},[o("span",{staticClass:"padding-left"},[e._v("整单优惠："+e._s(e.baseForm.orders_discount_money))]),o("span",{staticClass:"padding-left"},[e._v("其他费用："+e._s(e.baseForm.orders_extend_fee))]),o("span",{staticClass:"padding-left"},[e._v("订单金额："+e._s(e.baseForm.orders_total_money))])])],1),o("el-card",{staticClass:"aux-card margin-top",attrs:{shadow:"none","body-style":{padding:"12px"}}},[o("div",{attrs:{slot:"header"},slot:"header"},[o("span",[e._v("订单备注")])]),o("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",maxlength:"600","show-word-limit":""},model:{value:e.baseForm.orders_remark,callback:function(t){e.$set(e.baseForm,"orders_remark",t)},expression:"baseForm.orders_remark"}})],1)],1)},r=[function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"left"},[o("span",{staticClass:"title"},[e._v("销售预订单")])])}],s=o("c7eb"),i=o("1da1"),a=(o("b680"),o("d81d"),o("b0c0"),o("a9e3"),o("b14f")),d=o("2051"),c=o("2197"),u={components:{"orders-goods-table":a["a"],AuxStoreSelect:d["a"]},data:function(){return{permission:"sales-orders-create",ordersId:"",baseForm:{orders_date:(new Date).getTime(),orders_no:"",store_id:"",store:{_id:"",name:"",contact:"",telephone:"",sale_grade:0},orders_goods:[],sale_manid:"",orders_remark:"",create_remark:"",create_uname:"",goods_total_count:0,goods_original_money:0,goods_discount_money:0,goods_total_money:0,orders_discount_money:0,orders_extend_fee:0,orders_total_money:0}}},computed:{},mounted:function(){var e=this.$route.query||{},t=e.storeId,o=e.id,n=e.type;t&&(this.baseForm.store_id=t),o&&(this.ordersId=o,this.fetchDetail()),"copyAdd"===n&&(this.ordersId="")},methods:{fetchDetail:function(){var e=this;Object(c["a"])("prepare/getOrders",{ordersId:this.ordersId},{functionName:"xunda"}).then((function(t){e.initOrdersData(t.data)}))},initOrdersData:function(e){var t={};t.store_id=e.store_id,t.store=e.store,t.orders_date=e.orders_date,t.orders_no=e.orders_no,t.orders_remark=e.orders_remark,t.create_remark=e.create_remark,t.create_uname=e.create_uname,t.sale_manid=e.sale_manid||"",t.orders_total_money=(e.orders_total_money>0?e.orders_total_money/100:0).toFixed(2),t.orders_extend_fee=(e.orders_extend_fee>0?e.orders_extend_fee/100:0).toFixed(2),t.orders_discount_money=(e.orders_discount_money>0?e.orders_discount_money/100:0).toFixed(2),t.goods_total_count=e.goods_total_count||e.orders_goods_count,t.goods_original_money=e.goods_original_money>0?(e.goods_original_money/100).toFixed(2):t.ordersTotalMoney,t.goods_discount_money=e.goods_discount_money>0?(e.goods_discount_money/100).toFixed(2):0,t.goods_total_money=e.goods_total_money>0?(e.goods_total_money/100).toFixed(2):t.goodsOriginalMoney,t.orders_goods=e.orders_goods.map((function(e){var t=Object.assign({},e);return t.goods_ori_price=((e.goods_ori_price||t.goods_price)/100).toFixed(2),t.total_ori_money=((e.total_ori_money||t.total_money)/100).toFixed(2),t.total_ori_money=((e.total_ori_money||t.total_money)/100).toFixed(2),t.total_money=(e.total_money/100).toFixed(2),t.goods_price=(e.goods_price/100).toFixed(2),t})),this.$refs.goodsTable.initData(t.orders_goods),this.baseForm=t},changeStoreSelect:function(e){this.baseForm.store_id=e._id,this.baseForm.store={_id:e._id,name:e.name,contact:e.contact,telephone:e.telephone}},changeOrdersDiscountMoney:function(){this.baseForm.orders_discount_money=Math.min(this.baseForm.orders_discount_money,this.baseForm.goods_total_money),this.changeOrdersGoodsCompleted()},changeOrdersGoodsCompleted:function(){var e=this.$refs.goodsTable.getSummaryData(),t=e.goodsTotalCount,o=void 0===t?0:t,n=e.goodsOriginalMoney,r=void 0===n?0:n,s=e.goodsDiscountMoney,i=void 0===s?0:s,a=e.goodsTotalMoney,d=void 0===a?0:a;this.baseForm.goods_total_count=o,this.baseForm.goods_original_money=r,this.baseForm.goods_discount_money=i,this.baseForm.goods_total_money=d,this.changeOrdersCompleted()},changeOrdersCompleted:function(){this.baseForm.orders_discount_money=(Number(this.baseForm.orders_discount_money)||0).toFixed(2),this.baseForm.orders_extend_fee=(Number(this.baseForm.orders_extend_fee)||0).toFixed(2),this.baseForm.orders_total_money=(Number(this.baseForm.goods_total_money)+Number(this.baseForm.orders_extend_fee)-Number(this.baseForm.orders_discount_money)).toFixed(2)},validateForm:function(){if(this.baseForm.store_id){var e=this.$refs.goodsTable.getListData();if(0!==e.length)return!0;this.$message.error("商品清单为空")}else this.$message.error("请选择客户")},handleSave:function(){this.validateForm()&&this.submitForm()},submitForm:function(){var e=this;return Object(i["a"])(Object(s["a"])().mark((function t(){var o;return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:o={ordersId:e.ordersId,data:e.getOrdersData()},Object(c["a"])("prepare/saveOrders",o,{functionName:"xunda"}).then((function(t){e.$message("保存成功"),setTimeout((function(){return e.$common.closePage()}),500)}),(function(t){e.$message.error(t.message)}));case 2:case"end":return t.stop()}}),t)})))()},getOrdersData:function(){var e=Object.assign({},this.baseForm,{orders_type:1,orders_date:this.baseForm.orders_date,store_id:this.baseForm.store_id,store:this.baseForm.store,orders_remark:this.baseForm.orders_remark,orders_goods:this.getOrdersGoods(),goods_total_count:this.baseForm.goods_total_count,goods_original_money:100*this.baseForm.goods_original_money,goods_discount_money:100*this.baseForm.goods_discount_money,goods_total_money:100*this.baseForm.goods_total_money,orders_discount_money:100*this.baseForm.orders_discount_money,orders_extend_fee:100*this.baseForm.orders_extend_fee,orders_total_money:100*this.baseForm.orders_total_money});return this.ordersId||(e.orders_no="XYD"+this.$common.format(new Date,"yyyyMMddhhmmssS")),e},getOrdersGoods:function(){var e=this.$refs.goodsTable.getListData();return e.map((function(e){var t=Object.assign({},e,{goods_ori_price:100*e.goods_ori_price,total_ori_money:100*e.total_ori_money,goods_price:100*e.goods_price,total_money:100*e.total_money});return t}))}}},l=u,f=o("2877"),m=Object(f["a"])(l,n,r,!1,null,null,null);t["default"]=m.exports},"5bc5":function(e,t,o){"use strict";var n,r,s=o("53ca"),i=(o("fb6a"),o("d3b7"),o("25f0"),o("b680"),o("bf19"),o("ac1f"),o("5319"),o("841c"),o("00b4"),o("4c53"),o("ace4"),o("fb2c"),o("9a8c"),o("a975"),o("735e"),o("c1ac"),o("d139"),o("3a7b"),o("d5d6"),o("82f8"),o("e91f"),o("60bd"),o("5f96"),o("3280"),o("3fcc"),o("ca91"),o("25a1"),o("cd26"),o("3c5d"),o("2954"),o("649e"),o("219c"),o("170b"),o("b39a"),o("72f7"),o("a4d3"),o("e01a"),o("944a"),o("0c47"),o("23dc"),9e15),a=1e9,d="0123456789abcdef",c="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",u="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",l={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-i,maxE:i,crypto:!1},f=!0,m="[DecimalError] ",g=m+"Invalid argument: ",h=m+"Precision limit exceeded",p=m+"crypto unavailable",_="[object Decimal]",v=Math.floor,b=Math.pow,w=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,y=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,x=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,N=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,F=1e7,O=7,k=9007199254740991,M=c.length-1,C=u.length-1,E={toStringTag:_};function S(e){var t,o,n,r=e.length-1,s="",i=e[0];if(r>0){for(s+=i,t=1;t<r;t++)n=e[t]+"",o=O-n.length,o&&(s+=R(o)),s+=n;i=e[t],n=i+"",o=O-n.length,o&&(s+=R(o))}else if(0===i)return"0";for(;i%10===0;)i/=10;return s+i}function I(e,t,o){if(e!==~~e||e<t||e>o)throw Error(g+e)}function D(e,t,o,n){var r,s,i,a;for(s=e[0];s>=10;s/=10)--t;return--t<0?(t+=O,r=0):(r=Math.ceil((t+1)/O),t%=O),s=b(10,O-t),a=e[r]%s|0,null==n?t<3?(0==t?a=a/100|0:1==t&&(a=a/10|0),i=o<4&&99999==a||o>3&&49999==a||5e4==a||0==a):i=(o<4&&a+1==s||o>3&&a+1==s/2)&&(e[r+1]/s/100|0)==b(10,t-2)-1||(a==s/2||0==a)&&0==(e[r+1]/s/100|0):t<4?(0==t?a=a/1e3|0:1==t?a=a/100|0:2==t&&(a=a/10|0),i=(n||o<4)&&9999==a||!n&&o>3&&4999==a):i=((n||o<4)&&a+1==s||!n&&o>3&&a+1==s/2)&&(e[r+1]/s/1e3|0)==b(10,t-3)-1,i}function G(e,t,o){for(var n,r,s=[0],i=0,a=e.length;i<a;){for(r=s.length;r--;)s[r]*=t;for(s[0]+=d.indexOf(e.charAt(i++)),n=0;n<s.length;n++)s[n]>o-1&&(void 0===s[n+1]&&(s[n+1]=0),s[n+1]+=s[n]/o|0,s[n]%=o)}return s.reverse()}function T(e,t){var o,n,r;if(t.isZero())return t;n=t.d.length,n<32?(o=Math.ceil(n/3),r=(1/Q(4,o)).toString()):(o=16,r="2.3283064365386962890625e-10"),e.precision+=o,t=K(e,1,t.times(r),new e(1));for(var s=o;s--;){var i=t.times(t);t=i.times(i).minus(i).times(8).plus(1)}return e.precision-=o,t}E.absoluteValue=E.abs=function(){var e=new this.constructor(this);return e.s<0&&(e.s=1),L(e)},E.ceil=function(){return L(new this.constructor(this),this.e+1,2)},E.clampedTo=E.clamp=function(e,t){var o,n=this,r=n.constructor;if(e=new r(e),t=new r(t),!e.s||!t.s)return new r(NaN);if(e.gt(t))throw Error(g+t);return o=n.cmp(e),o<0?e:n.cmp(t)>0?t:new r(n)},E.comparedTo=E.cmp=function(e){var t,o,n,r,s=this,i=s.d,a=(e=new s.constructor(e)).d,d=s.s,c=e.s;if(!i||!a)return d&&c?d!==c?d:i===a?0:!i^d<0?1:-1:NaN;if(!i[0]||!a[0])return i[0]?d:a[0]?-c:0;if(d!==c)return d;if(s.e!==e.e)return s.e>e.e^d<0?1:-1;for(n=i.length,r=a.length,t=0,o=n<r?n:r;t<o;++t)if(i[t]!==a[t])return i[t]>a[t]^d<0?1:-1;return n===r?0:n>r^d<0?1:-1},E.cosine=E.cos=function(){var e,t,o=this,n=o.constructor;return o.d?o.d[0]?(e=n.precision,t=n.rounding,n.precision=e+Math.max(o.e,o.sd())+O,n.rounding=1,o=T(n,ee(n,o)),n.precision=e,n.rounding=t,L(2==r||3==r?o.neg():o,e,t,!0)):new n(1):new n(NaN)},E.cubeRoot=E.cbrt=function(){var e,t,o,n,r,s,i,a,d,c,u=this,l=u.constructor;if(!u.isFinite()||u.isZero())return new l(u);for(f=!1,s=u.s*b(u.s*u,1/3),s&&Math.abs(s)!=1/0?n=new l(s.toString()):(o=S(u.d),e=u.e,(s=(e-o.length+1)%3)&&(o+=1==s||-2==s?"0":"00"),s=b(o,1/3),e=v((e+1)/3)-(e%3==(e<0?-1:2)),s==1/0?o="5e"+e:(o=s.toExponential(),o=o.slice(0,o.indexOf("e")+1)+e),n=new l(o),n.s=u.s),i=(e=l.precision)+3;;)if(a=n,d=a.times(a).times(a),c=d.plus(u),n=$(c.plus(u).times(a),c.plus(d),i+2,1),S(a.d).slice(0,i)===(o=S(n.d)).slice(0,i)){if(o=o.slice(i-3,i+1),"9999"!=o&&(r||"4999"!=o)){+o&&(+o.slice(1)||"5"!=o.charAt(0))||(L(n,e+1,1),t=!n.times(n).times(n).eq(u));break}if(!r&&(L(a,e+1,0),a.times(a).times(a).eq(u))){n=a;break}i+=4,r=1}return f=!0,L(n,e,l.rounding,t)},E.decimalPlaces=E.dp=function(){var e,t=this.d,o=NaN;if(t){if(e=t.length-1,o=(e-v(this.e/O))*O,e=t[e],e)for(;e%10==0;e/=10)o--;o<0&&(o=0)}return o},E.dividedBy=E.div=function(e){return $(this,new this.constructor(e))},E.dividedToIntegerBy=E.divToInt=function(e){var t=this,o=t.constructor;return L($(t,new o(e),0,1,1),o.precision,o.rounding)},E.equals=E.eq=function(e){return 0===this.cmp(e)},E.floor=function(){return L(new this.constructor(this),this.e+1,3)},E.greaterThan=E.gt=function(e){return this.cmp(e)>0},E.greaterThanOrEqualTo=E.gte=function(e){var t=this.cmp(e);return 1==t||0===t},E.hyperbolicCosine=E.cosh=function(){var e,t,o,n,r,s,i=this,a=i.constructor,d=new a(1);if(!i.isFinite())return new a(i.s?1/0:NaN);if(i.isZero())return d;o=a.precision,n=a.rounding,a.precision=o+Math.max(i.e,i.sd())+4,a.rounding=1,r=i.d.length,r<32?(e=Math.ceil(r/3),t=(1/Q(4,e)).toString()):(e=16,t="2.3283064365386962890625e-10"),i=K(a,1,i.times(t),new a(1),!0);for(var c=e,u=new a(8);c--;)s=i.times(i),i=d.minus(s.times(u.minus(s.times(u))));return L(i,a.precision=o,a.rounding=n,!0)},E.hyperbolicSine=E.sinh=function(){var e,t,o,n,r=this,s=r.constructor;if(!r.isFinite()||r.isZero())return new s(r);if(t=s.precision,o=s.rounding,s.precision=t+Math.max(r.e,r.sd())+4,s.rounding=1,n=r.d.length,n<3)r=K(s,2,r,r,!0);else{var i;e=1.4*Math.sqrt(n),e=e>16?16:0|e,r=r.times(1/Q(5,e)),r=K(s,2,r,r,!0);for(var a=new s(5),d=new s(16),c=new s(20);e--;)i=r.times(r),r=r.times(a.plus(i.times(d.times(i).plus(c))))}return s.precision=t,s.rounding=o,L(r,t,o,!0)},E.hyperbolicTangent=E.tanh=function(){var e,t,o=this,n=o.constructor;return o.isFinite()?o.isZero()?new n(o):(e=n.precision,t=n.rounding,n.precision=e+7,n.rounding=1,$(o.sinh(),o.cosh(),n.precision=e,n.rounding=t)):new n(o.s)},E.inverseCosine=E.acos=function(){var e,t=this,o=t.constructor,n=t.abs().cmp(1),r=o.precision,s=o.rounding;return-1!==n?0===n?t.isNeg()?j(o,r,s):new o(0):new o(NaN):t.isZero()?j(o,r+4,s).times(.5):(o.precision=r+6,o.rounding=1,t=t.asin(),e=j(o,r+4,s).times(.5),o.precision=r,o.rounding=s,e.minus(t))},E.inverseHyperbolicCosine=E.acosh=function(){var e,t,o=this,n=o.constructor;return o.lte(1)?new n(o.eq(1)?0:NaN):o.isFinite()?(e=n.precision,t=n.rounding,n.precision=e+Math.max(Math.abs(o.e),o.sd())+4,n.rounding=1,f=!1,o=o.times(o).minus(1).sqrt().plus(o),f=!0,n.precision=e,n.rounding=t,o.ln()):new n(o)},E.inverseHyperbolicSine=E.asinh=function(){var e,t,o=this,n=o.constructor;return!o.isFinite()||o.isZero()?new n(o):(e=n.precision,t=n.rounding,n.precision=e+2*Math.max(Math.abs(o.e),o.sd())+6,n.rounding=1,f=!1,o=o.times(o).plus(1).sqrt().plus(o),f=!0,n.precision=e,n.rounding=t,o.ln())},E.inverseHyperbolicTangent=E.atanh=function(){var e,t,o,n,r=this,s=r.constructor;return r.isFinite()?r.e>=0?new s(r.abs().eq(1)?r.s/0:r.isZero()?r:NaN):(e=s.precision,t=s.rounding,n=r.sd(),Math.max(n,e)<2*-r.e-1?L(new s(r),e,t,!0):(s.precision=o=n-r.e,r=$(r.plus(1),new s(1).minus(r),o+e,1),s.precision=e+4,s.rounding=1,r=r.ln(),s.precision=e,s.rounding=t,r.times(.5))):new s(NaN)},E.inverseSine=E.asin=function(){var e,t,o,n,r=this,s=r.constructor;return r.isZero()?new s(r):(t=r.abs().cmp(1),o=s.precision,n=s.rounding,-1!==t?0===t?(e=j(s,o+4,n).times(.5),e.s=r.s,e):new s(NaN):(s.precision=o+6,s.rounding=1,r=r.div(new s(1).minus(r.times(r)).sqrt().plus(1)).atan(),s.precision=o,s.rounding=n,r.times(2)))},E.inverseTangent=E.atan=function(){var e,t,o,n,r,s,i,a,d,c=this,u=c.constructor,l=u.precision,m=u.rounding;if(c.isFinite()){if(c.isZero())return new u(c);if(c.abs().eq(1)&&l+4<=C)return i=j(u,l+4,m).times(.25),i.s=c.s,i}else{if(!c.s)return new u(NaN);if(l+4<=C)return i=j(u,l+4,m).times(.5),i.s=c.s,i}for(u.precision=a=l+10,u.rounding=1,o=Math.min(28,a/O+2|0),e=o;e;--e)c=c.div(c.times(c).plus(1).sqrt().plus(1));for(f=!1,t=Math.ceil(a/O),n=1,d=c.times(c),i=new u(c),r=c;-1!==e;)if(r=r.times(d),s=i.minus(r.div(n+=2)),r=r.times(d),i=s.plus(r.div(n+=2)),void 0!==i.d[t])for(e=t;i.d[e]===s.d[e]&&e--;);return o&&(i=i.times(2<<o-1)),f=!0,L(i,u.precision=l,u.rounding=m,!0)},E.isFinite=function(){return!!this.d},E.isInteger=E.isInt=function(){return!!this.d&&v(this.e/O)>this.d.length-2},E.isNaN=function(){return!this.s},E.isNegative=E.isNeg=function(){return this.s<0},E.isPositive=E.isPos=function(){return this.s>0},E.isZero=function(){return!!this.d&&0===this.d[0]},E.lessThan=E.lt=function(e){return this.cmp(e)<0},E.lessThanOrEqualTo=E.lte=function(e){return this.cmp(e)<1},E.logarithm=E.log=function(e){var t,o,n,r,s,i,a,d,c=this,u=c.constructor,l=u.precision,m=u.rounding,g=5;if(null==e)e=new u(10),t=!0;else{if(e=new u(e),o=e.d,e.s<0||!o||!o[0]||e.eq(1))return new u(NaN);t=e.eq(10)}if(o=c.d,c.s<0||!o||!o[0]||c.eq(1))return new u(o&&!o[0]?-1/0:1!=c.s?NaN:o?0:1/0);if(t)if(o.length>1)s=!0;else{for(r=o[0];r%10===0;)r/=10;s=1!==r}if(f=!1,a=l+g,i=z(c,a),n=t?A(u,a+10):z(e,a),d=$(i,n,a,1),D(d.d,r=l,m))do{if(a+=10,i=z(c,a),n=t?A(u,a+10):z(e,a),d=$(i,n,a,1),!s){+S(d.d).slice(r+1,r+15)+1==1e14&&(d=L(d,l+1,0));break}}while(D(d.d,r+=10,m));return f=!0,L(d,l,m)},E.minus=E.sub=function(e){var t,o,n,r,s,i,a,d,c,u,l,m,g=this,h=g.constructor;if(e=new h(e),!g.d||!e.d)return g.s&&e.s?g.d?e.s=-e.s:e=new h(e.d||g.s!==e.s?g:NaN):e=new h(NaN),e;if(g.s!=e.s)return e.s=-e.s,g.plus(e);if(c=g.d,m=e.d,a=h.precision,d=h.rounding,!c[0]||!m[0]){if(m[0])e.s=-e.s;else{if(!c[0])return new h(3===d?-0:0);e=new h(g)}return f?L(e,a,d):e}if(o=v(e.e/O),u=v(g.e/O),c=c.slice(),s=u-o,s){for(l=s<0,l?(t=c,s=-s,i=m.length):(t=m,o=u,i=c.length),n=Math.max(Math.ceil(a/O),i)+2,s>n&&(s=n,t.length=1),t.reverse(),n=s;n--;)t.push(0);t.reverse()}else{for(n=c.length,i=m.length,l=n<i,l&&(i=n),n=0;n<i;n++)if(c[n]!=m[n]){l=c[n]<m[n];break}s=0}for(l&&(t=c,c=m,m=t,e.s=-e.s),i=c.length,n=m.length-i;n>0;--n)c[i++]=0;for(n=m.length;n>s;){if(c[--n]<m[n]){for(r=n;r&&0===c[--r];)c[r]=F-1;--c[r],c[n]+=F}c[n]-=m[n]}for(;0===c[--i];)c.pop();for(;0===c[0];c.shift())--o;return c[0]?(e.d=c,e.e=q(c,o),f?L(e,a,d):e):new h(3===d?-0:0)},E.modulo=E.mod=function(e){var t,o=this,n=o.constructor;return e=new n(e),!o.d||!e.s||e.d&&!e.d[0]?new n(NaN):!e.d||o.d&&!o.d[0]?L(new n(o),n.precision,n.rounding):(f=!1,9==n.modulo?(t=$(o,e.abs(),0,3,1),t.s*=e.s):t=$(o,e,0,n.modulo,1),t=t.times(e),f=!0,o.minus(t))},E.naturalExponential=E.exp=function(){return B(this)},E.naturalLogarithm=E.ln=function(){return z(this)},E.negated=E.neg=function(){var e=new this.constructor(this);return e.s=-e.s,L(e)},E.plus=E.add=function(e){var t,o,n,r,s,i,a,d,c,u,l=this,m=l.constructor;if(e=new m(e),!l.d||!e.d)return l.s&&e.s?l.d||(e=new m(e.d||l.s===e.s?l:NaN)):e=new m(NaN),e;if(l.s!=e.s)return e.s=-e.s,l.minus(e);if(c=l.d,u=e.d,a=m.precision,d=m.rounding,!c[0]||!u[0])return u[0]||(e=new m(l)),f?L(e,a,d):e;if(s=v(l.e/O),n=v(e.e/O),c=c.slice(),r=s-n,r){for(r<0?(o=c,r=-r,i=u.length):(o=u,n=s,i=c.length),s=Math.ceil(a/O),i=s>i?s+1:i+1,r>i&&(r=i,o.length=1),o.reverse();r--;)o.push(0);o.reverse()}for(i=c.length,r=u.length,i-r<0&&(r=i,o=u,u=c,c=o),t=0;r;)t=(c[--r]=c[r]+u[r]+t)/F|0,c[r]%=F;for(t&&(c.unshift(t),++n),i=c.length;0==c[--i];)c.pop();return e.d=c,e.e=q(c,n),f?L(e,a,d):e},E.precision=E.sd=function(e){var t,o=this;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(g+e);return o.d?(t=P(o.d),e&&o.e+1>t&&(t=o.e+1)):t=NaN,t},E.round=function(){var e=this,t=e.constructor;return L(new t(e),e.e+1,t.rounding)},E.sine=E.sin=function(){var e,t,o=this,n=o.constructor;return o.isFinite()?o.isZero()?new n(o):(e=n.precision,t=n.rounding,n.precision=e+Math.max(o.e,o.sd())+O,n.rounding=1,o=Y(n,ee(n,o)),n.precision=e,n.rounding=t,L(r>2?o.neg():o,e,t,!0)):new n(NaN)},E.squareRoot=E.sqrt=function(){var e,t,o,n,r,s,i=this,a=i.d,d=i.e,c=i.s,u=i.constructor;if(1!==c||!a||!a[0])return new u(!c||c<0&&(!a||a[0])?NaN:a?i:1/0);for(f=!1,c=Math.sqrt(+i),0==c||c==1/0?(t=S(a),(t.length+d)%2==0&&(t+="0"),c=Math.sqrt(t),d=v((d+1)/2)-(d<0||d%2),c==1/0?t="5e"+d:(t=c.toExponential(),t=t.slice(0,t.indexOf("e")+1)+d),n=new u(t)):n=new u(c.toString()),o=(d=u.precision)+3;;)if(s=n,n=s.plus($(i,s,o+2,1)).times(.5),S(s.d).slice(0,o)===(t=S(n.d)).slice(0,o)){if(t=t.slice(o-3,o+1),"9999"!=t&&(r||"4999"!=t)){+t&&(+t.slice(1)||"5"!=t.charAt(0))||(L(n,d+1,1),e=!n.times(n).eq(i));break}if(!r&&(L(s,d+1,0),s.times(s).eq(i))){n=s;break}o+=4,r=1}return f=!0,L(n,d,u.rounding,e)},E.tangent=E.tan=function(){var e,t,o=this,n=o.constructor;return o.isFinite()?o.isZero()?new n(o):(e=n.precision,t=n.rounding,n.precision=e+10,n.rounding=1,o=o.sin(),o.s=1,o=$(o,new n(1).minus(o.times(o)).sqrt(),e+10,0),n.precision=e,n.rounding=t,L(2==r||4==r?o.neg():o,e,t,!0)):new n(NaN)},E.times=E.mul=function(e){var t,o,n,r,s,i,a,d,c,u=this,l=u.constructor,m=u.d,g=(e=new l(e)).d;if(e.s*=u.s,!m||!m[0]||!g||!g[0])return new l(!e.s||m&&!m[0]&&!g||g&&!g[0]&&!m?NaN:m&&g?0*e.s:e.s/0);for(o=v(u.e/O)+v(e.e/O),d=m.length,c=g.length,d<c&&(s=m,m=g,g=s,i=d,d=c,c=i),s=[],i=d+c,n=i;n--;)s.push(0);for(n=c;--n>=0;){for(t=0,r=d+n;r>n;)a=s[r]+g[n]*m[r-n-1]+t,s[r--]=a%F|0,t=a/F|0;s[r]=(s[r]+t)%F|0}for(;!s[--i];)s.pop();return t?++o:s.shift(),e.d=s,e.e=q(s,o),f?L(e,l.precision,l.rounding):e},E.toBinary=function(e,t){return te(this,2,e,t)},E.toDecimalPlaces=E.toDP=function(e,t){var o=this,n=o.constructor;return o=new n(o),void 0===e?o:(I(e,0,a),void 0===t?t=n.rounding:I(t,0,8),L(o,e+o.e+1,t))},E.toExponential=function(e,t){var o,n=this,r=n.constructor;return void 0===e?o=U(n,!0):(I(e,0,a),void 0===t?t=r.rounding:I(t,0,8),n=L(new r(n),e+1,t),o=U(n,!0,e+1)),n.isNeg()&&!n.isZero()?"-"+o:o},E.toFixed=function(e,t){var o,n,r=this,s=r.constructor;return void 0===e?o=U(r):(I(e,0,a),void 0===t?t=s.rounding:I(t,0,8),n=L(new s(r),e+r.e+1,t),o=U(n,!1,e+n.e+1)),r.isNeg()&&!r.isZero()?"-"+o:o},E.toFraction=function(e){var t,o,n,r,s,i,a,d,c,u,l,m,h=this,p=h.d,_=h.constructor;if(!p)return new _(h);if(c=o=new _(1),n=d=new _(0),t=new _(n),s=t.e=P(p)-h.e-1,i=s%O,t.d[0]=b(10,i<0?O+i:i),null==e)e=s>0?t:c;else{if(a=new _(e),!a.isInt()||a.lt(c))throw Error(g+a);e=a.gt(t)?s>0?t:c:a}for(f=!1,a=new _(S(p)),u=_.precision,_.precision=s=p.length*O*2;;){if(l=$(a,t,0,1,1),r=o.plus(l.times(n)),1==r.cmp(e))break;o=n,n=r,r=c,c=d.plus(l.times(r)),d=r,r=t,t=a.minus(l.times(r)),a=r}return r=$(e.minus(o),n,0,1,1),d=d.plus(r.times(c)),o=o.plus(r.times(n)),d.s=c.s=h.s,m=$(c,n,s,1).minus(h).abs().cmp($(d,o,s,1).minus(h).abs())<1?[c,n]:[d,o],_.precision=u,f=!0,m},E.toHexadecimal=E.toHex=function(e,t){return te(this,16,e,t)},E.toNearest=function(e,t){var o=this,n=o.constructor;if(o=new n(o),null==e){if(!o.d)return o;e=new n(1),t=n.rounding}else{if(e=new n(e),void 0===t?t=n.rounding:I(t,0,8),!o.d)return e.s?o:e;if(!e.d)return e.s&&(e.s=o.s),e}return e.d[0]?(f=!1,o=$(o,e,0,t,1).times(e),f=!0,L(o)):(e.s=o.s,o=e),o},E.toNumber=function(){return+this},E.toOctal=function(e,t){return te(this,8,e,t)},E.toPower=E.pow=function(e){var t,o,n,r,s,i,a=this,d=a.constructor,c=+(e=new d(e));if(!a.d||!e.d||!a.d[0]||!e.d[0])return new d(b(+a,c));if(a=new d(a),a.eq(1))return a;if(n=d.precision,s=d.rounding,e.eq(1))return L(a,n,s);if(t=v(e.e/O),t>=e.d.length-1&&(o=c<0?-c:c)<=k)return r=Z(d,a,o,n),e.s<0?new d(1).div(r):L(r,n,s);if(i=a.s,i<0){if(t<e.d.length-1)return new d(NaN);if(0==(1&e.d[t])&&(i=1),0==a.e&&1==a.d[0]&&1==a.d.length)return a.s=i,a}return o=b(+a,c),t=0!=o&&isFinite(o)?new d(o+"").e:v(c*(Math.log("0."+S(a.d))/Math.LN10+a.e+1)),t>d.maxE+1||t<d.minE-1?new d(t>0?i/0:0):(f=!1,d.rounding=a.s=1,o=Math.min(12,(t+"").length),r=B(e.times(z(a,n+o)),n),r.d&&(r=L(r,n+5,1),D(r.d,n,s)&&(t=n+10,r=L(B(e.times(z(a,t+o)),t),t+5,1),+S(r.d).slice(n+1,n+15)+1==1e14&&(r=L(r,n+1,0)))),r.s=i,f=!0,d.rounding=s,L(r,n,s))},E.toPrecision=function(e,t){var o,n=this,r=n.constructor;return void 0===e?o=U(n,n.e<=r.toExpNeg||n.e>=r.toExpPos):(I(e,1,a),void 0===t?t=r.rounding:I(t,0,8),n=L(new r(n),e,t),o=U(n,e<=n.e||n.e<=r.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+o:o},E.toSignificantDigits=E.toSD=function(e,t){var o=this,n=o.constructor;return void 0===e?(e=n.precision,t=n.rounding):(I(e,1,a),void 0===t?t=n.rounding:I(t,0,8)),L(new n(o),e,t)},E.toString=function(){var e=this,t=e.constructor,o=U(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+o:o},E.truncated=E.trunc=function(){return L(new this.constructor(this),this.e+1,1)},E.valueOf=E.toJSON=function(){var e=this,t=e.constructor,o=U(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+o:o};var $=function(){function e(e,t,o){var n,r=0,s=e.length;for(e=e.slice();s--;)n=e[s]*t+r,e[s]=n%o|0,r=n/o|0;return r&&e.unshift(r),e}function t(e,t,o,n){var r,s;if(o!=n)s=o>n?1:-1;else for(r=s=0;r<o;r++)if(e[r]!=t[r]){s=e[r]>t[r]?1:-1;break}return s}function o(e,t,o,n){for(var r=0;o--;)e[o]-=r,r=e[o]<t[o]?1:0,e[o]=r*n+e[o]-t[o];for(;!e[0]&&e.length>1;)e.shift()}return function(r,s,i,a,d,c){var u,l,f,m,g,h,p,_,b,w,y,x,N,k,M,C,E,S,I,D,G=r.constructor,T=r.s==s.s?1:-1,$=r.d,U=s.d;if(!$||!$[0]||!U||!U[0])return new G(r.s&&s.s&&($?!U||$[0]!=U[0]:U)?$&&0==$[0]||!U?0*T:T/0:NaN);for(c?(g=1,l=r.e-s.e):(c=F,g=O,l=v(r.e/g)-v(s.e/g)),I=U.length,E=$.length,b=new G(T),w=b.d=[],f=0;U[f]==($[f]||0);f++);if(U[f]>($[f]||0)&&l--,null==i?(k=i=G.precision,a=G.rounding):k=d?i+(r.e-s.e)+1:i,k<0)w.push(1),h=!0;else{if(k=k/g+2|0,f=0,1==I){for(m=0,U=U[0],k++;(f<E||m)&&k--;f++)M=m*c+($[f]||0),w[f]=M/U|0,m=M%U|0;h=m||f<E}else{for(m=c/(U[0]+1)|0,m>1&&(U=e(U,m,c),$=e($,m,c),I=U.length,E=$.length),C=I,y=$.slice(0,I),x=y.length;x<I;)y[x++]=0;D=U.slice(),D.unshift(0),S=U[0],U[1]>=c/2&&++S;do{m=0,u=t(U,y,I,x),u<0?(N=y[0],I!=x&&(N=N*c+(y[1]||0)),m=N/S|0,m>1?(m>=c&&(m=c-1),p=e(U,m,c),_=p.length,x=y.length,u=t(p,y,_,x),1==u&&(m--,o(p,I<_?D:U,_,c))):(0==m&&(u=m=1),p=U.slice()),_=p.length,_<x&&p.unshift(0),o(y,p,x,c),-1==u&&(x=y.length,u=t(U,y,I,x),u<1&&(m++,o(y,I<x?D:U,x,c))),x=y.length):0===u&&(m++,y=[0]),w[f++]=m,u&&y[0]?y[x++]=$[C]||0:(y=[$[C]],x=1)}while((C++<E||void 0!==y[0])&&k--);h=void 0!==y[0]}w[0]||w.shift()}if(1==g)b.e=l,n=h;else{for(f=1,m=w[0];m>=10;m/=10)f++;b.e=f+l*g-1,L(b,d?i+b.e+1:i,a,h)}return b}}();function L(e,t,o,n){var r,s,i,a,d,c,u,l,m,g=e.constructor;e:if(null!=t){if(l=e.d,!l)return e;for(r=1,a=l[0];a>=10;a/=10)r++;if(s=t-r,s<0)s+=O,i=t,u=l[m=0],d=u/b(10,r-i-1)%10|0;else if(m=Math.ceil((s+1)/O),a=l.length,m>=a){if(!n)break e;for(;a++<=m;)l.push(0);u=d=0,r=1,s%=O,i=s-O+1}else{for(u=a=l[m],r=1;a>=10;a/=10)r++;s%=O,i=s-O+r,d=i<0?0:u/b(10,r-i-1)%10|0}if(n=n||t<0||void 0!==l[m+1]||(i<0?u:u%b(10,r-i-1)),c=o<4?(d||n)&&(0==o||o==(e.s<0?3:2)):d>5||5==d&&(4==o||n||6==o&&(s>0?i>0?u/b(10,r-i):0:l[m-1])%10&1||o==(e.s<0?8:7)),t<1||!l[0])return l.length=0,c?(t-=e.e+1,l[0]=b(10,(O-t%O)%O),e.e=-t||0):l[0]=e.e=0,e;if(0==s?(l.length=m,a=1,m--):(l.length=m+1,a=b(10,O-s),l[m]=i>0?(u/b(10,r-i)%b(10,i)|0)*a:0),c)for(;;){if(0==m){for(s=1,i=l[0];i>=10;i/=10)s++;for(i=l[0]+=a,a=1;i>=10;i/=10)a++;s!=a&&(e.e++,l[0]==F&&(l[0]=1));break}if(l[m]+=a,l[m]!=F)break;l[m--]=0,a=1}for(s=l.length;0===l[--s];)l.pop()}return f&&(e.e>g.maxE?(e.d=null,e.e=NaN):e.e<g.minE&&(e.e=0,e.d=[0])),e}function U(e,t,o){if(!e.isFinite())return J(e);var n,r=e.e,s=S(e.d),i=s.length;return t?(o&&(n=o-i)>0?s=s.charAt(0)+"."+s.slice(1)+R(n):i>1&&(s=s.charAt(0)+"."+s.slice(1)),s=s+(e.e<0?"e":"e+")+e.e):r<0?(s="0."+R(-r-1)+s,o&&(n=o-i)>0&&(s+=R(n))):r>=i?(s+=R(r+1-i),o&&(n=o-r-1)>0&&(s=s+"."+R(n))):((n=r+1)<i&&(s=s.slice(0,n)+"."+s.slice(n)),o&&(n=o-i)>0&&(r+1===i&&(s+="."),s+=R(n))),s}function q(e,t){var o=e[0];for(t*=O;o>=10;o/=10)t++;return t}function A(e,t,o){if(t>M)throw f=!0,o&&(e.precision=o),Error(h);return L(new e(c),t,1,!0)}function j(e,t,o){if(t>C)throw Error(h);return L(new e(u),t,o,!0)}function P(e){var t=e.length-1,o=t*O+1;if(t=e[t],t){for(;t%10==0;t/=10)o--;for(t=e[0];t>=10;t/=10)o++}return o}function R(e){for(var t="";e--;)t+="0";return t}function Z(e,t,o,n){var r,s=new e(1),i=Math.ceil(n/O+4);for(f=!1;;){if(o%2&&(s=s.times(t),oe(s.d,i)&&(r=!0)),o=v(o/2),0===o){o=s.d.length-1,r&&0===s.d[o]&&++s.d[o];break}t=t.times(t),oe(t.d,i)}return f=!0,s}function H(e){return 1&e.d[e.d.length-1]}function V(e,t,o){for(var n,r=new e(t[0]),s=0;++s<t.length;){if(n=new e(t[s]),!n.s){r=n;break}r[o](n)&&(r=n)}return r}function B(e,t){var o,n,r,s,i,a,d,c=0,u=0,l=0,m=e.constructor,g=m.rounding,h=m.precision;if(!e.d||!e.d[0]||e.e>17)return new m(e.d?e.d[0]?e.s<0?0:1/0:1:e.s?e.s<0?0:e:NaN);null==t?(f=!1,d=h):d=t,a=new m(.03125);while(e.e>-2)e=e.times(a),l+=5;for(n=Math.log(b(2,l))/Math.LN10*2+5|0,d+=n,o=s=i=new m(1),m.precision=d;;){if(s=L(s.times(e),d,1),o=o.times(++u),a=i.plus($(s,o,d,1)),S(a.d).slice(0,d)===S(i.d).slice(0,d)){r=l;while(r--)i=L(i.times(i),d,1);if(null!=t)return m.precision=h,i;if(!(c<3&&D(i.d,d-n,g,c)))return L(i,m.precision=h,g,f=!0);m.precision=d+=10,o=s=a=new m(1),u=0,c++}i=a}}function z(e,t){var o,n,r,s,i,a,d,c,u,l,m,g=1,h=10,p=e,_=p.d,v=p.constructor,b=v.rounding,w=v.precision;if(p.s<0||!_||!_[0]||!p.e&&1==_[0]&&1==_.length)return new v(_&&!_[0]?-1/0:1!=p.s?NaN:_?0:p);if(null==t?(f=!1,u=w):u=t,v.precision=u+=h,o=S(_),n=o.charAt(0),!(Math.abs(s=p.e)<15e14))return c=A(v,u+2,w).times(s+""),p=z(new v(n+"."+o.slice(1)),u-h).plus(c),v.precision=w,null==t?L(p,w,b,f=!0):p;while(n<7&&1!=n||1==n&&o.charAt(1)>3)p=p.times(e),o=S(p.d),n=o.charAt(0),g++;for(s=p.e,n>1?(p=new v("0."+o),s++):p=new v(n+"."+o.slice(1)),l=p,d=i=p=$(p.minus(1),p.plus(1),u,1),m=L(p.times(p),u,1),r=3;;){if(i=L(i.times(m),u,1),c=d.plus($(i,new v(r),u,1)),S(c.d).slice(0,u)===S(d.d).slice(0,u)){if(d=d.times(2),0!==s&&(d=d.plus(A(v,u+2,w).times(s+""))),d=$(d,new v(g),u,1),null!=t)return v.precision=w,d;if(!D(d.d,u-h,b,a))return L(d,v.precision=w,b,f=!0);v.precision=u+=h,c=i=p=$(l.minus(1),l.plus(1),u,1),m=L(p.times(p),u,1),r=a=1}d=c,r+=2}}function J(e){return String(e.s*e.s/0)}function W(e,t){var o,n,r;for((o=t.indexOf("."))>-1&&(t=t.replace(".","")),(n=t.search(/e/i))>0?(o<0&&(o=n),o+=+t.slice(n+1),t=t.substring(0,n)):o<0&&(o=t.length),n=0;48===t.charCodeAt(n);n++);for(r=t.length;48===t.charCodeAt(r-1);--r);if(t=t.slice(n,r),t){if(r-=n,e.e=o=o-n-1,e.d=[],n=(o+1)%O,o<0&&(n+=O),n<r){for(n&&e.d.push(+t.slice(0,n)),r-=O;n<r;)e.d.push(+t.slice(n,n+=O));t=t.slice(n),n=O-t.length}else n-=r;for(;n--;)t+="0";e.d.push(+t),f&&(e.e>e.constructor.maxE?(e.d=null,e.e=NaN):e.e<e.constructor.minE&&(e.e=0,e.d=[0]))}else e.e=0,e.d=[0];return e}function X(e,t){var o,n,r,s,i,a,d,c,u;if(t.indexOf("_")>-1){if(t=t.replace(/(\d)_(?=\d)/g,"$1"),N.test(t))return W(e,t)}else if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(y.test(t))o=16,t=t.toLowerCase();else if(w.test(t))o=2;else{if(!x.test(t))throw Error(g+t);o=8}for(s=t.search(/p/i),s>0?(d=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),s=t.indexOf("."),i=s>=0,n=e.constructor,i&&(t=t.replace(".",""),a=t.length,s=a-s,r=Z(n,new n(o),s,2*s)),c=G(t,o,F),u=c.length-1,s=u;0===c[s];--s)c.pop();return s<0?new n(0*e.s):(e.e=q(c,u),e.d=c,f=!1,i&&(e=$(e,r,4*a)),d&&(e=e.times(Math.abs(d)<54?b(2,d):He.pow(2,d))),f=!0,e)}function Y(e,t){var o,n,r=t.d.length;if(r<3)return t.isZero()?t:K(e,2,t,t);o=1.4*Math.sqrt(r),o=o>16?16:0|o,t=t.times(1/Q(5,o)),t=K(e,2,t,t);for(var s=new e(5),i=new e(16),a=new e(20);o--;)n=t.times(t),t=t.times(s.plus(n.times(i.times(n).minus(a))));return t}function K(e,t,o,n,r){var s,i,a,d,c=e.precision,u=Math.ceil(c/O);for(f=!1,d=o.times(o),a=new e(n);;){if(i=$(a.times(d),new e(t++*t++),c,1),a=r?n.plus(i):n.minus(i),n=$(i.times(d),new e(t++*t++),c,1),i=a.plus(n),void 0!==i.d[u]){for(s=u;i.d[s]===a.d[s]&&s--;);if(-1==s)break}s=a,a=n,n=i,i=s}return f=!0,i.d.length=u+1,i}function Q(e,t){var o=e;while(--t)o*=e;return o}function ee(e,t){var o,n=t.s<0,s=j(e,e.precision,1),i=s.times(.5);if(t=t.abs(),t.lte(i))return r=n?4:1,t;if(o=t.divToInt(s),o.isZero())r=n?3:2;else{if(t=t.minus(o.times(s)),t.lte(i))return r=H(o)?n?2:3:n?4:1,t;r=H(o)?n?1:4:n?3:2}return t.minus(s).abs()}function te(e,t,o,r){var s,i,c,u,l,f,m,g,h,p=e.constructor,_=void 0!==o;if(_?(I(o,1,a),void 0===r?r=p.rounding:I(r,0,8)):(o=p.precision,r=p.rounding),e.isFinite()){for(m=U(e),c=m.indexOf("."),_?(s=2,16==t?o=4*o-3:8==t&&(o=3*o-2)):s=t,c>=0&&(m=m.replace(".",""),h=new p(1),h.e=m.length-c,h.d=G(U(h),10,s),h.e=h.d.length),g=G(m,10,s),i=l=g.length;0==g[--l];)g.pop();if(g[0]){if(c<0?i--:(e=new p(e),e.d=g,e.e=i,e=$(e,h,o,r,0,s),g=e.d,i=e.e,f=n),c=g[o],u=s/2,f=f||void 0!==g[o+1],f=r<4?(void 0!==c||f)&&(0===r||r===(e.s<0?3:2)):c>u||c===u&&(4===r||f||6===r&&1&g[o-1]||r===(e.s<0?8:7)),g.length=o,f)for(;++g[--o]>s-1;)g[o]=0,o||(++i,g.unshift(1));for(l=g.length;!g[l-1];--l);for(c=0,m="";c<l;c++)m+=d.charAt(g[c]);if(_){if(l>1)if(16==t||8==t){for(c=16==t?4:3,--l;l%c;l++)m+="0";for(g=G(m,s,t),l=g.length;!g[l-1];--l);for(c=1,m="1.";c<l;c++)m+=d.charAt(g[c])}else m=m.charAt(0)+"."+m.slice(1);m=m+(i<0?"p":"p+")+i}else if(i<0){for(;++i;)m="0"+m;m="0."+m}else if(++i>l)for(i-=l;i--;)m+="0";else i<l&&(m=m.slice(0,i)+"."+m.slice(i))}else m=_?"0p+0":"0";m=(16==t?"0x":2==t?"0b":8==t?"0o":"")+m}else m=J(e);return e.s<0?"-"+m:m}function oe(e,t){if(e.length>t)return e.length=t,!0}function ne(e){return new this(e).abs()}function re(e){return new this(e).acos()}function se(e){return new this(e).acosh()}function ie(e,t){return new this(e).plus(t)}function ae(e){return new this(e).asin()}function de(e){return new this(e).asinh()}function ce(e){return new this(e).atan()}function ue(e){return new this(e).atanh()}function le(e,t){var o;e=new this(e),t=new this(t);var n=this.precision,r=this.rounding,s=n+4;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(o=t.s<0?j(this,n,r):new this(0),o.s=e.s):!e.d||t.isZero()?(o=j(this,s,1).times(.5),o.s=e.s):t.s<0?(this.precision=s,this.rounding=1,o=this.atan($(e,t,s,1)),t=j(this,s,1),this.precision=n,this.rounding=r,o=e.s<0?o.minus(t):o.plus(t)):o=this.atan($(e,t,s,1)):(o=j(this,s,1).times(t.s>0?.25:.75),o.s=e.s):o=new this(NaN),o}function fe(e){return new this(e).cbrt()}function me(e){return L(e=new this(e),e.e+1,2)}function ge(e,t,o){return new this(e).clamp(t,o)}function he(e){if(!e||"object"!==Object(s["a"])(e))throw Error(m+"Object expected");var t,o,n,r=!0===e.defaults,d=["precision",1,a,"rounding",0,8,"toExpNeg",-i,0,"toExpPos",0,i,"maxE",0,i,"minE",-i,0,"modulo",0,9];for(t=0;t<d.length;t+=3)if(o=d[t],r&&(this[o]=l[o]),void 0!==(n=e[o])){if(!(v(n)===n&&n>=d[t+1]&&n<=d[t+2]))throw Error(g+o+": "+n);this[o]=n}if(o="crypto",r&&(this[o]=l[o]),void 0!==(n=e[o])){if(!0!==n&&!1!==n&&0!==n&&1!==n)throw Error(g+o+": "+n);if(n){if("undefined"===typeof crypto||!crypto||!crypto.getRandomValues&&!crypto.randomBytes)throw Error(p);this[o]=!0}else this[o]=!1}return this}function pe(e){return new this(e).cos()}function _e(e){return new this(e).cosh()}function ve(e){var t,o,n;function r(e){var t,o,n,i=this;if(!(i instanceof r))return new r(e);if(i.constructor=r,Ne(e))return i.s=e.s,void(f?!e.d||e.e>r.maxE?(i.e=NaN,i.d=null):e.e<r.minE?(i.e=0,i.d=[0]):(i.e=e.e,i.d=e.d.slice()):(i.e=e.e,i.d=e.d?e.d.slice():e.d));if(n=Object(s["a"])(e),"number"===n){if(0===e)return i.s=1/e<0?-1:1,i.e=0,void(i.d=[0]);if(e<0?(e=-e,i.s=-1):i.s=1,e===~~e&&e<1e7){for(t=0,o=e;o>=10;o/=10)t++;return void(f?t>r.maxE?(i.e=NaN,i.d=null):t<r.minE?(i.e=0,i.d=[0]):(i.e=t,i.d=[e]):(i.e=t,i.d=[e]))}return 0*e!==0?(e||(i.s=NaN),i.e=NaN,void(i.d=null)):W(i,e.toString())}if("string"!==n)throw Error(g+e);return 45===(o=e.charCodeAt(0))?(e=e.slice(1),i.s=-1):(43===o&&(e=e.slice(1)),i.s=1),N.test(e)?W(i,e):X(i,e)}if(r.prototype=E,r.ROUND_UP=0,r.ROUND_DOWN=1,r.ROUND_CEIL=2,r.ROUND_FLOOR=3,r.ROUND_HALF_UP=4,r.ROUND_HALF_DOWN=5,r.ROUND_HALF_EVEN=6,r.ROUND_HALF_CEIL=7,r.ROUND_HALF_FLOOR=8,r.EUCLID=9,r.config=r.set=he,r.clone=ve,r.isDecimal=Ne,r.abs=ne,r.acos=re,r.acosh=se,r.add=ie,r.asin=ae,r.asinh=de,r.atan=ce,r.atanh=ue,r.atan2=le,r.cbrt=fe,r.ceil=me,r.clamp=ge,r.cos=pe,r.cosh=_e,r.div=be,r.exp=we,r.floor=ye,r.hypot=xe,r.ln=Fe,r.log=Oe,r.log10=Me,r.log2=ke,r.max=Ce,r.min=Ee,r.mod=Se,r.mul=Ie,r.pow=De,r.random=Ge,r.round=Te,r.sign=$e,r.sin=Le,r.sinh=Ue,r.sqrt=qe,r.sub=Ae,r.sum=je,r.tan=Pe,r.tanh=Re,r.trunc=Ze,void 0===e&&(e={}),e&&!0!==e.defaults)for(n=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],t=0;t<n.length;)e.hasOwnProperty(o=n[t++])||(e[o]=this[o]);return r.config(e),r}function be(e,t){return new this(e).div(t)}function we(e){return new this(e).exp()}function ye(e){return L(e=new this(e),e.e+1,3)}function xe(){var e,t,o=new this(0);for(f=!1,e=0;e<arguments.length;)if(t=new this(arguments[e++]),t.d)o.d&&(o=o.plus(t.times(t)));else{if(t.s)return f=!0,new this(1/0);o=t}return f=!0,o.sqrt()}function Ne(e){return e instanceof He||e&&e.toStringTag===_||!1}function Fe(e){return new this(e).ln()}function Oe(e,t){return new this(e).log(t)}function ke(e){return new this(e).log(2)}function Me(e){return new this(e).log(10)}function Ce(){return V(this,arguments,"lt")}function Ee(){return V(this,arguments,"gt")}function Se(e,t){return new this(e).mod(t)}function Ie(e,t){return new this(e).mul(t)}function De(e,t){return new this(e).pow(t)}function Ge(e){var t,o,n,r,s=0,i=new this(1),d=[];if(void 0===e?e=this.precision:I(e,1,a),n=Math.ceil(e/O),this.crypto)if(crypto.getRandomValues)for(t=crypto.getRandomValues(new Uint32Array(n));s<n;)r=t[s],r>=429e7?t[s]=crypto.getRandomValues(new Uint32Array(1))[0]:d[s++]=r%1e7;else{if(!crypto.randomBytes)throw Error(p);for(t=crypto.randomBytes(n*=4);s<n;)r=t[s]+(t[s+1]<<8)+(t[s+2]<<16)+((127&t[s+3])<<24),r>=214e7?crypto.randomBytes(4).copy(t,s):(d.push(r%1e7),s+=4);s=n/4}else for(;s<n;)d[s++]=1e7*Math.random()|0;for(n=d[--s],e%=O,n&&e&&(r=b(10,O-e),d[s]=(n/r|0)*r);0===d[s];s--)d.pop();if(s<0)o=0,d=[0];else{for(o=-1;0===d[0];o-=O)d.shift();for(n=1,r=d[0];r>=10;r/=10)n++;n<O&&(o-=O-n)}return i.e=o,i.d=d,i}function Te(e){return L(e=new this(e),e.e+1,this.rounding)}function $e(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function Le(e){return new this(e).sin()}function Ue(e){return new this(e).sinh()}function qe(e){return new this(e).sqrt()}function Ae(e,t){return new this(e).sub(t)}function je(){var e=0,t=arguments,o=new this(t[e]);for(f=!1;o.s&&++e<t.length;)o=o.plus(t[e]);return f=!0,L(o,this.precision,this.rounding)}function Pe(e){return new this(e).tan()}function Re(e){return new this(e).tanh()}function Ze(e){return L(e=new this(e),e.e+1,1)}E[Symbol.for("nodejs.util.inspect.custom")]=E.toString,E[Symbol.toStringTag]="Decimal";var He=E.constructor=ve(l);c=new He(c),u=new He(u),t["a"]=He},b14f:function(e,t,o){"use strict";var n=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"orders-goods-table"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataLoading,expression:"dataLoading"}],ref:"goodsTable",staticClass:"aux-table",attrs:{data:e.goodsList,border:"",fit:"","show-summary":"","summary-method":e.summaryMethod}},[o("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),o("el-table-column",{attrs:{width:"120",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-button",{staticStyle:{padding:"6px 12px"},attrs:{type:"default",size:"mini",icon:"el-icon-plus",round:""},on:{click:function(o){return e.handleItemPlus(t.row,t.$index)}}}),o("el-button",{staticStyle:{padding:"6px 12px"},attrs:{type:"default",size:"mini",icon:"el-icon-minus",round:""},on:{click:function(o){return e.handleItemMinus(t.row,t.$index)}}})]}}])}),o("el-table-column",{attrs:{width:"280",align:"left",label:"商品名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.goods_name?o("div",{staticClass:"dflex"},[o("div",{staticClass:"goods-img"},[o("img",{attrs:{src:t.row.goods_img||"/static/img/img-empty.png",alt:""}})]),o("div",{staticClass:"flex1"},[o("div",[e._v(e._s(t.row.goods_name))]),t.row.goods_no?o("div",{staticClass:"fs-xs ft-grey"},[e._v("No："+e._s(t.row.goods_no))]):e._e()])]):o("div",[o("AuxGoodsSelectPopoer",{on:{change:function(o){return e.changeItemGoods(o,t.row)}},model:{value:t.row.goods_id,callback:function(o){e.$set(t.row,"goods_id",o)},expression:"scope.row.goods_id"}})],1)]}}])}),o("el-table-column",{attrs:{width:"200",align:"left",label:"规格/属性"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("span",[e._v(e._s(t.row.goods_spec))])]}}])}),o("el-table-column",{attrs:{width:"130",align:"center",label:"单位"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-select",{attrs:{disabled:!t.row.goods_name,placeholder:"单位"},on:{focus:function(o){return e.remoteItemGoodsUnitMethod(t.row)},change:function(o){return e.changeItemGoodsUnit(t.row)}},model:{value:t.row.goods_unit,callback:function(o){e.$set(t.row,"goods_unit",o)},expression:"scope.row.goods_unit"}},e._l(e.getItemGoodsUnitOptions(t.row.goods_id),(function(t){return o("el-option-group",{key:t.label,attrs:{label:t.label}},e._l(t.children,(function(t){return o("el-option",{key:t.unit,attrs:{label:t.unit+(t.unit_desc||""),value:t.unit}},[o("span",[e._v(e._s(t.unit)+e._s(t.unit_desc))])])})),1)})),1)]}}])}),o("el-table-column",{attrs:{width:"120",align:"center",label:"数量",prop:"goods_cnt"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{staticClass:"tac",attrs:{disabled:!t.row.goods_name,oninput:"value=value.match(/^\\d+(?:\\.\\d{0,2})?/)",onfocus:"this.select();",placeholder:"数量"},on:{blur:e.changeOrdersCompleted},model:{value:t.row.goods_cnt,callback:function(o){e.$set(t.row,"goods_cnt",o)},expression:"scope.row.goods_cnt"}})]}}])}),o("el-table-column",{attrs:{width:"120",align:"right",label:"原价(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{staticClass:"tar",attrs:{disabled:!t.row.goods_name,oninput:"value=value.match(/^\\d+(?:\\.\\d{0,2})?/)",onfocus:"this.select();",placeholder:"原价"},on:{blur:function(o){return e.changeItemGoodsOriPrice(t.row)}},model:{value:t.row.goods_ori_price,callback:function(o){e.$set(t.row,"goods_ori_price",o)},expression:"scope.row.goods_ori_price"}})]}}])}),o("el-table-column",{attrs:{width:"120",align:"right",label:"折扣(%)"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{staticClass:"tar",attrs:{disabled:!t.row.goods_name,min:"0",max:"100",oninput:"value=value.match(/^\\d+(?:\\.\\d{0,2})?/)",onfocus:"this.select();",placeholder:"折扣"},on:{blur:function(o){return e.changeItemGoodsRate(t.row)}},model:{value:t.row.goods_rate,callback:function(o){e.$set(t.row,"goods_rate",o)},expression:"scope.row.goods_rate"}})]}}])}),o("el-table-column",{attrs:{width:"120",align:"right",label:"单价(元)"},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-input",{staticClass:"tar",attrs:{disabled:!t.row.goods_name,oninput:"value=value.match(/^\\d+(?:\\.\\d{0,2})?/)",onfocus:"this.select();",placeholder:"单价"},on:{blur:function(o){return e.changeItemGoodsPrice(t.row)}},model:{value:t.row.goods_price,callback:function(o){e.$set(t.row,"goods_price",o)},expression:"scope.row.goods_price"}})]}}])}),o("el-table-column",{attrs:{width:"120",align:"right",label:"金额小计(元)",prop:"total_money"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.total_money))]}}])}),o("el-table-column",{attrs:{align:"left",label:"备注","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(t){return[o("el-popover",{attrs:{placement:"top-start",title:"编辑备注信息",width:"300",trigger:"click"}},[o("el-input",{attrs:{type:"textarea",rows:2,placeholder:"请输入备注"},model:{value:t.row.remark,callback:function(o){e.$set(t.row,"remark",o)},expression:"scope.row.remark"}}),o("span",{staticClass:"link-hover ft-primary",attrs:{slot:"reference"},slot:"reference"},[e._v(" "+e._s(t.row.remark||"编辑")+" ")])],1)]}}])})],1),o("div",{staticClass:"dflex-b padding"},[o("div",{staticClass:"dflex-s"},[o("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.handleSelectAdd}},[e._v("选择商品")]),e.scanForm.visible?o("el-input",{ref:"scanInput",staticClass:"margin-lr-sm",staticStyle:{width:"260px"},attrs:{clearable:"",size:"small",placeholder:"请扫描商品编码或条形码"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.handleScanAdd(t)}},model:{value:e.scanForm.keyword,callback:function(t){e.$set(e.scanForm,"keyword",t)},expression:"scanForm.keyword"}}):e._e(),o("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-full-screen"},on:{click:e.handleScanOpen}},[e._v(" "+e._s(e.scanForm.visible?"取消扫码":"扫码录入")+" ")]),o("el-button",{attrs:{type:"default",size:"small",icon:"el-icon-folder-opened"},on:{click:e.handleImportAdd}},[e._v("导入商品")])],1),o("div",{staticClass:"dflex-e"},[o("span",{staticClass:"padding-left-lg"},[e._v("商品数量："+e._s(e.goodsTotalCount))]),o("span",{staticClass:"padding-left-lg"},[e._v("原价金额："+e._s(e.goodsOriginalMoney.toFixed(2)))]),o("span",{staticClass:"padding-left-lg"},[e._v("折扣优惠："+e._s(e.goodsDiscountMoney.toFixed(2)))]),o("span",{staticClass:"padding-left-lg"},[e._v("商品总额："+e._s(e.goodsTotalMoney.toFixed(2)))])])]),o("ImportGoodsDialog",{ref:"importGoodsDialog",on:{onSuccess:e.importGoodsSuccess}}),o("AuxGoodsSelectDialog",{ref:"auxGoodsSelectDialog",on:{onSuccess:e.selectedGoodsSuccess}})],1)},r=[],s=o("2909"),i=(o("d81d"),o("498a"),o("d3b7"),o("159b"),o("a434"),o("b0c0"),o("4de4"),o("a9e3"),o("b680"),o("13d5"),o("caad"),o("2197")),a=o("c031"),d=o("b122"),c=o("15f6"),u=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-dialog",{attrs:{title:"销售商品导入",visible:e.dialogVisible,width:"50%","before-close":e.close,"append-to-body":"","custom-class":"import-dialog"},on:{"update:visible":function(t){e.dialogVisible=t}}},[o("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loadOpts.loading,expression:"loadOpts.loading"}],staticClass:"dialog-warpper",attrs:{"element-loading-text":e.loadOpts.loadtext}},[o("div",{staticClass:"grid-box-2"},[o("div",{staticClass:"flex1",on:{click:e.downloadTemp}},[o("span",[e._v("1.下载Excel模板")]),o("div",{staticClass:"box-item margin-top"},[o("div",{staticClass:"icon el-icon-document"}),o("div",{staticClass:"txt fs"},[e._v("点击下载Excel模板")])])]),o("div",{staticClass:"flex1"},[o("span",[e._v("2.上传Excel文件")]),o("div",{staticClass:"box-item margin-top"},[o("upload-excel-component",{attrs:{"skin-row":e.skinRow,"before-upload":e.beforeUpload,"on-success":e.uploadSuccess,"on-error":e.uploadError}})],1)])])]),e.errorMsg?o("div",{staticClass:"dialog-error"},[o("p",[e._v("异常错误")]),o("div",[e._v(e._s(e.errorMsg))])]):e._e(),o("div",{staticClass:"dialog-footer"},[o("p",[e._v("操作指引")]),o("p",[e._v("1、下载Excel模板，填写Excel表格;")]),o("p",[e._v("2、将文件拖动到虚线框 -> 系统自动检验数据;")]),o("p",[e._v("3、数据导入成功;")])])])},l=[],f=(o("a15b"),o("3796")),m=o("c7eb"),g=o("1da1"),h=(o("ac1f"),o("00b4"),o("b64b"),o("3ca3"),o("ddb0"),o("2a95")),p={"商品ID":{name:"goods_id",type:"string"},"商品图片":{name:"goods_img",type:"url",message:"商品图片必需是完整的Url地址"},"商品名称":{name:"goods_name",type:"any",required:!0,message:"商品名称不能为空"},"商品编号*":{name:"goods_no",type:"any",required:!0,message:"商品编号不能为空"},"规格":{name:"goods_spec",type:"string",message:"商品规格必需是字符"},"单位":{name:"goods_unit",type:"string",message:"商品单位不能为空"},"数量*":{name:"goods_cnt",type:"number",required:!0,validator:function(e,t,o,n,r){var s=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/;s.test(t)||o("数量*必需为数字"),o()}},"折扣":{name:"goods_rate",type:"number",validator:function(e,t,o,n,r){var s=/((^[1-9]\d*)|^0)(\.\d{0,2}){0,1}$/;!t||s.test(t)?o():o("折扣必需为1~100内数字")}},"单价":{name:"goods_price",type:"number",message:"单价必需是数字"},"备注":{name:"remark",type:"string"}};function _(e,t){return Object.keys(e).forEach((function(o){var n=e[o],r=t[o];r&&(e[r.name]=r.handle?r.handle(n):n)})),e}function v(e){return b.apply(this,arguments)}function b(){return b=Object(g["a"])(Object(m["a"])().mark((function e(t){var o,n,r;return Object(m["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.header,o=t.dataList,n=new h["a"](p),r=o.map((function(e,t){return new Promise((function(o,r){n.validate(e,(function(n,s){n&&r({errors:n,rowIndex:t}),o(_(e,p))}))}))})),e.next=5,Promise.all(r);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)}))),b.apply(this,arguments)}var w={components:{UploadExcelComponent:f["a"]},props:{fileType:{type:String,default:function(){return""}}},data:function(){return{dialogVisible:!1,skinRow:1,loadOpts:{loading:!1,loadtext:"正在加载中"},downOpts:{fileName:"销售导入商品模板_"+(new Date).getTime()+".xlsx",tempUrl:location.protocol+"//"+location.host+"/static/excel/template/salesPrepareTemplate.xlsx"},tableHeader:[],tableData:[],errorMsg:""}},methods:{open:function(){this.dialogVisible=!0},close:function(){this.errorMsg="",this.dialogVisible=!1},downloadTemp:function(){var e=document.createElement("a");e.style.display="none",e.download=this.downOpts.fileName,e.href=this.downOpts.tempUrl,document.body.appendChild(e),e.click(),document.body.removeChild(e)},beforeUpload:function(e){this.errorMsg="",this.loadOpts.loading=!0;var t=e.size/1024/1024<1;return!!t||(this.$message({message:"请不要上传大于1M的文件",type:"warning"}),this.loadOpts.loading=!1,!1)},uploadSuccess:function(e){var t=this,o=e.header,n=e.results;this.tableHeader=o,this.tableData=n,this.loadOpts.loading=!0,this.loadOpts.loadtext="正在校验数据",v({header:o,dataList:n}).then((function(e){setTimeout((function(){t.loadOpts.loading=!1,t.$emit("onSuccess",e),t.close()}),1e3)})).catch((function(e){t.loadOpts.loading=!1;var o=e.errors;if(o){var n=o.map((function(e,t){return t+1+"."+e.field+": "+e.message}));t.errorMsg=n.join("; ")}}))},uploadError:function(e){console.log(e),this.loadOpts.loading=!1}}},y=w,x=(o("e64f"),o("2877")),N=Object(x["a"])(y,u,l,!1,null,null,null),F=N.exports,O=o("5bc5"),k={components:{AuxGoodsSelectPopoer:c["a"],ImportGoodsDialog:F,AuxGoodsSelectDialog:d["a"]},data:function(){return{dataLoading:!1,goodsList:[this.formatItemGoods()],goodsSelectIds:[],goodsSaleGrade:0,goodsTotalCount:0,goodsOriginalMoney:0,goodsDiscountMoney:0,goodsTotalMoney:0,goodsUnitMap:{},scanForm:{visible:!1,keyword:""}}},methods:{initData:function(e){var t=this;this.goodsList=e.map((function(e){return t.formatItemGoods(e)})),this.changeOrdersCompleted()},handleScanOpen:function(){var e=this;this.scanForm.visible=!this.scanForm.visible,this.scanForm.visible&&this.$nextTick((function(){e.$refs.scanInput.focus()}))},handleScanAdd:function(){var e=this,t=this.scanForm.keyword.trim();t&&(this.scanForm.keyword="",Object(i["a"])("goods/getGoodsByCode",{code:t},{functionName:"xunda"}).then((function(t){var o=e.formatItemGoods(t.data,{remark:"",goods_cnt:1});e.initGoodsUnit(o),e.goodsList.push(o)})))},handleSelectAdd:function(){this.$refs.auxGoodsSelectDialog.open()},selectedGoodsSuccess:function(e){var t=this;e.forEach((function(e){t.initGoodsUnit(e),t.goodsList.push(t.formatItemGoods(e,{remark:"",goods_cnt:e.goods_cnt}))})),this.changeOrdersCompleted()},handleImportAdd:function(){this.$refs.importGoodsDialog.open()},importGoodsSuccess:function(e){var t=this;e.forEach((function(e){var o=t.formatItemGoods(e);t.initGoodsUnit(o),t.goodsList.push(o)}))},handleItemPlus:function(e,t){this.goodsList.splice(t+1,0,this.formatItemGoods())},handleItemMinus:function(e,t){this.goodsList.splice(t,1),0===this.goodsList.length&&this.goodsList.push(this.formatItemGoods()),this.changeOrdersCompleted()},initGoodsUnit:function(e){this.goodsUnitMap[e._id]=e.unit_list||[]},formatItemGoods:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=e.goods_price||(e.sale_price||e.price||0)/100,n={goods_id:e.goods_id||e._id||"",goods_sku_id:e.goods_sku_id||e.sku_id||"",goods_no:e.goods_no||e.code||"",goods_img:e.goods_img||e.img||"",goods_name:e.goods_name||e.name||"",goods_spec:e.goods_spec||e.spec||"",goods_cnt:e.goods_cnt||t.goods_cnt||0,goods_unit:e.goods_unit||e.unit||"",goods_ori_price:e.goods_ori_price||o||0,goods_rate:e.goods_rate||100,goods_price:o,total_money:e.total_money||0,remark:e.remark||t.remark||""};return n},changeItemGoods:function(e,t){var o=this;t.goodsId||(e.goods?(Object.assign(t,this.formatItemGoods(e.goods,{remark:t.remark,goods_cnt:1})),this.initGoodsUnit(e.goods),this.changeOrdersCompleted()):Object(i["a"])("goods/getInfo",{goods_id:t.goods_id},{functionName:"xunda"}).then((function(e){var n=Object.assign(t,o.formatItemGoods(e.data,{remark:t.remark,goods_cnt:1}));o.initGoodsUnit(n),o.changeOrdersCompleted()})))},getItemGoodsUnitOptions:function(e){if(!e)return[];var t=this.goodsUnitMap[e]||[];if(0===t.length)return[];var o=[{label:"默认单位",children:t.filter((function(e){return 1===e.scale}))}],n=t.filter((function(e){return 1!==e.scale}));return n.length>0&&o.push({label:"辅助单位",children:n}),o},remoteItemGoodsUnitMethod:function(e){var t=this;if(e.goods_id){var o=this.goodsUnitMap[e.goods_id]||[];o.length>1||Object(i["a"])("goods/getInfo",{goods_id:e.goods_id},{functionName:"xunda"}).then((function(e){var o=e.data;t.goodsUnitMap[o._id]=o.unit_list,Object(a["f"])(o),t.goodsList=Object(s["a"])(t.goodsList)}))}},changeItemGoodsUnit:function(e){if(e.goods_id){var t=this.goodsUnitMap[e.goods_id]||[],o=t.filter((function(t){return t.unit===e.goods_unit}));if(0!==o.length){var n=o[0],r=Object(a["b"])(e.goods_id);if(r){var s=O["a"].mul(r.price,n.scale),i=r.sku_datas.filter((function(t){return t.name===e.goods_spec}));if(i.length>0){var d=i.filter((function(t){return t.unit===e.goods_unit}));d.length>0&&(s=d[0].price||0)}var c=Number(s/100);e.goods_ori_price=c.toFixed(2);var u=O["a"].div(e.goods_rate||0,100).toFixed(2);e.goods_price=e.goods_ori_price*u,e.goods_rate=Number(e.goods_rate).toFixed(2),this.changeOrdersCompleted()}}}},changeItemGoodsOriPrice:function(e){var t=Number(e.goods_ori_price||0),o=Number(e.goods_rate||0);e.goods_price=t*(o/100),this.changeOrdersCompleted()},changeItemGoodsRate:function(e){var t=Number(e.goods_ori_price||0),o=Math.max(Math.min(100,Number(e.goods_rate||0)),0);e.goods_rate=o.toFixed(2),e.goods_price=t*(e.goods_rate/100),this.changeOrdersCompleted()},changeItemGoodsPrice:function(e){var t=Number(e.goods_ori_price||0),o=Math.min(Number(e.goods_ori_price||0),Number(e.goods_price||0));e.goods_price=o.toFixed(2),e.goods_rate=(o/t*100).toFixed(2),this.changeOrdersCompleted()},changeOrdersCompleted:function(){this.goodsList.forEach((function(e){e.goods_ori_price=Number(e.goods_ori_price||0).toFixed(2),e.goods_cnt=Number(e.goods_cnt||0),e.goods_price=Number(e.goods_price||0).toFixed(2),e.total_ori_money=(e.goods_cnt*e.goods_ori_price).toFixed(2),e.total_money=(e.goods_cnt*e.goods_price).toFixed(2)})),this.goodsTotalCount=this.goodsList.reduce((function(e,t){return e+t.goods_cnt}),0),this.goodsOriginalMoney=this.goodsList.reduce((function(e,t){return e+Number(t.total_ori_money)}),0),this.goodsTotalMoney=this.goodsList.reduce((function(e,t){return e+Number(t.total_money)}),0),this.goodsDiscountMoney=this.goodsOriginalMoney-this.goodsTotalMoney,this.$emit("change")},getSummaryData:function(){return{goodsTotalCount:this.goodsTotalCount,goodsOriginalMoney:this.goodsOriginalMoney,goodsDiscountMoney:this.goodsDiscountMoney,goodsTotalMoney:this.goodsTotalMoney}},getListData:function(){return this.goodsList.filter((function(e){return!!e.goods_name}))},summaryMethod:function(e){var t=e.columns,o=e.data,n=[];return t.forEach((function(e,t){if(0!==t)if(["goods_cnt","total_money"].includes(e.property)){var r=o.map((function(t){return Number(t[e.property])}));r.every((function(e){return isNaN(e)}))?n[t]="":(n[t]=r.reduce((function(e,t){return e+t}),0),["total_money"].includes(e.property)&&(n[t]=n[t].toFixed(2)))}else n[t]=" ";else n[t]="合计"})),n}}},M=k,C=(o("1693"),Object(x["a"])(M,n,r,!1,null,null,null));t["a"]=C.exports},d677:function(e,t,o){},e64f:function(e,t,o){"use strict";o("f989")},f989:function(e,t,o){}}]);