(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-06140bf0"],{"01f2":function(t,e,n){"use strict";n("dff1")},9684:function(t,e,n){"use strict";n.r(e);var i=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"app-container"},[n("div",{staticClass:"aux-card"},[n("div",{staticClass:"header"},[t._m(0),n("div",{staticClass:"dflex"},[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["goods-brand-edit"],expression:"['goods-brand-edit']"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.append()}}},[t._v("新增品牌")])],1)]),n("div",{staticClass:"padding"},[n("el-tree",{staticClass:"brand-tree",attrs:{data:t.treeList,"default-expanded-keys":t.expandedKeys,"icon-class":"e","node-key":"_id","default-expand-all":!1,"expand-on-click-node":!0,"highlight-current":!1,draggable:t.$hasPermission(["goods-brand-edit"]),"allow-drag":t.allowDrag,"allow-drop":t.allowDrop},on:{"node-drop":t.nodeDropComplate},scopedSlots:t._u([{key:"default",fn:function(e){var i=e.node,a=e.data;return n("div",{staticClass:"tree-node"},[n("div",{staticClass:"left-icon"},[n("i",{staticClass:"el-icon-price-tag"})]),t.editMode&&t.editRowId==a._id?n("div",{staticClass:"right-content dflex-s",on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.voidStop(e)}}},[n("el-input",{ref:"editInput",staticStyle:{width:"300px"},attrs:{placeholder:"填写品牌名称",clearable:""},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.submitEdit(i,a)}},model:{value:t.editValue,callback:function(e){t.editValue=e},expression:"editValue"}}),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["goods-brand-edit"],expression:"['goods-brand-edit']"}],staticClass:"padding-lr margin-left",attrs:{type:"success",icon:"el-icon-check",round:"",size:"small"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.submitEdit(i,a)}}},[t._v("确认")]),n("el-button",{staticClass:"padding-lr",attrs:{type:"default",icon:"el-icon-yes",round:"",size:"small"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.cancelEdit(i,a)}}},[t._v("取消")])],1):n("div",{staticClass:"right-content dflex-b"},[n("div",[t._v(t._s(a.brand_name))]),n("div",{staticClass:"opt-btn"},[n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["goods-brand-edit"],expression:"['goods-brand-edit']"}],attrs:{type:"success",round:"",size:"small",plain:"",icon:"el-icon-edit-outline"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.editItem(i,a)}}},[t._v("修改")]),n("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["goods-brand-delete"],expression:"['goods-brand-delete']"}],attrs:{type:"danger",round:"",size:"small",plain:"",icon:"el-icon-delete"},on:{click:function(e){return e.stopPropagation(),e.preventDefault(),t.deleteItem(i,a)}}},[t._v("删除")])],1)])])}}])})],1)])])},a=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"left"},[n("span",{staticClass:"title"},[t._v("商品品牌")]),n("span",{staticClass:"ft-xs ft-grey"},[t._v("(支持拖拽排序)")])])}],d=(n("c740"),n("a434"),n("2197")),o={data:function(){return{cateParentId:"",treeList:[],expandedKeys:[],editMode:!1,editRowId:"",editValue:""}},mounted:function(){this.fetchBrand()},methods:{fetchBrand:function(){var t=this;Object(d["a"])("goods/listGoodsBrand",{},{functionName:"xunda"}).then((function(e){t.treeList=e.data||[]}))},append:function(){var t={_id:"",brand_name:""};this.treeList.push(t),this.editItem("",t)},editItem:function(t,e){var n=this;this.editMode=!0,this.editValue=e.brand_name,this.editRowId=e._id,this.$nextTick((function(){setTimeout((function(){n.$refs.editInput&&n.$refs.editInput.focus()}),300)}))},clearEdit:function(){this.editMode=!1,this.editValue="",this.editRowId=""},submitEdit:function(t,e){var n=this,i=this.editValue;if(i!==e.brand_name){var a={brand_id:e._id,brand_name:i,sort:100};Object(d["a"])("goods/saveGoodsBrand",a,{functionName:"xunda"}).then((function(t){n.fetchBrand(),n.clearEdit()}))}},cancelEdit:function(t,e){e._id||this.remove(t,e),this.clearEdit()},deleteItem:function(t,e){var n=this,i=function(){Object(d["a"])("goods/deleteGoodsBrand",{brand_id:e._id},{functionName:"xunda"}).then((function(i){n.remove(t,e)}))};this.$confirm("确定要删除该商品品牌？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){return i()}))},remove:function(t,e){var n=t.parent,i=n.data.children||n.data,a=i.findIndex((function(t){return t._id===e._id}));i.splice(a,1)},voidStop:function(){},allowDrag:function(t){return!!t.data._id},allowDrop:function(t,e,n){return"inner"!==n},nodeDropComplate:function(t,e,n,i){var a=this;Object(d["a"])("goods/dragSortBrand",{dragId:t.data._id,dropId:e.data._id,type:n},{functionName:"xunda"}).then((function(t){a.fetchBrand(),a.$message.success("商品品牌顺序调整完成")}))}}},s=o,r=(n("01f2"),n("2877")),c=Object(r["a"])(s,i,a,!1,null,null,null);e["default"]=c.exports},dff1:function(t,e,n){}}]);