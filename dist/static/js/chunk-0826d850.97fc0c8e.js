(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0826d850"],{"276d":function(t,e,a){"use strict";a("9bc3")},7875:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"aux-card"},[a("div",{staticClass:"header"},[t._m(0),a("div",{staticClass:"right"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(e){return t.$refs.goodsPropsDialog.open()}}},[t._v("添加属性")])],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLoading,expression:"dataLoading"}],staticClass:"aux-table",attrs:{data:t.dataList,border:"",fit:"",stripe:""}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center",fixed:""}}),a("el-table-column",{attrs:{align:"left",width:"220",label:"属性名",fixed:""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.name))]}}])}),a("el-table-column",{attrs:{align:"left",label:"属性值"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.values.join(" | ")))]}}])}),a("el-table-column",{attrs:{width:"150",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row._id?a("div",[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.editGoodsProps(e.row,e.$index)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.deleteGoodsProps(e.row,e.$index)}}},[t._v("删除")])],1):a("div",{staticClass:"ft-dark"},[t._v("系统预设")])]}}])})],1)],1),a("GoodsPropsDialog",{ref:"goodsPropsDialog",on:{submit:t.fetchDataList}})],1)},n=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"left"},[a("span",{staticClass:"title"},[t._v("属性设置")])])}],s=(a("99af"),a("2197")),o=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-drawer",{attrs:{visible:t.visible,"show-close":!1,"with-header":!1,"wrapper-closable":!0,direction:"rtl",size:"460px"},on:{"update:visible":function(e){t.visible=e}}},[a("div",{staticClass:"padding dflex-b border-bottom"},[a("div",{staticClass:"fs fwb"},[t._v("属性设置")]),a("div",{},[a("el-button",{attrs:{type:"default"},on:{click:t.handleCancel}},[t._v("取消")]),a("el-button",{staticClass:"margin-left-sm",attrs:{loading:t.submitLoading,type:"primary"},on:{click:t.handleSubmit}},[t._v("确认提交")])],1)]),a("div",{staticClass:"padding-lg"},[a("div",{staticClass:"padding-bottom-sm"},[a("div",{staticClass:"padding-bottom-sm"},[t._v("属性名")]),a("div",{},[a("el-input",{attrs:{placeholder:"请填写属性名",size:"normal",clearable:""},model:{value:t.formData.name,callback:function(e){t.$set(t.formData,"name",e)},expression:"formData.name"}})],1)]),a("div",{staticClass:"margin-top-sm"},[a("div",{staticClass:"padding-bottom-sm"},[t._v("属性值")]),a("el-table",{staticClass:"cu-table",attrs:{data:t.formData.values,border:"",fit:"",stripe:""}},[a("el-table-column",{attrs:{align:"center",width:"40",label:"#"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),a("el-table-column",{attrs:{align:"left",label:"属性值"},scopedSlots:t._u([{key:"default",fn:function(e){return[e.row.edit?a("el-input",{attrs:{placeholder:"请填写属性值",clearable:""},on:{blur:function(a){return t.editItemSuccess(e.row,e.$index)}},model:{value:e.row.value,callback:function(a){t.$set(e.row,"value",a)},expression:"scope.row.value"}}):a("span",[t._v(t._s(e.row.value))])]}}])}),a("el-table-column",{attrs:{width:"180",align:"center",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.editItem(e.row,e.$index)}}},[t._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return t.removeItem(e.row,e.$index)}}},[t._v("删除")])]}}])})],1),a("div",{staticClass:"margin-top-sm"},[a("el-button",{staticClass:"au-icon-add",attrs:{type:"primary",plain:""},on:{click:t.addItem}},[t._v("添加属性值")])],1)],1)])])},l=[],r=(a("d81d"),a("d3b7"),a("ddb0"),a("a434"),a("b0c0"),a("4de4"),{data:function(){return{visible:!1,formData:this.initForm(),submitLoading:!1}},methods:{open:function(t){this.formData=t?Object.assign(this.initForm(),t,{pid:t._id,values:t.values.map((function(t){return{value:t,edit:!1}}))}):this.initForm(),this.visible=!0},initForm:function(){return{pid:"",code:"",name:"",values:[{value:"",edit:!0}]}},close:function(){this.visible=!1},addItem:function(){this.formData.values.push({value:"",edit:!0})},editItem:function(t,e){t.edit=!0},editItemSuccess:function(t,e){t.value&&(t.edit=!1)},removeItem:function(t,e){var a=this;t.value?this.$confirm("确认删除该属性吗？","提示",{type:"warning"}).then((function(){a.formData.values.splice(e,1)})):this.formData.values.splice(e,1)},validatForm:function(t){if(!t.name)throw new Error("属性名称不能为空");if(0===t.values.length)throw new Error("每个属性下至少有一个属性值")},getPostData:function(){var t=this.formData;return Object.assign({},t,{values:t.values.filter((function(t){return t.value})).map((function(t){return t.value}))})},handleSubmit:function(){var t=this;try{var e=this.getPostData();this.validatForm(e),this.submitLoading=!0,Object(s["a"])("goods/saveGoodsProps",e,{functionName:"xunda"}).then((function(a){t.submitLoading=!1,t.$message.success("保存成功"),t.$emit("submit",e),t.close()}),(function(e){t.submitLoading=!1}))}catch(a){this.$message.error(a.message)}},handleCancel:function(){this.$emit("cancel"),this.close()}}}),c=r,d=(a("276d"),a("2877")),u=Object(d["a"])(c,o,l,!1,null,null,null),f=u.exports,m={components:{GoodsPropsDialog:f},data:function(){return{permission:"goods-props-query",dataLoading:!1,dataList:[],reqData:{keyword:""}}},mounted:function(){this.fetchDataList()},methods:{fetchDataList:function(){var t=this;this.dataLoading=!0,Object(s["a"])("goods/listGoodsProps",this.getReqData(),{functionName:"xunda"}).then((function(e){var a=[].concat(t.$constant.SYSTEM_PROPS).concat(e.data||[]);t.$store.dispatch("distionary/setGoodsUnits",e.data||[]),t.dataList=a,t.dataLoading=!1}))},getReqData:function(){return Object.assign({},this.reqData)},editGoodsProps:function(t,e){this.$refs.goodsPropsDialog.open(t)},deleteGoodsProps:function(t,e){var a=this;this.$confirm("确定要删除属性嘛","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(s["a"])("goods/deleteGoodsProps",{id:t._id},{functionName:"xunda"}).then((function(t){a.fetchDataList(),a.$message({type:"success",message:"删除成功!"})}))}))}}},v=m,p=Object(d["a"])(v,i,n,!1,null,null,null);e["default"]=p.exports},"9bc3":function(t,e,a){}}]);