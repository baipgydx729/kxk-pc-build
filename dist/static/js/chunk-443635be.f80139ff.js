(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-443635be"],{6381:function(e,t,a){"use strict";a("e396")},"8a59":function(e,t,a){var n=a("74e8");n("Uint8",(function(e){return function(t,a,n){return e(this,t,a,n)}}),!0)},a1b8:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("2ca0"),a("ac1f"),a("00b4"),a("ace4"),a("d3b7"),a("5cc6"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("170b"),a("b39a"),a("72f7"),a("1276"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("5319");function n(e,t,a){var r=window,s="application/octet-stream",o=a||s,i=e,l="";l=("string"===typeof i&&i.startsWith("http")||!t&&!a)&&i;var u,d,c=document.createElement("a"),f=function(e){return String(e)},h=r.Blob||r.MozBlob||r.WebKitBlob||f,m=t||"download";if(h=h.call?h.bind(r):Blob,"true"===String(this)&&(i=[i,o],o=i[0],i=i[1]),l&&l.length<2048&&(m=t||l.split("/").pop().split("?")[0],c.href=l,-1!==c.href.indexOf(l))){var p=new XMLHttpRequest;return p.open("GET",l,!0),p.responseType="blob",p.onload=function(e){n(e.target.response,m,s)},setTimeout((function(){p.send()}),0),p}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(i)){if(!(i.length>2096103.424&&h!==f))return navigator.msSaveBlob?navigator.msSaveBlob(y(i),m):g(i);i=y(i),o=i.type||s}else if(/([\x80-\xff])/.test(i)){var _=0,b=new Uint8Array(i.length),v=b.length;for(_;_<v;++_)b[_]=i.charCodeAt(_);i=new h([b],{type:o})}function y(e){var t=e.split(/[:;,]/),a=t[1],n="base64"==t[2]?atob:decodeURIComponent,r=n(t.pop()),s=r.length,o=0,i=new Uint8Array(s);for(o;o<s;++o)i[o]=r.charCodeAt(o);return new h([i],{type:a})}function g(e,t){if("download"in c)return c.href=e,c.setAttribute("download",m),c.className="download-js-link",c.innerHTML="downloading...",c.style.display="none",document.body.appendChild(c),setTimeout((function(){c.click(),document.body.removeChild(c),!0===t&&setTimeout((function(){r.URL.revokeObjectURL(c.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var a=document.createElement("iframe");document.body.appendChild(a),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,s)),a.src=e,setTimeout((function(){document.body.removeChild(a)}),333)}if(u=i instanceof h?i:new h([i],{type:o}),navigator.msSaveBlob)return navigator.msSaveBlob(u,m);if(r.URL)g(r.URL.createObjectURL(u),!0);else{if("string"===typeof u||u.constructor===f)try{return g("data:"+o+";base64,"+r.btoa(u))}catch(w){return g("data:"+o+","+encodeURIComponent(u))}d=new FileReader,d.onload=function(e){g(this.result)},d.readAsDataURL(u)}return!0}},e396:function(e,t,a){},f16d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"aux-card"},[a("div",{staticClass:"dflex-b border-bottom"},[a("div",{staticClass:"dflex"},[a("el-menu",{staticClass:"el-menu-big",attrs:{"default-active":e.tabType,mode:"horizontal"},on:{select:e.handleTabSelect}},e._l(e.tabNavs,(function(t){return a("el-menu-item",{key:t.value,attrs:{index:t.value}},[e._v(e._s(t.name))])})),1),"custom"==e.tabType?a("el-date-picker",{staticClass:"margin-left-sm",staticStyle:{width:"300px"},attrs:{type:"daterange","range-separator":" - ","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeCustomDate},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}):e._e()],1),a("div",{staticClass:"padding-right"},[a("el-select",{staticStyle:{width:"90px"},on:{change:e.fetchDataList},model:{value:e.reqData.dateType,callback:function(t){e.$set(e.reqData,"dateType",t)},expression:"reqData.dateType"}},[a("el-option",{attrs:{label:"按天",value:"day",disabled:["currYear"].includes(e.tabType)}}),a("el-option",{attrs:{label:"按月",value:"month",disabled:!["currMonth","prevMonth","currYear"].includes(e.tabType)}}),a("el-option",{attrs:{label:"按年",value:"year",disabled:!["currYear"].includes(e.tabType)}})],1),a("DownloadExcel",{staticClass:"margin-left-sm",attrs:{fields:e.excelOpts.fields,data:e.excelOpts.datas,type:e.excelOpts.type,name:e.excelOpts.filename,progress:e.excelOpts.progress,fetch:e.fetchExcelData}})],1)]),a("div",{staticClass:"padding"},[a("SalesLineChart",{ref:"salesLineChart"})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataLoading,expression:"dataLoading"}],staticClass:"aux-table",attrs:{data:e.dataList,border:"",fit:"",stripe:"","show-summary":"","summary-method":e.summaryMethod}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{width:"160",align:"center",label:"业务时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.date))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"销售额(元)",prop:"sales_total_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.sales_total_amount)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"销售笔数",prop:"sales_total_count"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.sales_total_count))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"进价成本(元)",prop:"sales_total_cost"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.sales_total_cost)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"销售毛利(元)",prop:"sales_profit_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.sales_profit_amount)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"毛利率"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.sales_profit_rate+"%"))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"退货额(元)",prop:"refund_total_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.refund_total_amount)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"退货笔数",prop:"refund_total_count"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.refund_total_count))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"销售其他费用(元)",prop:"sales_extend_fee"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.sales_extend_fee)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"退货其他费用(元)",prop:"refund_extend_fee"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.refund_extend_fee)))]}}])})],1)],1)])},r=[],s=a("c7eb"),o=a("1da1"),i=(a("d3b7"),a("159b"),a("caad"),a("d81d"),a("a9e3"),a("13d5"),a("b680"),a("b0c0"),a("cf45"));function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t={};return e.forEach((function(e){t[e.column]=e.name})),t}function u(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e.map((function(e){var a={};return t.forEach((function(t){a[t.name]=t.handler?t.handler(e,t.name):e[t.name]})),a}))}function d(e,t){return i["a"].cent2yuan(e[t])}var c=[{column:"业务时间",name:"date"},{column:"销售额(元)",name:"sales_total_amount",handler:d},{column:"销售笔数",name:"sales_total_count"},{column:"进价成本(元)",name:"sales_total_cost",handler:d},{column:"销售毛利(元)",name:"sales_profit_amount",handler:d},{column:"毛利率",name:"sales_profit_rate",handler:function(e){return e.sales_profit_rate+"%"}},{column:"退货额(元)",name:"refund_total_amount",handler:d},{column:"退货笔数",name:"refund_total_count"},{column:"销售其他费用(元)",name:"sales_extend_fee",handler:d},{column:"退货其他费用(元)",name:"refund_extend_fee",handler:d}];function f(){return l(c)}function h(e){return u(e,c)}var m=a("e177"),p=a.n(m),_=a("2197"),b=a("64f8"),v=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},y=[],g=a("313e"),w=a("ed08"),x={data:function(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted:function(){var e=this;this.$_resizeHandler=Object(w["b"])((function(){e.chart&&e.chart.resize()}),100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated:function(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated:function(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent:function(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent:function(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler:function(e){"width"===e.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent:function(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent:function(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}},D={mixins:[x],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,default:function(){}}},data:function(){return{chart:null}},watch:{chartData:{deep:!0,handler:function(e){this.setOptions(e)}}},mounted:function(){var e=this;this.$nextTick((function(){e.initChart()}))},beforeDestroy:function(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart:function(){this.chart=g["a"](this.$el,"macarons")},renderData:function(e,t){var a=this,n=this.$common.getIntervals(t.startDay,t.endDay,t.dateType),r={};e.forEach((function(e){return r[e.date]=e}));var s=[],o=[],i=[],l=[],u=[];n.forEach((function(e){s.push(e.date);var t=r[e.date];t?(o.push(Number(a.$common.cent2yuan(t.sales_total_amount))),i.push(Number(t.sales_total_count)),l.push(Number(a.$common.cent2yuan(t.sales_profit_amount))),u.push(Number(t.sales_profit_rate)+"%")):(o.push(0),i.push(0),l.push(0),u.push(0))}));var d={grid:{left:10,right:10,bottom:20,top:30,containLabel:!0},tooltip:{trigger:"axis"},legend:{data:["销售额","销售笔数","销售毛利","毛利率"]},xAxis:{data:s,boundaryGap:!1},yAxis:{},series:[{name:"销售额",type:"line",smooth:!0,data:o},{name:"销售笔数",type:"line",smooth:!0,data:i},{name:"销售毛利",type:"line",smooth:!0,data:l},{name:"毛利率",type:"line",smooth:!0,data:u}]};this.chart.setOption(d)}}},R=D,E=a("2877"),$=Object(E["a"])(R,v,y,!1,null,null,null),S=$.exports,L={components:{DownloadExcel:b["a"],SalesLineChart:S},data:function(){return{tabNavs:[{name:"今 日",value:"today"},{name:"昨 日",value:"yesterday"},{name:"本 周",value:"currWeek"},{name:"上 周",value:"prevWeek"},{name:"本 月",value:"currMonth"},{name:"上 月",value:"prevMonth"},{name:"本 年",value:"currYear"},{name:"其他日期",value:"custom"}],tabType:"today",dateRange:[],showMoreFilter:!1,dataLoading:!1,dataList:[],reqData:{dateType:"day"},excelOpts:{type:"xls",filename:"销售报表-"+(new Date).getTime()+".xls",fields:f(),datas:[],progress:0}}},mounted:function(){this.fetchDataList()},methods:{fetchDataList:function(){var e=this;this.dataLoading=!0;var t=Object.assign({},this.getReqData());Object(_["a"])("report/sales/getReportData",t,{functionName:"xundapc"}).then((function(a){e.dataLoading=!1,e.dataList=a.data||[],e.$refs.salesLineChart.renderData(e.dataList,t)}),(function(t){e.dataLoading=!1}))},getReqData:function(){var e=Object.assign({},this.reqData),t=this.getReqDateRange(),a=t.startDay,n=t.endDay;return e.startDay=a,e.endDay=n,e},getReqDateRange:function(){if("custom"!==this.tabType)return this.$common.getDateRange(this.tabType);var e=this.dateRange||[];return e.length>0?{startDay:p()(e[0]).valueOf(),endDay:p()(e[1]).valueOf()}:void 0},fetchExcelData:function(){var e=this;return Object(o["a"])(Object(s["a"])().mark((function t(){return Object(s["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",h(e.dataList));case 1:case"end":return t.stop()}}),t)})))()},summaryMethod:function(e){var t=e.columns,a=e.data,n=[];return t.forEach((function(e,t){if(0!==t)if(["sales_total_amount","sales_total_count","sales_total_cost","sales_profit_amount","sales_extend_fee","refund_total_amount","refund_total_count","refund_extend_fee"].includes(e.property)){var r=a.map((function(t){return Number(t[e.property])}));r.every((function(e){return isNaN(e)}))?n[t]="":(n[t]=r.reduce((function(e,t){return e+t}),0),["sales_total_amount","sales_total_cost","sales_profit_amount","sales_extend_fee","refund_total_amount","refund_extend_fee"].includes(e.property)&&(n[t]=(n[t]/100).toFixed(2)))}else n[t]=" ";else n[t]="合计"})),n},changeCustomDate:function(){this.fetchDataList()},handleTabSelect:function(e){this.tabType=e,this.autoSetDateType(),"custom"!==e&&this.fetchDataList()},autoSetDateType:function(){var e=this.getReqDateRange(),t=e.startDay,a=e.endDay;this.reqData.dateType=a-t>82944e5?"month":"day"}}},T=L,C=(a("6381"),Object(E["a"])(T,n,r,!1,null,null,null));t["default"]=C.exports}}]);