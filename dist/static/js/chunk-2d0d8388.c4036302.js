(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0d8388"],{"79c3":function(t,e,o){"use strict";o.r(e);var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"app-container"},[o("div",{staticClass:"aux-card"},[o("div",{staticClass:"header",staticStyle:{"padding-bottom":"0","padding-top":"6px"}},[o("div",{staticClass:"left"},[o("el-menu",{staticClass:"el-menu-big no-border",attrs:{"default-active":t.navActive,mode:"horizontal"}},t._l(t.navMenus,(function(e){return o("el-menu-item",{key:e.value,attrs:{index:e.value}},[t._v(t._s(e.name))])})),1)],1),o("div",{staticClass:"right"},[o("el-button",{attrs:{type:"default",icon:"el-icon-delete"},on:{click:t.deleteOrders}},[t._v("作废")])],1)]),o("div",{staticClass:"margin-top-sm"},[o("div",{staticClass:"dflex-b padding-lr-lg"},[o("div",{staticClass:"padding-tb"},[o("div",{staticClass:"padding-bottom-sm"},[o("span",[t._v("库存单号："+t._s(t.detail.opt_no))]),o("span",{staticClass:"margin-left-lg"},[t._v("所属仓库："+t._s(t.detail.warehouse_name))])]),o("div",{staticClass:"padding-bottom-sm"},[o("span",[t._v("变动类型："+t._s(t._f("formatTypeName")(t.detail.opt_type,t.$constant.STOCK_OPT_TYPES)))]),t.detail.rel_extend?o("span",{staticClass:"margin-left"},[t._v("-> "+t._s(t.detail.rel_extend.name))]):t._e()])]),o("div",{staticClass:"tar ft-grey"},[o("div",{staticClass:"padding-bottom-sm"},[o("span",[t._v("开单日期："+t._s(t._f("formatDate")(t.detail.opt_time)))]),o("span",{staticClass:"margin-left-lg"},[t._v("操作人："+t._s(t.detail.create_uname))])])])])]),o("orders-stock-goods-table",{ref:"stockGoodsTable",attrs:{data:t.detail.orders_goods}})],1),o("el-card",{staticClass:"aux-card margin-top",attrs:{shadow:"none","body-style":{padding:"12px"}}},[o("div",{attrs:{slot:"header"},slot:"header"},[o("span",[t._v("订单备注")])]),o("div",{staticClass:"padding-sm padding-tb-xs"},[t._v(t._s(t.detail.remark))])])],1)},s=[],n=(o("d81d"),o("b680"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLoading,expression:"dataLoading"}],ref:"goodsTable",staticClass:"aux-table no-border",attrs:{data:t.goodsList,border:"",fit:"","show-summary":"","summary-method":t.summaryMethod}},[o("el-table-column",{attrs:{type:"index",width:"60",align:"center",label:"序号"}}),o("el-table-column",{attrs:{width:"260",align:"left",label:"商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("div",[t._v(t._s(e.row.goods_name))]),e.row.goods_no?o("div",{staticClass:"fs-xs ft-grey"},[t._v("No："+t._s(e.row.goods_no))]):t._e()]}}])}),o("el-table-column",{attrs:{width:"200",align:"center",label:"规格/属性"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_spec))]}}])}),o("el-table-column",{attrs:{width:"120",align:"center",label:"单位"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_unit))]}}])}),o("el-table-column",{attrs:{width:"120",align:"center",label:"数量",prop:"goods_cnt"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_cnt))]}}])}),o("el-table-column",{attrs:{width:"140",align:"right",label:"单价(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_price))]}}])}),o("el-table-column",{attrs:{width:"140",align:"right",label:"金额小计(元)",prop:"total_money"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.total_money))]}}])}),o("el-table-column",{attrs:{align:"left",label:"备注","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.remark))]}}])})],1)}),i=[],d=(o("b0c0"),o("d3b7"),o("159b"),o("caad"),o("a9e3"),o("13d5"),{props:{data:{type:Array,default:function(){return[]}}},data:function(){return{dataLoading:!1,goodsList:[],goodsTotalCount:0,goodsOriginalMoney:0,goodsDiscountMoney:0,goodsTotalMoney:0,goodsUnitPricesMap:{}}},watch:{data:{handler:function(t,e){this.initData(t)},immediate:!0}},methods:{initGoodsUnitPrices:function(t){this.goodsUnitPricesMap[t._id]=t.unit_prices||[]},initData:function(t){var e=this;this.goodsList=t.map((function(t){return e.initItemGoods(t)}))},initItemGoods:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=t.goods_price||(t.sale_price||t.price||0)/100,a={goods_id:t.goods_id||t._id||"",goods_sku_id:t.goods_id||t.sku_id||"",goods_no:t.goods_no||t.code||"",goods_name:t.goods_name||t.name||"",goods_spec:t.goods_spec||t.spec||"",goods_cnt:t.goods_cnt||e.goods_cnt||0,goods_unit:t.goods_unit||t.unit||"",goods_ori_price:t.goods_ori_price||o||0,goods_rate:t.goods_rate||"100.00",goods_price:o,total_money:t.total_money||0,remark:t.remark||e.remark||""};return a},summaryMethod:function(t){var e=t.columns,o=t.data,a=[];return e.forEach((function(t,e){if(0!==e)if(["goods_cnt","total_money"].includes(t.property)){var s=o.map((function(e){return Number(e[t.property])}));s.every((function(t){return isNaN(t)}))?a[e]="":(a[e]=s.reduce((function(t,e){return t+e}),0),["total_money"].includes(t.property)&&(a[e]=a[e].toFixed(2)))}else a[e]=" ";else a[e]="合计"})),a}}}),r=d,l=o("2877"),c=Object(l["a"])(r,n,i,!1,null,null,null),u=c.exports,_=o("2197"),g={components:{"orders-stock-goods-table":u},data:function(){return{permission:"stock-orders-detail",navMenus:[{name:"订单详情",value:"basic"}],navActive:"basic",ordersId:"",detail:{}}},computed:{},mounted:function(){var t=this.$route.params||{},e=t.ordersId;e&&(this.ordersId=e,this.fetchDetail())},methods:{fetchDetail:function(){var t=this;Object(_["a"])("stock/getStockOrders",{ordersId:this.ordersId},{functionName:"xunda"}).then((function(e){t.initOrdersData(e.data)}),(function(e){t.$common.closePage()}))},initOrdersData:function(t){var e=Object.assign({},t),o=t.orders_goods.map((function(t){var e=Object.assign({},t);return e.total_money=(t.total_money/100).toFixed(2),e.goods_price=(t.goods_price/100).toFixed(2),e}));e.orders_goods=o,this.detail=e},deleteOrders:function(){var t=this;this.$confirm("确定要作废该单据？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(_["a"])("stock/deleteOrders",{ordersId:t.ordersId},{functionName:"xunda"}).then((function(e){t.$common.closePage(),t.$message({type:"success",message:"操作成功!"})}))}))}}},m=g,p=Object(l["a"])(m,a,s,!1,null,null,null);e["default"]=p.exports}}]);