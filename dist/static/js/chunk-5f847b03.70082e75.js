(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5f847b03"],{"362c":function(t,e,s){"use strict";s("f517")},"3e73":function(t,e,s){},"5a36":function(t,e,s){"use strict";s("fc85")},6308:function(t,e,s){},"72a1":function(t,e,s){"use strict";s("3e73")},bcc3:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLoading,expression:"dataLoading"}],ref:"goodsTable",staticClass:"aux-table no-border",attrs:{data:t.goodsList,border:"",fit:"","show-summary":"","summary-method":t.summaryMethod}},[s("el-table-column",{attrs:{type:"index",width:"60",align:"center",label:"序号"}}),s("el-table-column",{attrs:{width:"300",align:"left",label:"商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",[t._v(t._s(e.row.goods_name))]),e.row.goods_no?s("div",{staticClass:"ft-grey fs-xs"},[t._v("No："+t._s(e.row.goods_no))]):t._e()]}}])}),s("el-table-column",{attrs:{width:"160",align:"center",label:"规格属性"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_spec))]}}])}),s("el-table-column",{attrs:{width:"120",align:"center",label:"单位"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_unit))]}}])}),s("el-table-column",{attrs:{width:"120",align:"center",label:"出/入库量",prop:"goods_cnt"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_cnt))]}}])}),s("el-table-column",{attrs:{width:"140",align:"right",label:"单价(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_price))]}}])}),s("el-table-column",{attrs:{width:"140",align:"right",label:"金额小计(元)",prop:"total_money"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.total_money))]}}])}),s("el-table-column",{attrs:{align:"left",label:"备注","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.remark))]}}])})],1)],1)},o=[],i=(s("d81d"),s("b0c0"),s("d3b7"),s("159b"),s("caad"),s("a9e3"),s("13d5"),s("b680"),{props:{data:{type:Array,default:function(){return[]}}},data:function(){return{dataLoading:!1,goodsList:[],goodsTotalCount:0,goodsOriginalMoney:0,goodsDiscountMoney:0,goodsTotalMoney:0,goodsUnitPricesMap:{}}},watch:{data:{handler:function(t,e){this.goodsList=t},immediate:!0}},methods:{initGoodsUnitPrices:function(t){this.goodsUnitPricesMap[t._id]=t.unit_prices||[]},initData:function(t){var e=this;this.goodsList=t.map((function(t){return e.initItemGoods(t)}))},initItemGoods:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.goods_price||(t.sale_price||t.price||0)/100,a={goods_id:t.goods_id||t._id||"",goods_sku_id:t.goods_id||t.sku_id||"",goods_no:t.goods_no||t.code||"",goods_name:t.goods_name||t.name||"",goods_spec:t.goods_spec||t.spec||"",goods_cnt:t.goods_cnt||e.goods_cnt||0,goods_unit:t.goods_unit||t.unit||"",goods_ori_price:t.goods_ori_price||s||0,goods_rate:t.goods_rate||100,goods_price:s,total_money:t.total_money||0,remark:t.remark||e.remark||""};return a},summaryMethod:function(t){var e=t.columns,s=t.data,a=[];return e.forEach((function(t,e){if(0!==e)if(["goods_cnt","total_money"].includes(t.property)){var o=s.map((function(e){return Number(e[t.property])}));o.every((function(t){return isNaN(t)}))?a[e]="":(a[e]=o.reduce((function(t,e){return t+e}),0),["total_money"].includes(t.property)&&(a[e]=a[e].toFixed(2)))}else a[e]=" ";else a[e]="合计"})),a}}}),n=i,r=s("2877"),d=Object(r["a"])(n,a,o,!1,null,null,null);e["a"]=d.exports},c658:function(t,e,s){"use strict";s("d2b8")},d2b8:function(t,e,s){},ecee:function(t,e,s){"use strict";var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.dataLoading,expression:"dataLoading"}],ref:"goodsTable",staticClass:"aux-table no-border",attrs:{data:t.goodsList,border:"",fit:"","show-summary":"","summary-method":t.summaryMethod}},[s("el-table-column",{attrs:{type:"index",width:"60",align:"center",label:"序号"}}),s("el-table-column",{attrs:{width:"300",align:"left",label:"商品名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("div",{staticClass:"dflex"},[e.row.goods_img?s("div",{staticClass:"goods-img"},[s("img",{attrs:{src:e.row.goods_img,mode:"widthFix"}})]):t._e(),s("div",[s("div",[t._v(t._s(e.row.goods_name))]),e.row.goods_no?s("div",{staticClass:"fs-xs ft-grey"},[t._v("No："+t._s(e.row.goods_no))]):t._e()])])]}}])}),s("el-table-column",{attrs:{width:"160",align:"center",label:"规格/属性"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_spec))]}}])}),s("el-table-column",{attrs:{width:"120",align:"center",label:"单位"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_unit))]}}])}),s("el-table-column",{attrs:{width:"120",align:"center",label:"数量",prop:"goods_cnt"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_cnt))]}}])}),s("el-table-column",{attrs:{width:"140",align:"right",label:"原价(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_ori_price))]}}])}),s("el-table-column",{attrs:{width:"140",align:"right",label:"折扣(%)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_rate))]}}])}),s("el-table-column",{attrs:{width:"140",align:"right",label:"单价(元)"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.goods_price))]}}])}),s("el-table-column",{attrs:{width:"140",align:"right",label:"金额小计(元)",prop:"total_money"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.total_money))]}}])}),s("el-table-column",{attrs:{align:"left",label:"备注","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.row.remark))]}}])})],1)},o=[],i=(s("d81d"),s("b0c0"),s("d3b7"),s("159b"),s("caad"),s("a9e3"),s("13d5"),s("b680"),{props:{data:{type:Array,default:function(){return[]}}},data:function(){return{dataLoading:!1,goodsList:[],goodsTotalCount:0,goodsOriginalMoney:0,goodsDiscountMoney:0,goodsTotalMoney:0}},watch:{data:{handler:function(t,e){this.initData(t)},immediate:!0}},methods:{initData:function(t){var e=this;this.goodsList=t.map((function(t){return e.initItemGoods(t)}))},initItemGoods:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=t.goods_price||(t.sale_price||t.price||0)/100,a={goods_id:t.goods_id||t._id||"",goods_sku_id:t.goods_id||t.sku_id||"",goods_no:t.goods_no||t.code||"",goods_name:t.goods_name||t.name||"",goods_spec:t.goods_spec||t.spec||"",goods_cnt:t.goods_cnt||e.goods_cnt||0,goods_unit:t.goods_unit||t.unit||"",goods_ori_price:t.goods_ori_price||s||0,goods_rate:t.goods_rate||"100.00",goods_price:s,total_money:t.total_money||0,remark:t.remark||e.remark||""};return a},summaryMethod:function(t){var e=t.columns,s=t.data,a=[];return e.forEach((function(t,e){if(0!==e)if(["goods_cnt","total_money"].includes(t.property)){var o=s.map((function(e){return Number(e[t.property])}));o.every((function(t){return isNaN(t)}))?a[e]="":(a[e]=o.reduce((function(t,e){return t+e}),0),["total_money"].includes(t.property)&&(a[e]=a[e].toFixed(2)))}else a[e]=" ";else a[e]="合计"})),a}}}),n=i,r=(s("72a1"),s("2877")),d=Object(r["a"])(n,a,o,!1,null,null,null);e["a"]=d.exports},eedaa:function(t,e,s){"use strict";s("6308")},f517:function(t,e,s){},f9b2:function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"app-container"},[s("div",{staticClass:"aux-card"},[s("div",{staticClass:"header",staticStyle:{"padding-bottom":"0","padding-top":"6px"}},[s("div",{staticClass:"left"},[s("el-menu",{staticClass:"el-menu-big no-border",attrs:{"default-active":t.navActive,mode:"horizontal"},on:{select:t.changeTabSelect}},t._l(t.navMenus,(function(e){return s("el-menu-item",{key:e.value,attrs:{index:e.value,disabled:!t.detail.state&&["stock","sign"].includes(e.value)}},[t._v(t._s(e.name))])})),1)],1),s("div",{staticClass:"right"},[s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["sales-orders-print"],expression:"['sales-orders-print']"}],attrs:{loading:t.pdfBuildProgress>0&&t.pdfBuildProgress<100,type:"default",icon:"el-icon-printer"},on:{click:t.handlePrint}},[t._v(" "+t._s(t.pdfBuildProgress>0&&t.pdfBuildProgress<100?"正在生成("+t.pdfBuildProgress+"%)":"打印")+" ")]),s("el-button",{attrs:{type:"default",icon:"el-icon-document-copy"},on:{click:function(e){return t.$common.toPage("../orders-create?type=copyAdd&id="+t.ordersId)}}},[t._v("复制")]),t.detail.state&&1!=t.detail.state?t._e():s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["sales-orders-create"],expression:"['sales-orders-create']"}],attrs:{type:"success",icon:"el-icon-edit"},on:{click:function(e){return t.$common.toPage("../orders-create?type=edit&id="+t.ordersId)}}},[t._v("修改")]),2==t.detail.state?s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["sales-orders-outstock-cancel"],expression:"['sales-orders-outstock-cancel']"}],attrs:{type:"defaut",icon:"el-icon-edit"},on:{click:t.cancelOrders}},[t._v("撤销出库")]):t._e(),s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["sales-orders-delete"],expression:"['sales-orders-delete']"}],attrs:{type:"danger",icon:"el-icon-delete",plain:""},on:{click:t.deleteOrders}},[t._v("作废")]),t.detail.state?t._e():s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["sales-orders-approve"],expression:"['sales-orders-approve']"}],attrs:{type:"primary",icon:"el-icon-document-checked"},on:{click:t.approvedOrders}},[t._v("审核通过")]),2==t.detail.state?s("el-button",{attrs:{type:"primary",icon:"el-icon-document-checked"},on:{click:t.deliverOrders}},[t._v("发货完成")]):t._e(),3==t.detail.state?s("el-button",{attrs:{type:"primary",icon:"el-icon-document-checked"},on:{click:t.completedOrders}},[t._v("标记完成")]):t._e()],1)]),s("div",{staticClass:"margin-top-sm"},[s("div",{staticClass:"dflex-b padding-lr-lg"},[s("div",{staticClass:"padding-tb"},[s("div",{staticClass:"padding-bottom-sm"},[s("span",[t._v("销售单号："+t._s(t.detail.orders_no))]),s("span",{staticClass:"margin-left-lg"},[t._v("销售员："+t._s(t.detail.sales_name||t.detail.create_uname))]),s("span",{staticClass:"margin-left-lg"},[t._v(" 订单状态： "),s("el-tag",{attrs:{size:"small",type:9==t.detail.state?"success":"danger"}},[s("i",{class:9==t.detail.state?"el-icon-check":"el-icon-time"}),t._v(" 订单"+t._s(t._f("formatKeyValue")(t.detail.state,t.$constant.ORDERS_STATES,"value","next"))+" ")])],1)]),s("div",{staticClass:"padding-bottom-sm"},[s("span",[t._v("客户："+t._s(t.detail.receiver.name))]),t.detail.receiver.contact?s("span",{staticClass:"margin-left"},[t._v("联系人："+t._s(t.detail.receiver.contact))]):t._e(),t.detail.receiver.telephone?s("span",{staticClass:"margin-left"},[t._v("联系电话："+t._s(t.detail.receiver.telephone))]):t._e()])]),s("div",{staticClass:"tar ft-grey"},[s("div",{staticClass:"padding-bottom-sm"},[s("span",[t._v("开单日期："+t._s(t._f("formatDate")(t.detail.orders_date)))]),s("span",{staticClass:"margin-left-lg"},[t._v("制单人："+t._s(t.detail.create_uname))])])])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:"basic"==t.navActive,expression:"navActive == 'basic'"}]},[s("orders-goods-table",{ref:"goodsTable",attrs:{data:t.detail.orders_goods}}),s("div",{staticClass:"dflex-b padding padding-tb-lg"},[s("div",{staticClass:"dflex-s"}),s("div",{staticClass:"dflex-e"},[s("span",{staticClass:"padding-left-lg"},[t._v("原价金额："+t._s(t.detail.goods_original_money))]),s("span",{staticClass:"padding-left-lg"},[t._v("商品优惠："+t._s(t.detail.goods_discount_money))]),s("span",{staticClass:"padding-left-lg"},[t._v("整单优惠："+t._s(t.detail.orders_discount_money))]),s("span",{staticClass:"padding-left-lg"},[t._v("其他费用："+t._s(t.detail.orders_extend_fee))]),s("span",{staticClass:"padding-left-lg"},[t._v(" 订单金额： "),s("span",{staticClass:"ft-danger"},[t._v(t._s(t.detail.orders_total_money))])])])])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"settle"==t.navActive,expression:"navActive == 'settle'"}],staticClass:"dflex-b padding padding-tb-lg border-top"},[s("div",{staticClass:"dflex-s fs"},[s("span",{staticClass:"padding-right"},[t._v("订单金额："+t._s(t.detail.orders_total_money))]),s("span",{staticClass:"padding-right"},[t._v("已收款金额："+t._s(t.detail.settle_money))]),s("span",{staticClass:"padding-right"},[t._v(" 待收金额： "),s("span",{staticClass:"ft-danger"},[t._v(t._s(t.detail.unsettle_money))])])]),s("div",{staticClass:"dflex-e"},[s("el-button",{directives:[{name:"permission",rawName:"v-permission",value:["receipt-orders-create"],expression:"['receipt-orders-create']"}],attrs:{type:"success",icon:"el-icon-plus",disabled:t.detail.unsettle_money<=0},on:{click:t.handleAddSettle}},[t._v("添加收款")])],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"stock"==t.navActive,expression:"navActive == 'stock'"}]},[s("orders-goods-table",{ref:"goodsTable",attrs:{data:t.detail.orders_goods}}),1==t.detail.state?s("div",{staticClass:"margin-top"},[s("div",{staticClass:"header"},[t._m(0),s("div",{staticClass:"right dflex-e"},[s("AuxWarehouseSelect",{staticClass:"margin-right-sm",attrs:{label:"出库仓库"},model:{value:t.targetWarehouseId,callback:function(e){t.targetWarehouseId=e},expression:"targetWarehouseId"}}),s("el-button",{attrs:{type:"primary",icon:"el-icon-out"},on:{click:t.outStockOrders}},[t._v("立即出库")])],1)])]):t._e()],1)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"basic"==t.navActive,expression:"navActive == 'basic'"}]},[s("el-card",{staticClass:"aux-card margin-top",attrs:{shadow:"none","body-style":{padding:"12px"}}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("订单备注")])]),s("div",{staticClass:"padding-sm padding-tb-xs"},[t._v(t._s(t.detail.orders_remark))])]),s("el-card",{staticClass:"aux-card margin-top",attrs:{shadow:"none","body-style":{padding:"12px"}}},[s("div",{attrs:{slot:"header"},slot:"header"},[s("span",[t._v("内部备注")])]),s("div",{staticClass:"padding-sm padding-tb-xs"},[t._v(t._s(t.detail.create_remark))])])],1),s("div",{directives:[{name:"show",rawName:"v-show",value:"stock"==t.navActive&&t.stockOrdersList.length>0,expression:"navActive == 'stock' && stockOrdersList.length > 0"}]},[s("div",{staticClass:"aux-card margin-top"},[t._m(1),t._l(t.stockOrdersList,(function(e){return s("div",{key:e._id,staticClass:"border-bottom"},[s("div",{staticClass:"padding"},[s("span",{staticClass:"padding-right-lg"},[t._v("出库单号："+t._s(e.opt_no))]),s("span",{staticClass:"padding-right-lg"},[t._v("出库时间："+t._s(t._f("formatDate")(e.opt_time)))]),s("span",{staticClass:"padding-right-lg"},[t._v("出库仓库："+t._s(e.warehouse_name))]),s("span",{staticClass:"padding-right-lg"},[t._v("操作人员："+t._s(e.create_uname))])]),s("orders-stock-goods-table",{ref:"stockGoodsTable",refInFor:!0,attrs:{data:e.orders_goods}})],1)}))],2)]),s("div",{directives:[{name:"show",rawName:"v-show",value:"settle"==t.navActive&&t.settleOrdersList.length>0,expression:"navActive == 'settle' && settleOrdersList.length > 0"}]},[s("div",{staticClass:"aux-card margin-top"},[t._m(2),s("el-table",{staticClass:"aux-table",attrs:{data:t.settleOrdersList,border:""}},[s("el-table-column",{attrs:{width:"60",align:"center",label:"#"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(e.$index+1))]}}])}),s("el-table-column",{attrs:{label:"收款单号",prop:"receipt_no",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("router-link",{attrs:{to:"/accounting/receipt/orders-detail/"+e.row._id}},[s("span",{staticClass:"link-hover"},[t._v(t._s(e.row.receipt_no))])])]}}])}),s("el-table-column",{attrs:{label:"收款时间",prop:"receipt_date",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatDate")(e.row.receipt_date)))]}}])}),s("el-table-column",{attrs:{label:"收款金额",prop:"receipt_money",width:"200",align:"right"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("cent2yuan")(e.row.receipt_money)))]}}])}),s("el-table-column",{attrs:{label:"支付方式",prop:"receipt_type",width:"200",align:"center"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formatTypeName")(e.row.receipt_type,t.$constant.PAYMENT_TYPES)))]}}])}),s("el-table-column",{attrs:{label:"经办人员",prop:"create_uname",width:"200",align:"center"}}),s("el-table-column",{attrs:{label:"备注",prop:"remark"}})],1)],1)]),s("print-dialog",{ref:"printDialog",on:{submit:t.generatePrint}}),t.pdfBuildStart?s("print-container",{ref:"html2Pdf",attrs:{"show-layout":t.pdfOption.showLayout,"float-layout":t.pdfOption.floatLayout,"enable-download":t.pdfOption.enableDownload,"preview-modal":t.pdfOption.previewModal,"paginate-elements-by-height":t.pdfOption.paginateElementsByHeight,"pdf-content-width":t.pdfOption.pdfContentWidth,"manual-pagination":t.pdfOption.manualPagination,"html-to-pdf-options":t.compBuildPdfOption},on:{progress:function(e){t.pdfBuildProgress=e}}},[["65748600337a9f0756697a2e"==t.companyId?s("orders-print-content-cutom",{attrs:{"pager-format":t.pdfOption.pagerFormat,"orders-id":t.ordersId}}):s("orders-print-content",{attrs:{"pager-format":t.pdfOption.pagerFormat,"orders-id":t.ordersId}})]],2):t._e()],1)},o=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"left"},[s("span",{staticClass:"title"},[t._v("待出库")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header"},[s("div",{staticClass:"left"},[s("span",{staticClass:"title"},[t._v("出库记录")])]),s("div",{staticClass:"right dflex-e"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"header"},[s("div",{staticClass:"left"},[s("span",{staticClass:"title"},[t._v("收款记录")])]),s("div",{staticClass:"right dflex-e"})])}],i=s("5530"),n=(s("b680"),s("a9e3"),s("d81d"),s("ecee")),r=s("bcc3"),d=s("c3dd"),l=s("2f62"),c=new l["a"].Store({state:{pdfOption:{showLayout:!1,floatLayout:!0,enableDownload:!1,previewModal:!1,paginateElementsByHeight:1100,manualPagination:!1,filename:"电子单据",pdfQuality:4,pdfFormat:"a4",pdfOrientation:"portrait",pdfContentWidth:"800px",unit:"mm",pagerFormat:"a4"}},mutations:{},getters:{}}),_=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"vue-html2pdf"},[s("section",{staticClass:"layout-container",class:{"show-layout":t.showLayout,"unset-all":!t.floatLayout}},[s("section",{ref:"pdfContent",staticClass:"content-wrapper",style:"width: "+t.pdfContentWidth+";"},[t._t("default")],2)]),s("transition",{attrs:{name:"transition-anim"}},[t.previewModal&&t.pdfFile?s("section",{staticClass:"pdf-preview"},[s("button",{staticClass:"close",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePreview()}}},[t._v("×")]),s("iframe",{attrs:{src:t.pdfFile,width:"100%",height:"100%"}}),s("div",{staticClass:"btn-area"},[s("button",{staticClass:"close-btn",on:{click:function(e){return e.target!==e.currentTarget?null:t.closePreview()}}},[t._v("关闭")]),s("button",{staticClass:"print-btn",on:{click:function(e){return e.target!==e.currentTarget?null:t.printPdf()}}},[t._v("立即打印")])])]):t._e()])],1)},m=[],p=s("c7eb"),u=s("1da1"),v=(s("a630"),s("3ca3"),s("d3b7"),s("d67e")),f=s.n(v),g=s("add5"),h=s.n(g),b={props:{showLayout:{type:Boolean,default:!1},floatLayout:{type:Boolean,default:!1},enableDownload:{type:Boolean,default:!0},previewModal:{type:Boolean,default:!1},paginateElementsByHeight:{type:Number,default:1200},filename:{type:String,default:"".concat((new Date).getTime())},pdfQuality:{type:Number,default:4},pdfFormat:{type:String,default:"a4"},pdfOrientation:{type:String,default:"portrait"},pdfContentWidth:{type:String,default:"900px"},htmlToPdfOptions:{type:Object,default:null},manualPagination:{type:Boolean,default:!1}},data:function(){return{hasAlreadyParsed:!1,progress:0,pdfWindow:null,pdfFile:null}},watch:{progress:function(t){this.$emit("progress",t)},paginateElementsByHeight:function(){this.resetPagination()},$props:{handler:function(){this.validateProps()},deep:!0,immediate:!0}},methods:{validateProps:function(){this.manualPagination||void 0===this.paginateElementsByHeight&&console.error("Error: paginate-elements-by-height is required if manual-pagination is false")},resetPagination:function(){var t=this.$refs.pdfContent.firstChild,e=t.getElementsByClassName("html2pdf__page-break"),s=e.length-1;if(-1!==s){this.hasAlreadyParsed=!1;for(var a=s;a>=0;a--)e[a].parentNode.removeChild(e[a])}},generatePdf:function(){this.$emit("startPagination"),this.progress=0,this.paginationOfElements()},paginationOfElements:function(){if(this.progress=25,this.manualPagination)return this.progress=70,void this.downloadPdf();if(this.hasAlreadyParsed)this.progress=70;else{for(var t=this.$refs.pdfContent.firstChild,e=Array.from(t.children),s=0,a=0,o=e;a<o.length;a++){var i=o[a],n=i.classList[0],r="html2pdf__page-break"===n;if(r)s=0;else{var d=i.clientHeight,l=i.currentStyle||window.getComputedStyle(i),c=parseInt(l.marginTop)+parseInt(l.marginBottom),_=d+c;if(s+d<this.paginateElementsByHeight)s+=_;else{var m=document.createElement("div");m.classList.add("html2pdf__page-break"),t.insertBefore(m,i),s=_}}}this.progress=70,this.hasAlreadyParsed=!0}this.$emit("hasPaginated"),this.downloadPdf()},downloadPdf:function(){var t=this;return Object(u["a"])(Object(p["a"])().mark((function e(){var s,a,o,i,n,r;return Object(p["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return s=t.$refs.pdfContent,a=t.setOptions(),t.$emit("beforeDownload",{html2pdf:f.a,options:a,pdfContent:s}),o=f()().set(a).from(s),i=null,e.next=7,o.output("bloburl");case 7:if(t.pdfFile=e.sent,!t.enableDownload){e.next=12;break}return e.next=11,o.save().output("bloburl");case 11:i=e.sent;case 12:if(!i){e.next=21;break}return t.pdfBlobUrl=i,e.next=16,fetch(i);case 16:return n=e.sent,e.next=19,n.blob();case 19:r=e.sent,t.$emit("hasDownloaded",r,i);case 21:t.previewModal||t.printPdf(),t.progress=100;case 23:case"end":return e.stop()}}),e)})))()},setOptions:function(){var t={margin:0,filename:"".concat(this.filename,".pdf"),image:{type:"jpeg",quality:.98},enableLinks:!0,html2canvas:{scale:4,useCORS:!0},jsPDF:{unit:"mm",format:this.pdfFormat,orientation:this.pdfOrientation}};return void 0!==this.htmlToPdfOptions&&null!==this.htmlToPdfOptions&&(t=Object.assign(t,this.htmlToPdfOptions)),t},closePreview:function(){this.pdfFile=null},printPdf:function(){h()({printable:this.pdfFile,type:"pdf",showModal:!1})}}},y=b,C=(s("5a36"),s("2877")),x=Object(C["a"])(y,_,m,!1,null,"300d5b90",null),w=x.exports,k=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-dialog",{staticClass:"print-dialog",attrs:{title:"打印单据",visible:t.dialogVisible,width:"800px"},on:{"update:visible":function(e){t.dialogVisible=e}}},[s("el-form",{ref:"elForm",staticClass:"border-top",attrs:{"status-icon":"","label-width":"100px","label-position":"top",size:"small"}},[s("el-form-item",{attrs:{label:"通用模板"}},[s("div",{staticClass:"template-area dflex-b"},t._l(t.compDefaultPagerSizes,(function(e,a){return s("div",{key:a,staticClass:"pitem",class:{active:e.pagerFormat==t.pdfOption.pagerFormat},on:{click:function(s){return t.selectItem(e,a)}}},[s("div",{staticClass:"icon el-icon-tickets"}),s("div",[t._v(t._s(e.name))])])})),0)]),s("el-form-item",{attrs:{label:"其他模板"}},[s("div",{staticClass:"template-area dflex-s"},[t._l(t.compOtherPagerSizes,(function(e,a){return s("div",{key:a,staticClass:"pitem",class:{active:e.pagerFormat==t.pdfOption.pagerFormat},on:{click:function(s){return t.selectItem(e,a)}}},[s("div",{staticClass:"icon el-icon-tickets landscape"}),s("div",[t._v(t._s(e.name))])])})),s("div",{staticClass:"pitem margin-left-lg"},[s("el-tooltip",{attrs:{content:"定制专属打印模板，支持自定义样式，需要定制请联系管理员",placement:"top",effect:"dark"}},[s("div",[s("div",{staticClass:"icon el-icon-plus landscape"}),s("div",[t._v("模板定制")])])])],1)],2)])],1),s("div",{staticClass:"dflex-b padding-top-sm border-top"},[s("div",[s("el-checkbox",{model:{value:t.pdfOption.previewModal,callback:function(e){t.$set(t.pdfOption,"previewModal",e)},expression:"pdfOption.previewModal"}},[t._v("开启打印预览")]),s("el-checkbox",{model:{value:t.pdfOption.enableDownload,callback:function(e){t.$set(t.pdfOption,"enableDownload",e)},expression:"pdfOption.enableDownload"}},[t._v("导出PDF打印文件")])],1),s("div",[s("el-button",{attrs:{type:"default"},on:{click:t.close}},[t._v("取消")]),s("el-button",{attrs:{type:"primary"},on:{click:t.submit}},[t._v("打印")])],1)])],1)},O=[],F=(s("4de4"),[{type:"default",name:"A4",pdfFormat:"a4",size:[210,296],unit:"mm",orientation:"portrait",pagerFormat:"a4"},{type:"default",name:"241*93mm",pdfFormat:"",size:[241,93],unit:"mm",orientation:"landscape",pagerFormat:"d241-93mm"},{type:"default",name:"241*140mm",pdfFormat:"",size:[241,140],unit:"mm",orientation:"landscape",pagerFormat:"d241-140mm"},{type:"default",name:"190*130mm",pdfFormat:"",size:[190,130],unit:"mm",orientation:"landscape",pagerFormat:"d190-130mm"},{type:"default",name:"小票58mm",pdfFormat:"",size:[58,120],unit:"mm",orientation:"portrait",pagerFormat:"x58mm"},{type:"default",name:"小票80mm",pdfFormat:"",size:[80,160],unit:"mm",orientation:"portrait",pagerFormat:"x80mm"},{type:"other",name:"A4-横版",pdfFormat:"",size:[296,210],unit:"mm",orientation:"landscape",pagerFormat:"a4-l"}]),I={name:"PrintDialog",data:function(){return{dialogVisible:!1,pagerSizes:F,pdfOption:c.state.pdfOption,printType:"local"}},computed:{compDefaultPagerSizes:function(){return F.filter((function(t){return"default"===t.type}))},compOtherPagerSizes:function(){return F.filter((function(t){return"other"===t.type}))}},methods:{submit:function(){var t=this;if(this.pdfOption.pagerFormat){var e=F.filter((function(e){return e.pagerFormat===t.pdfOption.pagerFormat}))[0];this.pdfOption.unit=e.unit,this.pdfOption.pdfFormat=e.pdfFormat||e.size||"a4",this.pdfOption.orientation=e.orientation,this.pdfOption.pdfContentWidth=e.size[0]+e.unit,this.pdfOption.pagerFormat=e.pagerFormat,this.close(),this.$nextTick((function(){return t.$emit("submit")}))}},open:function(){this.dialogVisible=!0},close:function(){this.dialogVisible=!1},selectItem:function(t){this.pdfOption.pagerFormat=t.pagerFormat}}},N=I,z=(s("362c"),Object(C["a"])(N,k,O,!1,null,null,null)),S=z.exports,$=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"pdf-root",class:t.pagerFormat},[["x58mm","x80mm"].includes(t.pagerFormat)?s("section",{staticClass:"container"},[s("section",{staticClass:"pheader"},[s("div",{staticClass:"title"},[t._v(t._s(t.company.name)+t._s(t.header.title))]),s("div",{staticClass:"time"},[t._v("No."+t._s(t.detail.orders_no))])]),s("section",{staticClass:"pcontent"},[s("section",{staticClass:"bizbox"},[s("div",{staticClass:"flex1"},[s("div",[t._v("日期："+t._s(t.detail.orders_date))])]),s("div",{staticClass:"flex1"},[s("div",[t._v("客户："+t._s(t.bizInfo.name))]),t.bizInfo.address?s("div",[t._v("地址："+t._s(t.bizInfo.address))]):t._e()]),s("div",{staticClass:"flex1"},[t.bizInfo.contact?s("span",[t._v("联系人："+t._s(t.bizInfo.contact)+"、")]):t._e(),t.bizInfo.telephone?s("span",[t._v("联系电话："+t._s(t.bizInfo.telephone))]):t._e()])]),s("div",{staticClass:"line"}),s("table",{staticClass:"table"},[t._m(0),s("tbody",t._l(t.detail.orders_goods,(function(e,a){return s("tr",{key:a},[s("td",{staticClass:"tal"},[t._v(t._s(e.goods_name))]),s("td",[t._v(t._s(e.goods_cnt))]),s("td",[t._v(t._s(e.goods_price))]),s("td",[t._v(t._s(e.total_money))])])})),0)]),s("section",{staticClass:"margin-top-sm"},[s("div",[t._v("合计："+t._s(t.detail.orders_total_money))]),s("div",[t._v("备注："+t._s(t.detail.remark))])]),s("div",{staticClass:"line"}),t._m(1)]),t._m(2)]):["a4"].includes(t.pagerFormat)?s("section",{staticClass:"container"},[s("section",{staticClass:"pheader"},[s("div",{staticClass:"title"},[t._v(t._s(t.company.name)+t._s(t.header.title))])]),s("section",{staticClass:"pcontent"},[t._m(3),s("section",{staticClass:"bizbox"},[s("div",{staticClass:"dflex-b"},[s("div",{staticClass:"flex1"},[s("div",[t._v("客户名称："+t._s(t.bizInfo.name))]),s("div",[t._v("客户地址："+t._s(t.bizInfo.address))])]),s("div",{staticClass:"flex1"},[s("div",[t._v("联 系 人："+t._s(t.bizInfo.contact))]),s("div",[t._v("联系电话："+t._s(t.bizInfo.telephone))])]),s("div",{staticClass:"flex1 tar"},[s("div",[t._v("单号："+t._s(t.detail.orders_no))]),s("div",[t._v("订单日期："+t._s(t.detail.orders_date))])])])]),s("section",{staticClass:"tablebox"},[s("table",{staticClass:"table"},[s("colgroup"),t._m(4),s("tbody",[t._l(t.detail.orders_goods,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(a+1))]),s("td",[t._v(t._s(e.goods_name))]),s("td",[t._v(t._s(e.goods_spec))]),s("td",[t._v(t._s(e.goods_unit))]),s("td",[t._v(t._s(e.goods_cnt))]),s("td",[t._v(t._s(e.goods_price))]),s("td",[t._v(t._s(e.total_money))]),s("td",[t._v(t._s(e.remark))])])})),s("tr",[s("td",[t._v("合计")]),s("td",{staticClass:"tal",attrs:{colspan:"5"}},[t._v("（大写）"+t._s(t.$common.toBigMoney(t.detail.orders_total_money)))]),s("td",{staticClass:"tal",attrs:{colspan:"3"}},[t._v("（小写）¥"+t._s(t.detail.orders_total_money))])]),s("tr",[s("td",[t._v("备注")]),s("td",{staticClass:"tal",attrs:{colspan:"8"}},[t._v(t._s(t.detail.remark))])]),t._m(5)],2)])]),s("section",{staticClass:"dflex-b",staticStyle:{"margin-top":"6px"}},[s("div",[t._v("公司："+t._s(t.company.name))]),s("div",[t._v("制单人："+t._s(t.detail.create_uname))]),s("div",[t._v("发货人(盖章/签字）：")]),s("div",[t._v("收货人(盖章/签字）：")]),s("div")]),s("section",[s("div",{staticClass:"margin-top-xs"},[t._v("地址："+t._s(t.company.address||"无"))]),s("div",{staticClass:"margin-top-xs"},[t._v("电话："+t._s(t.company.telephone||"无"))])])]),s("section",{staticClass:"pfooter"})]):["a4-l"].includes(t.pagerFormat)?s("section",{staticClass:"container"},[s("section",{staticClass:"pheader"},[s("div",{staticClass:"title"},[t._v(t._s(t.company.name)+t._s(t.header.title))])]),s("section",{staticClass:"pcontent"},[t._m(6),s("section",{staticClass:"bizbox dflex-b"},[s("div",{staticClass:"dflex"},[s("div",{staticClass:"padding-right-lg"},[t._v(" 客户："+t._s(t.bizInfo.name)+" "),t.bizInfo.contact?s("span",[t._v(t._s(t.bizInfo.contact))]):t._e()]),s("div",{staticClass:"padding-right-lg"},[t._v("电话："+t._s(t.bizInfo.telephone))]),s("div",{staticClass:"padding-right-lg"},[t._v("地址："+t._s(t.bizInfo.address))])]),s("div",{staticClass:"dflex"},[s("span",{staticClass:"padding-right-lg"},[t._v("单号："+t._s(t.detail.orders_no))]),s("span",{staticClass:"margin-left"},[t._v("日期："+t._s(t.detail.orders_date))])])]),s("section",{staticClass:"tablebox"},[s("table",{staticClass:"table"},[s("colgroup"),t._m(7),s("tbody",[t._l(t.detail.orders_goods,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(a+1))]),s("td",[t._v(t._s(e.goods_name))]),s("td",[t._v(t._s(e.goods_no))]),s("td",[t._v(t._s(e.goods_spec))]),s("td",[t._v(t._s(e.goods_unit))]),s("td",[t._v(t._s(e.goods_cnt))]),s("td",[t._v(t._s(e.goods_ori_price))]),s("td",[t._v(t._s(e.goods_rote))]),s("td",[t._v(t._s(e.goods_price))]),s("td",[t._v(t._s(e.total_money))]),s("td",[t._v(t._s(e.remark))])])})),s("tr",[s("td",[t._v("合计")]),s("td",{staticClass:"tal",attrs:{colspan:"8"}},[t._v("（大写）"+t._s(t.$common.toBigMoney(t.detail.orders_total_money)))]),s("td",{staticClass:"tal",attrs:{colspan:"2"}},[t._v("（小写）¥"+t._s(t.detail.orders_total_money))])]),s("tr",[s("td",[t._v("备注")]),s("td",{staticClass:"tal",attrs:{colspan:"10"}},[t._v(t._s(t.detail.remark))])]),t._m(8)],2)])]),s("section",{staticClass:"dflex-s margin-top-sm"},[s("div",{staticClass:"padding-right-lg"},[t._v("原价金额："+t._s(t.detail.goods_original_money))]),s("div",{staticClass:"padding-right-lg"},[t._v("整单优惠："+t._s(t.detail.orders_discount_money))]),s("div",{staticClass:"padding-right-lg"},[t._v("其他费用："+t._s(t.detail.orders_extend_fee))]),s("div",{staticClass:"padding-right-lg"},[t._v("合计金额："+t._s(t.detail.orders_total_money))])]),t.detail.remark?s("section",{staticClass:"dflex-b margin-top-sm"},[s("div",[t._v("备注信息："+t._s(t.detail.remark))])]):t._e(),s("section",{staticClass:"dflex-b margin-top-sm"},[s("div",[s("div",[t._v("公司："+t._s(t.company.name))]),s("div",{staticClass:"margin-top-sm"},[t._v("地址: "+t._s(t.company.address||"无"))]),s("div",{staticClass:"margin-top-sm"},[t._v("电话: "+t._s(t.company.telephone||"无"))])]),s("div",[t._v("制单人："+t._s(t.detail.create_uname))]),s("div",[t._v("发货人(盖章/签字）：")]),s("div",[t._v("收货人(盖章/签字）：")]),s("div")])]),s("section",{staticClass:"pfooter"})]):s("section",{staticClass:"container"},[s("section",{staticClass:"pheader"},[s("div",{staticClass:"title"},[t._v(t._s(t.company.name)+t._s(t.header.title))])]),s("section",{staticClass:"pcontent"},["d241-93mm"!=t.pagerFormat?s("section",[s("div",{staticClass:"cominfo"}),s("div",{staticClass:"qrcode"})]):t._e(),s("section",{staticClass:"bizbox"},[s("div",{staticClass:"dflex-b"},[s("div",{staticClass:"flex1"},[s("div",[t._v("客户名称："+t._s(t.bizInfo.name))]),s("div",[t._v("客户地址："+t._s(t.bizInfo.address))])]),s("div",{staticClass:"flex1"},[s("div",[t._v("联 系 人："+t._s(t.bizInfo.contact))]),s("div",[t._v("联系电话："+t._s(t.bizInfo.telephone))])]),s("div",{staticClass:"flex1 tar"},[s("div",[t._v("单号："+t._s(t.detail.orders_no))]),s("div",[t._v("订单日期："+t._s(t.detail.orders_date))])])])]),s("section",{staticClass:"tablebox"},[s("table",{staticClass:"table"},[s("colgroup"),t._m(9),s("tbody",[t._l(t.detail.orders_goods,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(a+1))]),s("td",[t._v(t._s(e.goods_name))]),s("td",[t._v(t._s(e.goods_spec))]),s("td",[t._v(t._s(e.goods_unit))]),s("td",[t._v(t._s(e.goods_cnt))]),s("td",[t._v(t._s(e.goods_price))]),s("td",[t._v(t._s(e.total_money))]),s("td",[t._v(t._s(e.remark))])])})),s("tr",[s("td",[t._v("合计")]),s("td",{staticClass:"tal",attrs:{colspan:"5"}},[t._v("（大写）"+t._s(t.$common.toBigMoney(t.detail.orders_total_money)))]),s("td",{staticClass:"tal",attrs:{colspan:"3"}},[t._v("（小写）¥"+t._s(t.detail.orders_total_money))])]),s("tr",[s("td",[t._v("备注")]),s("td",{staticClass:"tal",attrs:{colspan:"7"}},[s("p",[t._v(t._s(t.detail.remark))])])]),t._m(10)],2)])]),s("section",{staticClass:"dflex-b",staticStyle:{"margin-top":"6px"}},[s("div",[s("div",[t._v("公司："+t._s(t.company.name))]),s("div",{staticClass:"addr"},[t._v("地址："+t._s(t.company.address||"无"))]),s("div",{staticClass:"tel"},[t._v("电话："+t._s(t.company.telephone||"无"))])]),s("div",[t._v("发货人(盖章/签字）：")]),s("div",[t._v("收货人(盖章/签字）：")]),s("div")])]),s("section",{staticClass:"pfooter"})])])},P=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticClass:"tal"},[t._v("品名")]),s("td",[t._v("数量")]),s("td",[t._v("单价")]),s("td",[t._v("合计")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"margin-top-sm"},[s("div",[t._v("收货人(盖章/签字）：")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"pfooter"},[s("div",{staticClass:"qrcode"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("div",{staticClass:"qrcode"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticClass:"td-no"},[t._v("序号")]),s("td",[t._v("商品名称")]),s("td",[t._v("规格属性")]),s("td",{attrs:{"min-width":"60"}},[t._v("单位")]),s("td",{attrs:{"min-width":"60"}},[t._v("数量")]),s("td",{attrs:{"min-width":"80"}},[t._v("单价")]),s("td",{attrs:{"min-width":"100"}},[t._v("合计")]),s("td",{attrs:{"min-width":"60"}},[t._v("备注")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{staticClass:"tal",attrs:{colspan:"9"}},[t._v("注意：送货单中所列货物之数量、质量及单价请及时核验，确认无误后签收，感谢您的支持与配合。")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("div",{staticClass:"cominfo"}),s("div",{staticClass:"qrcode"})])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticClass:"td-no"},[t._v("序号")]),s("td",[t._v("商品名称")]),s("td",[t._v("商品编号")]),s("td",[t._v("规格属性")]),s("td",{attrs:{"min-width":"70"}},[t._v("单位")]),s("td",{attrs:{"min-width":"70"}},[t._v("数量")]),s("td",{attrs:{"min-width":"80"}},[t._v("原价")]),s("td",{attrs:{"min-width":"80"}},[t._v("折扣(%)")]),s("td",{attrs:{"min-width":"90"}},[t._v("单价")]),s("td",{attrs:{"min-width":"100"}},[t._v("合计")]),s("td",{attrs:{"min-width":"90"}},[t._v("备注")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{staticClass:"tal padding-left",attrs:{colspan:"11"}},[t._v("注意：送货单中所列货物之数量、质量及单价请及时核验，确认无误后签收，感谢您的支持与配合。")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticClass:"td-no"},[t._v("序号")]),s("td",[t._v("商品名称")]),s("td",[t._v("规格属性")]),s("td",{attrs:{"min-width":"60"}},[t._v("单位")]),s("td",{attrs:{"min-width":"60"}},[t._v("数量")]),s("td",{attrs:{"min-width":"80"}},[t._v("单价")]),s("td",{attrs:{"min-width":"100"}},[t._v("合计")]),s("td",{attrs:{"min-width":"60"}},[t._v("备注")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{staticClass:"tal",attrs:{colspan:"8"}},[t._v("注意：送货单中所列货物之数量、质量及单价请及时核验，确认无误后签收，感谢您的支持与配合。")])])}],D=s("2f46"),E=s.n(D),B=s("2197"),T={props:{pagerFormat:{type:String,default:"a4"},ordersId:{type:String,default:""}},data:function(){return{header:{title:"销售单"},company:{logoUrl:"",name:"",address:"",telephone:""},bizInfo:{name:"",contact:"",address:"",telephone:""},detail:{orders_no:"",orders_date:"",orders_goods:[{}],remark:""}}},mounted:function(){this.fetchDetail()},methods:{fetchDetail:function(){var t=this;Object(B["a"])("orders/getOrdersView",{ordersId:this.ordersId},{functionName:"xunda"}).then((function(e){t.initOrdersData(e.data)}))},initOrdersData:function(t){var e=this.detail=Object.assign({},t);this.company=t.company,this.bizInfo=t.orders.receiver;var s=t.orders;e.orders_date=E()(s.orders_date).format("YYYY-MM-DD HH:mm:ss"),e.orders_no=s.orders_no,e.remark=s.orders_remark,e.create_uname=s.create_uname,e.goods_total_count=s.goods_total_count||s.orders_goods_count,e.goods_total_money=Number((s.goods_total_money||s.orders_total_money||0)/100).toFixed(2),e.goods_discount_money=Number((s.goods_discount_money||0)/100).toFixed(2),e.goods_original_money=Number((s.goods_original_money||s.goods_total_money||s.orders_total_money)/100).toFixed(2),e.orders_total_money=Number((s.orders_total_money||s.orders_total_money||0)/100).toFixed(2),e.orders_extend_fee=Number((s.orders_extend_fee||0)/100).toFixed(2),e.orders_discount_money=Number((s.orders_discount_money||0)/100).toFixed(2),e.settle_money=Number((s.settle_money||0)/100).toFixed(2),e.unsettle_money=(Number(e.orders_total_money)-Number(e.settle_money)).toFixed(2),e.orders_goods=s.orders_goods.map((function(t){var e=Object.assign({},t);return e.goods_ori_price=((t.goods_ori_price||e.goods_price)/100).toFixed(2),e.total_ori_money=((t.total_ori_money||e.total_money)/100).toFixed(2),e.goods_rote=(t.goods_rote||100).toFixed(2),e.total_money=(t.total_money/100).toFixed(2),e.goods_price=(t.goods_price/100).toFixed(2),e}))}}},j=T,L=(s("c658"),Object(C["a"])(j,$,P,!1,null,"d0413326",null)),M=L.exports,A=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"pdf-root",class:t.pagerFormat},[["x58mm","x80mm"].includes(t.pagerFormat)?s("section",{staticClass:"container"},[s("section",{staticClass:"pheader"},[s("div",{staticClass:"title"},[t._v(t._s(t.company.name)+t._s(t.header.title))]),s("div",{staticClass:"time"},[t._v("No."+t._s(t.detail.orders_no))])]),s("section",{staticClass:"pcontent"},[s("section",{staticClass:"bizbox"},[s("div",{staticClass:"flex1"},[s("div",[t._v("日期："+t._s(t.detail.orders_date))])]),s("div",{staticClass:"flex1"},[s("div",[t._v("客户："+t._s(t.bizInfo.name))]),t.bizInfo.address?s("div",[t._v("地址："+t._s(t.bizInfo.address))]):t._e()]),s("div",{staticClass:"flex1"},[t.bizInfo.contact?s("span",[t._v("联系人："+t._s(t.bizInfo.contact)+"、")]):t._e(),t.bizInfo.telephone?s("span",[t._v("联系电话："+t._s(t.bizInfo.telephone))]):t._e()])]),s("div",{staticClass:"line"}),s("table",{staticClass:"table"},[t._m(0),s("tbody",t._l(t.detail.orders_goods,(function(e,a){return s("tr",{key:a},[s("td",{staticClass:"tal"},[t._v(t._s(e.goods_name))]),s("td",[t._v(t._s(e.goods_cnt))]),s("td",[t._v(t._s(e.goods_price))]),s("td",[t._v(t._s(e.total_money))])])})),0)]),s("section",{staticClass:"margin-top-sm"},[s("div",[t._v("合计："+t._s(t.detail.orders_total_money))]),s("div",[t._v("备注："+t._s(t.detail.remark))])]),s("div",{staticClass:"line"}),t._m(1)]),s("section",{staticClass:"pfooter"})]):["a4"].includes(t.pagerFormat)?s("section",{staticClass:"container"},[s("section",{staticClass:"pheader"},[s("div",{staticClass:"title"},[t._v(t._s(t.company.name)+t._s(t.header.title))])]),s("section",{staticClass:"pcontent"},[s("section",{staticClass:"bizbox"},[s("div",{staticClass:"dflex-b"},[s("div",{staticClass:"flex1"},[s("div",[t._v("客户名称："+t._s(t.bizInfo.name))]),s("div",[t._v("客户地址："+t._s(t.bizInfo.address))])]),s("div",{staticClass:"flex1"},[s("div",[t._v("联 系 人："+t._s(t.bizInfo.contact))]),s("div",[t._v("联系电话："+t._s(t.bizInfo.telephone))])]),s("div",{staticClass:"flex1",staticStyle:{"text-align":"right"}},[s("div",[t._v("单号："+t._s(t.detail.orders_no))]),s("div",[t._v("订单日期："+t._s(t.detail.orders_date))])])]),t.detail.remark?s("div",{staticClass:"dflex-b"},[s("div",{staticClass:"flex1"},[s("div",[t._v("备注信息： "+t._s(t.detail.remark))])])]):t._e()]),s("section",{staticClass:"tablebox"},[s("table",{staticClass:"table"},[s("colgroup"),t._m(2),s("tbody",[t._l(t.detail.orders_goods,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(a+1))]),s("td",[t._v(t._s(e.goods_name))]),s("td",[t._v(t._s(e.goods_spec))]),s("td",[t._v(t._s(e.goods_unit))]),s("td",[t._v(t._s(e.goods_cnt))]),s("td",[t._v(t._s(e.goods_price))]),s("td",[t._v(t._s(e.total_money))])])})),s("tr",[s("td",[t._v("合计")]),s("td",{staticClass:"tal",attrs:{colspan:"5"}},[t._v("（大写）"+t._s(t.$common.toBigMoney(t.detail.orders_total_money)))]),s("td",{staticClass:"tal",attrs:{colspan:"3"}},[t._v("（小写）¥"+t._s(t.detail.orders_total_money))])]),t._m(3)],2)])]),s("section",{staticClass:"dflex-b margin-top-xs"},[s("div",[t._v("公司："+t._s(t.company.name))]),s("div",[t._v("制单人："+t._s(t.detail.create_uname))]),s("div",[t._v("发货人(盖章/签字）：")]),s("div",[t._v("收货人(盖章/签字）：")]),s("div")]),s("section",[s("div",{staticClass:"margin-top-xs"},[t._v("地址："+t._s(t.company.address||"无"))]),s("div",{staticClass:"margin-top-xs"},[t._v("电话："+t._s(t.company.telephone||"无"))])])]),s("section",{staticClass:"pfooter"})]):["a4-l"].includes(t.pagerFormat)?s("section",{staticClass:"container"},[s("section",{staticClass:"pheader"},[s("div",{staticClass:"title"},[t._v(t._s(t.company.name)+t._s(t.header.title))])]),s("section",{staticClass:"pcontent"},[s("section"),s("section",{staticClass:"bizbox dflex-b"},[s("div",{staticClass:"dflex"},[s("div",{staticClass:"padding-right-lg"},[t._v("客户名称："+t._s(t.bizInfo.name))]),s("div",{staticClass:"padding-right-lg"},[t._v("联 系 人："+t._s(t.bizInfo.contact))]),s("div",{staticClass:"padding-right-lg"},[t._v("联系电话："+t._s(t.bizInfo.telephone))]),s("div",{staticClass:"padding-right-lg"},[t._v("联系地址："+t._s(t.bizInfo.address))])]),s("div",{staticClass:"dflex"},[s("div",{staticClass:"padding-right-lg"},[t._v("订单单号："+t._s(t.detail.orders_no))]),s("div",[t._v("订单日期："+t._s(t.detail.orders_date))])])]),t.detail.remark?s("section",{staticClass:"dflex-b margin-top-sm"},[s("div",[t._v("备注信息："+t._s(t.detail.remark))])]):t._e(),s("section",{staticClass:"tablebox"},[s("table",{staticClass:"table"},[s("colgroup"),t._m(4),s("tbody",[t._l(t.detail.orders_goods,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(a+1))]),s("td",[t._v(t._s(e.goods_name))]),s("td",[t._v(t._s(e.goods_no))]),s("td",[t._v(t._s(e.goods_spec))]),s("td",[t._v(t._s(e.goods_unit))]),s("td",[t._v(t._s(e.goods_cnt))]),s("td",[t._v(t._s(e.goods_ori_price))]),s("td",[t._v(t._s(e.goods_rote))]),s("td",[t._v(t._s(e.goods_price))]),s("td",[t._v(t._s(e.total_money))])])})),s("tr",[s("td",[t._v("合计")]),s("td",{staticClass:"tal",attrs:{colspan:"8"}},[t._v("（大写）"+t._s(t.$common.toBigMoney(t.detail.orders_total_money)))]),s("td",{staticClass:"tal",attrs:{colspan:"2"}},[t._v("（小写）¥"+t._s(t.detail.orders_total_money))])])],2)])]),s("section",{staticClass:"dflex-s margin-top-sm"},[s("div",{staticClass:"padding-right-lg"},[t._v("原价金额："+t._s(t.detail.goods_original_money))]),s("div",{staticClass:"padding-right-lg"},[t._v("整单优惠："+t._s(t.detail.orders_discount_money))]),s("div",{staticClass:"padding-right-lg"},[t._v("其他费用："+t._s(t.detail.orders_extend_fee))]),s("div",{staticClass:"padding-right-lg"},[t._v("合计金额："+t._s(t.detail.orders_total_money))])]),s("section",{staticClass:"dflex-b margin-top-sm"},[s("div",[t._v("公司："+t._s(t.company.name))]),s("div",[t._v("制单人："+t._s(t.detail.create_uname))]),s("div",[t._v("发货人(盖章/签字）：")]),s("div",[t._v("收货人(盖章/签字）：")]),s("div")]),s("section",{staticClass:"margin-top-xs"},[s("div",{staticClass:"margin-top-xs"},[t._v("地址："+t._s(t.company.address||"无"))]),s("div",{staticClass:"margin-top-xs"},[t._v("电话："+t._s(t.company.telephone||"无"))])])]),s("section",{staticClass:"pfooter"})]):s("section",{staticClass:"container"},[s("section",{staticClass:"pheader"},[s("div",{staticClass:"title"},[t._v(t._s(t.company.name)+t._s(t.header.title))])]),s("section",{staticClass:"pcontent"},["d241-93mm"!=t.pagerFormat?s("section"):t._e(),s("section",{staticClass:"bizbox"},[s("div",{staticClass:"dflex-b"},[s("div",{staticClass:"flex1"},[s("div",[t._v("客户名称："+t._s(t.bizInfo.name))]),s("div",[t._v("客户地址："+t._s(t.bizInfo.address))])]),s("div",{staticClass:"flex1"},[s("div",[t._v("联 系 人："+t._s(t.bizInfo.contact))]),s("div",[t._v("联系电话："+t._s(t.bizInfo.telephone))])]),s("div",{staticClass:"flex1 tar"},[s("div",[t._v("单号："+t._s(t.detail.orders_no))]),s("div",[t._v("订单日期："+t._s(t.detail.orders_date))])])]),t.detail.remark?s("div",{staticClass:"dflex-b"},[s("div",{staticClass:"flex1"},[s("div",[t._v("备注信息： "+t._s(t.detail.remark))])])]):t._e()]),s("section",{staticClass:"tablebox"},[s("table",{staticClass:"table"},[s("colgroup"),t._m(5),s("tbody",[t._l(t.detail.orders_goods,(function(e,a){return s("tr",{key:a},[s("td",[t._v(t._s(a+1))]),s("td",[t._v(t._s(e.goods_name))]),s("td",[t._v(t._s(e.goods_spec))]),s("td",[t._v(t._s(e.goods_unit))]),s("td",[t._v(t._s(e.goods_cnt))]),s("td",[t._v(t._s(e.goods_price))]),s("td",[t._v(t._s(e.total_money))]),s("td",[t._v(t._s(e.remark))])])})),s("tr",[s("td",[t._v("合计")]),s("td",{staticClass:"tal",attrs:{colspan:"5"}},[t._v("（大写）"+t._s(t.$common.toBigMoney(t.detail.orders_total_money)))]),s("td",{staticClass:"tal",attrs:{colspan:"3"}},[t._v("（小写）¥"+t._s(t.detail.orders_total_money))])]),t._m(6)],2)])]),s("section",{staticClass:"margin-top-xs"},[s("div",{staticClass:"dflex-b"},[s("div",[t._v("公司："+t._s(t.company.name))]),s("div",[t._v("发货人(盖章/签字）：")]),s("div",[t._v("收货人(盖章/签字）：")]),s("div")]),s("div",{staticClass:"margin-top-xs"},[t._v("地址："+t._s(t.company.address||"无"))]),s("div",{staticClass:"margin-top-xs"},[t._v("电话："+t._s(t.company.telephone||"无"))])])]),s("section",{staticClass:"pfooter"})])])},W=[function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticClass:"tal"},[t._v("品名")]),s("td",[t._v("数量")]),s("td",[t._v("单价")]),s("td",[t._v("合计")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"margin-top-sm"},[s("div",[t._v("收货人(盖章/签字）：")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticClass:"td-no"},[t._v("序号")]),s("td",[t._v("商品名称")]),s("td",[t._v("规格型号")]),s("td",{attrs:{width:"80"}},[t._v("单位")]),s("td",{attrs:{width:"80"}},[t._v("数量")]),s("td",{attrs:{width:"100"}},[t._v("单价")]),s("td",{attrs:{width:"140"}},[t._v("金额")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{staticClass:"tal",attrs:{colspan:"8"}},[t._v("注意：送货单中所列货物之数量、质量及单价请及时核验，确认无误后签收，感谢您的支持与配合。")])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticClass:"td-no"},[t._v("序号")]),s("td",[t._v("商品名称")]),s("td",[t._v("商品编号")]),s("td",[t._v("规格型号")]),s("td",{attrs:{width:"80"}},[t._v("单位")]),s("td",{attrs:{width:"80"}},[t._v("数量")]),s("td",{attrs:{width:"80"}},[t._v("原价")]),s("td",{attrs:{width:"80"}},[t._v("折扣(%)")]),s("td",{attrs:{width:"80"}},[t._v("单价")]),s("td",{attrs:{width:"130"}},[t._v("合计")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("thead",[s("tr",[s("td",{staticClass:"td-no"},[t._v("序号")]),s("td",[t._v("商品名称")]),s("td",[t._v("规格型号")]),s("td",{attrs:{width:"60"}},[t._v("单位")]),s("td",{attrs:{width:"60"}},[t._v("数量")]),s("td",{attrs:{width:"60"}},[t._v("单价")]),s("td",{attrs:{width:"100"}},[t._v("合计")]),s("td",[t._v("备注")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("tr",[s("td",{staticClass:"tal",attrs:{colspan:"8"}},[t._v("注意：送货单中所列货物之数量、质量及单价请及时核验，确认无误后签收，感谢您的支持与配合。")])])}],H={props:{pagerFormat:{type:String,default:"a4"},ordersId:{type:String,default:""}},data:function(){return{header:{title:"销售单"},company:{logoUrl:"https://i.imgur.com/wKblc.jpg",name:"武汉硒鼓勘查地有限公司",address:"湖北省阳新县大王中庄店",telephone:"17801481233"},bizInfo:{name:"大王中庄店",contact:"柯盼",address:"湖北省阳新县大王中庄店",telephone:"17801481233"},detail:{orders_no:"XSD20231027213317597",orders_date:"2023-12-12 12:34:34",orders_goods:[{}],remark:""}}},mounted:function(){this.fetchDetail()},methods:{fetchDetail:function(){var t=this;Object(B["a"])("orders/getOrdersView",{ordersId:this.ordersId},{functionName:"xunda"}).then((function(e){t.initOrdersData(e.data)}))},initOrdersData:function(t){var e=this.detail=Object.assign({},t);this.company=t.company,this.bizInfo=t.orders.receiver;var s=t.orders;e.orders_date=E()(s.orders_date).format("YYYY-MM-DD HH:mm:ss"),e.orders_no=s.orders_no,e.remark=s.orders_remark,e.create_uname=s.create_uname,e.goods_total_count=s.goods_total_count||s.orders_goods_count,e.goods_total_money=Number((s.goods_total_money||s.orders_total_money||0)/100).toFixed(2),e.goods_discount_money=Number((s.goods_discount_money||0)/100).toFixed(2),e.goods_original_money=Number((s.goods_original_money||s.goods_total_money||s.orders_total_money)/100).toFixed(2),e.orders_total_money=Number((s.orders_total_money||s.orders_total_money||0)/100).toFixed(2),e.orders_extend_fee=Number((s.orders_extend_fee||0)/100).toFixed(2),e.orders_discount_money=Number((s.orders_discount_money||0)/100).toFixed(2),e.settle_money=Number((s.settle_money||0)/100).toFixed(2),e.unsettle_money=(Number(e.orders_total_money)-Number(e.settle_money)).toFixed(2),e.orders_goods=s.orders_goods.map((function(t){var e=Object.assign({},t);return e.goods_ori_price=((t.goods_ori_price||e.goods_price)/100).toFixed(2),e.total_ori_money=((t.total_ori_money||e.total_money)/100).toFixed(2),e.goods_rote=(t.goods_rote||100).toFixed(2),e.total_money=(t.total_money/100).toFixed(2),e.goods_price=(t.goods_price/100).toFixed(2),e}))}}},Y=H,V=(s("eedaa"),Object(C["a"])(Y,A,W,!1,null,"cfa290b0",null)),q=V.exports,G={components:{"orders-goods-table":n["a"],"orders-stock-goods-table":r["a"],AuxWarehouseSelect:d["a"],"print-container":w,"print-dialog":S,"orders-print-content":M,"orders-print-content-cutom":q},data:function(){return{permission:"sales-orders-detail",navMenus:[{name:"订单详情",value:"basic"},{name:"出库/发货",value:"stock"},{name:"结算收款",value:"settle"}],navActive:"basic",ordersId:"",detail:{receiver_id:"",receiver:{_id:"",name:"客户",contact:"",telephone:"",address:"请选择销售的客户",sale_grade:0},orders_date:(new Date).getTime(),orders_no:"",orders_remark:"",create_remark:"",create_uname:"",state:"",orders_goods:[],goods_total_count:0,goods_original_money:0,goods_discount_money:0,goods_total_money:0,orders_discount_money:0,orders_extend_fee:0,orders_total_money:0,settle_state:"",settleMoney:0,unsettleMoney:0},ordersIdentifys:[],wareHouseList:[],stockChecked:!1,targetWarehouseId:"",stockOrdersList:[],settleOrdersList:[],pdfBuildStart:!1,pdfBuildProgress:0,pdfOption:c.state.pdfOption}},computed:Object(i["a"])(Object(i["a"])({},Object(l["b"])(["companyId"])),{},{compBuildPdfOption:function(){return{filename:"销售单-"+(new Date).getTime()+".pdf",jsPDF:{unit:this.pdfOption.unit||"mm",format:this.pdfOption.pdfFormat,orientation:this.pdfOption.orientation}}}}),mounted:function(){var t=this.$route.params||{},e=t.ordersId;e&&(this.ordersId=e,this.fetchDetail())},methods:{changeTabSelect:function(t){this.navActive=t,"stock"===this.navActive&&this.fetchStockDetail(),"settle"===this.navActive&&this.fetchSettleDetail()},fetchDetail:function(){var t=this;Object(B["a"])("orders/getOrders",{ordersId:this.ordersId},{functionName:"xunda"}).then((function(e){t.initOrdersData(e.data)}))},initOrdersData:function(t){var e=this.detail=Object.assign({},t);e.receiver_id=t.receiver_id,e.receiver=t.receiver,e.orders_date=t.orders_date,e.orders_no=t.orders_no,e.orders_remark=t.orders_remark,e.create_remark=t.create_remark,e.create_uname=t.create_uname,e.goods_total_count=t.goods_total_count||t.orders_goods_count,e.goods_total_money=Number((t.goods_total_money||t.orders_total_money||0)/100).toFixed(2),e.goods_discount_money=Number((t.goods_discount_money||0)/100).toFixed(2),e.goods_original_money=Number((t.goods_original_money||t.goods_total_money||t.orders_total_money)/100).toFixed(2),e.orders_total_money=Number((t.orders_total_money||t.orders_total_money||0)/100).toFixed(2),e.orders_extend_fee=Number((t.orders_extend_fee||0)/100).toFixed(2),e.orders_discount_money=Number((t.orders_discount_money||0)/100).toFixed(2),e.settle_money=Number((t.settle_money||0)/100).toFixed(2),e.unsettle_money=(Number(e.orders_total_money)-Number(e.settle_money)).toFixed(2),e.orders_goods=t.orders_goods.map((function(t){var e=Object.assign({},t);return e.goods_ori_price=((t.goods_ori_price||e.goods_price)/100).toFixed(2),e.total_ori_money=((t.total_ori_money||e.total_money)/100).toFixed(2),e.goods_rate=Number(t.goods_rate||100).toFixed(2),e.total_money=(t.total_money/100).toFixed(2),e.goods_price=(t.goods_price/100).toFixed(2),e}))},fetchStockDetail:function(){var t=this;if(!(this.stockOrdersList.length>0)){var e=this.detail.stock_ids||(this.detail.rel_stock_id?[this.detail.rel_stock_id]:[]);0!==e.length&&Object(B["a"])("stock/listStockStream",{stockIds:e},{functionName:"xunda"}).then((function(e){t.stockOrdersList=(e.data||[]).map((function(t){var e=t.orders_goods.map((function(t){var e=Object.assign({},t);return e.total_money=(t.total_money/100).toFixed(2),e.goods_price=(t.goods_price/100).toFixed(2),e}));return t.orders_goods=e,t}))}))}},fetchSettleDetail:function(){var t=this;if(!(this.settleOrdersList.length>0)){var e=this.detail.settle_orders_ids||[];if(0!==e.length){var s=Object.assign({pageSize:10,pageNo:1},{receiptId:e});Object(B["a"])("settle/listReceiptOrders",s,{functionName:"xunda"}).then((function(e){t.settleOrdersList=e.data||[]}))}}},approvedOrders:function(){var t=this;this.$confirm("确定要通过该订单？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){Object(B["a"])("orders/approvedOrders",{ordersId:t.ordersId},{functionName:"xunda"}).then((function(e){t.$message({type:"success",message:"操作成功!"}),t.fetchDetail()}))}))},deleteOrders:function(){var t=this;this.$confirm("确定要删除该订单？","告警提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(B["a"])("orders/deleteOrders",{ordersId:t.ordersId},{functionName:"xunda"}).then((function(e){t.$message({type:"success",message:"删除成功!"}),setTimeout((function(){return t.$common.closePage()}),500)}))}))},outStockOrders:function(){var t=this;this.$confirm("确定要出库嘛？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){Object(B["a"])("orders/outStock",{ordersId:t.ordersId,warehouseId:t.targetWarehouseId},{functionName:"xunda"}).then((function(e){t.$message({type:"success",message:"操作成功!"}),t.fetchDetail(),setTimeout((function(){return t.fetchStockDetail()}),500)}))}))},cancelOrders:function(){var t=this;this.$confirm("确定要撤销入库嘛？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"success"}).then((function(){Object(B["a"])("orders/cancelOrders",{ordersId:t.ordersId},{functionName:"xunda"}).then((function(e){t.$message({type:"success",message:"操作成功!"}),t.fetchDetail()}))}))},deliverOrders:function(){var t=this;Object(B["a"])("orders/deliverOrders",{ordersId:this.ordersId},{functionName:"xunda"}).then((function(e){t.$message({type:"success",message:"操作成功!"}),t.fetchDetail()}))},completedOrders:function(){var t=this;Object(B["a"])("orders/completeOrders",{ordersId:this.ordersId},{functionName:"xunda"}).then((function(e){t.$message({type:"success",message:"操作成功!"}),t.fetchDetail()}))},handleAddSettle:function(){var t={ordersType:"sales",ordersId:this.ordersId};this.$router.push({path:"/accounting/receipt/orders-create",query:t})},handlePrint:function(){this.pdfBuildStart=!0,this.$refs.printDialog.open()},generatePrint:function(){var t=this;this.pdfBuildProgress=10,setTimeout((function(){return t.$refs.html2Pdf.generatePdf()}),300)}}},U=G,R=Object(C["a"])(U,a,o,!1,null,null,null);e["default"]=R.exports},fc85:function(t,e,s){}}]);