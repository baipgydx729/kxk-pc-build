(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4a3f4abe"],{6381:function(e,t,a){"use strict";a("e396")},a1b8:function(e,t,a){"use strict";a.d(t,"a",(function(){return n}));a("3c5d");function n(e,t,a){var s=window,r="application/octet-stream",o=a||r,i=e,l="";l=("string"===typeof i&&i.startsWith("http")||!t&&!a)&&i;var d,u,c=document.createElement("a"),h=function(e){return String(e)},m=s.Blob||s.MozBlob||s.WebKitBlob||h,p=t||"download";if(m=m.call?m.bind(s):Blob,"true"===String(this)&&(i=[i,o],o=i[0],i=i[1]),l&&l.length<2048&&(p=t||l.split("/").pop().split("?")[0],c.href=l,-1!==c.href.indexOf(l))){var f=new XMLHttpRequest;return f.open("GET",l,!0),f.responseType="blob",f.onload=function(e){n(e.target.response,p,r)},setTimeout((function(){f.send()}),0),f}if(/^data:([\w+-]+\/[\w+.-]+)?[,;]/.test(i)){if(!(i.length>2096103.424&&m!==h))return navigator.msSaveBlob?navigator.msSaveBlob(g(i),p):v(i);i=g(i),o=i.type||r}else if(/([\x80-\xff])/.test(i)){var _=0,b=new Uint8Array(i.length),y=b.length;for(_;_<y;++_)b[_]=i.charCodeAt(_);i=new m([b],{type:o})}function g(e){var t=e.split(/[:;,]/),a=t[1],n="base64"==t[2]?atob:decodeURIComponent,s=n(t.pop()),r=s.length,o=0,i=new Uint8Array(r);for(o;o<r;++o)i[o]=s.charCodeAt(o);return new m([i],{type:a})}function v(e,t){if("download"in c)return c.href=e,c.setAttribute("download",p),c.className="download-js-link",c.innerHTML="downloading...",c.style.display="none",document.body.appendChild(c),setTimeout((function(){c.click(),document.body.removeChild(c),!0===t&&setTimeout((function(){s.URL.revokeObjectURL(c.href)}),250)}),66),!0;if(/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.*Safari\//.test(navigator.userAgent))return/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,r)),window.open(e)||confirm("Displaying New Document\n\nUse Save As... to download, then click back to return to this page.")&&(location.href=e),!0;var a=document.createElement("iframe");document.body.appendChild(a),!t&&/^data:/.test(e)&&(e="data:"+e.replace(/^data:([\w\/\-\+]+)/,r)),a.src=e,setTimeout((function(){document.body.removeChild(a)}),333)}if(d=i instanceof m?i:new m([i],{type:o}),navigator.msSaveBlob)return navigator.msSaveBlob(d,p);if(s.URL)v(s.URL.createObjectURL(d),!0);else{if("string"===typeof d||d.constructor===h)try{return v("data:"+o+";base64,"+s.btoa(d))}catch(w){return v("data:"+o+","+encodeURIComponent(d))}u=new FileReader,u.onload=function(e){v(this.result)},u.readAsDataURL(d)}return!0}},e396:function(e,t,a){},f16d:function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"aux-card"},[a("div",{staticClass:"dflex-b border-bottom"},[a("div",{staticClass:"dflex"},[a("el-menu",{staticClass:"el-menu-big",attrs:{"default-active":e.tabType,mode:"horizontal"},on:{select:e.handleTabSelect}},e._l(e.tabNavs,(function(t){return a("el-menu-item",{key:t.value,attrs:{index:t.value}},[e._v(e._s(t.name))])})),1),"custom"==e.tabType?a("el-date-picker",{staticClass:"margin-left-sm",staticStyle:{width:"300px"},attrs:{type:"daterange","range-separator":" - ","start-placeholder":"开始日期","end-placeholder":"结束日期"},on:{change:e.changeCustomDate},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}):e._e()],1),a("div",{staticClass:"padding-right"},[a("el-select",{staticStyle:{width:"90px"},on:{change:e.fetchDataList},model:{value:e.reqData.dateType,callback:function(t){e.$set(e.reqData,"dateType",t)},expression:"reqData.dateType"}},[a("el-option",{attrs:{label:"按天",value:"day",disabled:["currYear"].includes(e.tabType)}}),a("el-option",{attrs:{label:"按月",value:"month",disabled:!["currMonth","prevMonth","currYear"].includes(e.tabType)}}),a("el-option",{attrs:{label:"按年",value:"year",disabled:!["currYear"].includes(e.tabType)}})],1),a("DownloadExcel",{staticClass:"margin-left-sm",attrs:{fields:e.excelOpts.fields,data:e.excelOpts.datas,type:e.excelOpts.type,name:e.excelOpts.filename,progress:e.excelOpts.progress,fetch:e.fetchExcelData}})],1)]),a("div",{staticClass:"padding"},[a("SalesLineChart",{ref:"salesLineChart"})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataLoading,expression:"dataLoading"}],staticClass:"aux-table",attrs:{data:e.dataList,border:"",fit:"",stripe:"","show-summary":"","summary-method":e.summaryMethod}},[a("el-table-column",{attrs:{type:"index",width:"50",align:"center",label:"序号"}}),a("el-table-column",{attrs:{width:"160",align:"center",label:"业务时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.date))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"销售额(元)",prop:"sales_total_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.sales_total_amount)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"销售笔数",prop:"sales_total_count"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.sales_total_count))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"进价成本(元)",prop:"sales_total_cost"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.sales_total_cost)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"销售毛利(元)",prop:"sales_profit_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.sales_profit_amount)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"毛利率"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.sales_profit_rate+"%"))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"退货额(元)",prop:"refund_total_amount"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.refund_total_amount)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"退货笔数",prop:"refund_total_count"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.refund_total_count))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"销售其他费用(元)",prop:"sales_extend_fee"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.sales_extend_fee)))]}}])}),a("el-table-column",{attrs:{width:"160",align:"right",label:"退货其他费用(元)",prop:"refund_extend_fee"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(e._f("cent2yuan")(t.row.refund_extend_fee)))]}}])})],1)],1)])},s=[],r=(a("13d5"),a("cf45"));function o(e=[]){const t={};return e.forEach(e=>{t[e.column]=e.name}),t}function i(e,t=[]){return e.map(e=>{const a={};return t.forEach(t=>{a[t.name]=t.handler?t.handler(e,t.name):e[t.name]}),a})}function l(e,t){return r["a"].cent2yuan(e[t])}const d=[{column:"业务时间",name:"date"},{column:"销售额(元)",name:"sales_total_amount",handler:l},{column:"销售笔数",name:"sales_total_count"},{column:"进价成本(元)",name:"sales_total_cost",handler:l},{column:"销售毛利(元)",name:"sales_profit_amount",handler:l},{column:"毛利率",name:"sales_profit_rate",handler:e=>e.sales_profit_rate+"%"},{column:"退货额(元)",name:"refund_total_amount",handler:l},{column:"退货笔数",name:"refund_total_count"},{column:"销售其他费用(元)",name:"sales_extend_fee",handler:l},{column:"退货其他费用(元)",name:"refund_extend_fee",handler:l}];function u(){return o(d)}function c(e){return i(e,d)}var h=a("e177"),m=a.n(h),p=a("2197"),f=a("64f8"),_=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:e.className,style:{height:e.height,width:e.width}})},b=[],y=a("313e"),g=a("ed08"),v={data(){return{$_sidebarElm:null,$_resizeHandler:null}},mounted(){this.$_resizeHandler=Object(g["b"])(()=>{this.chart&&this.chart.resize()},100),this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},beforeDestroy(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},activated(){this.$_initResizeEvent(),this.$_initSidebarResizeEvent()},deactivated(){this.$_destroyResizeEvent(),this.$_destroySidebarResizeEvent()},methods:{$_initResizeEvent(){window.addEventListener("resize",this.$_resizeHandler)},$_destroyResizeEvent(){window.removeEventListener("resize",this.$_resizeHandler)},$_sidebarResizeHandler(e){"width"===e.propertyName&&this.$_resizeHandler()},$_initSidebarResizeEvent(){this.$_sidebarElm=document.getElementsByClassName("sidebar-container")[0],this.$_sidebarElm&&this.$_sidebarElm.addEventListener("transitionend",this.$_sidebarResizeHandler)},$_destroySidebarResizeEvent(){this.$_sidebarElm&&this.$_sidebarElm.removeEventListener("transitionend",this.$_sidebarResizeHandler)}}},w={mixins:[v],props:{className:{type:String,default:"chart"},width:{type:String,default:"100%"},height:{type:String,default:"350px"},autoResize:{type:Boolean,default:!0},chartData:{type:Object,default:()=>{}}},data(){return{chart:null}},watch:{chartData:{deep:!0,handler(e){this.setOptions(e)}}},mounted(){this.$nextTick(()=>{this.initChart()})},beforeDestroy(){this.chart&&(this.chart.dispose(),this.chart=null)},methods:{initChart(){this.chart=y["a"](this.$el,"macarons")},renderData(e,t){const a=this.$common.getIntervals(t.startDay,t.endDay,t.dateType),n={};e.forEach(e=>n[e.date]=e);const s=[],r=[],o=[],i=[],l=[];a.forEach(e=>{s.push(e.date);const t=n[e.date];t?(r.push(Number(this.$common.cent2yuan(t.sales_total_amount))),o.push(Number(t.sales_total_count)),i.push(Number(this.$common.cent2yuan(t.sales_profit_amount))),l.push(Number(t.sales_profit_rate)+"%")):(r.push(0),o.push(0),i.push(0),l.push(0))});const d={grid:{left:10,right:10,bottom:20,top:30,containLabel:!0},tooltip:{trigger:"axis"},legend:{data:["销售额","销售笔数","销售毛利","毛利率"]},xAxis:{data:s,boundaryGap:!1},yAxis:{},series:[{name:"销售额",type:"line",smooth:!0,data:r},{name:"销售笔数",type:"line",smooth:!0,data:o},{name:"销售毛利",type:"line",smooth:!0,data:i},{name:"毛利率",type:"line",smooth:!0,data:l}]};this.chart.setOption(d)}}},x=w,D=a("2877"),R=Object(D["a"])(x,_,b,!1,null,null,null),E=R.exports,$={components:{DownloadExcel:f["a"],SalesLineChart:E},data(){return{tabNavs:[{name:"今 日",value:"today"},{name:"昨 日",value:"yesterday"},{name:"本 周",value:"currWeek"},{name:"上 周",value:"prevWeek"},{name:"本 月",value:"currMonth"},{name:"上 月",value:"prevMonth"},{name:"本 年",value:"currYear"},{name:"其他日期",value:"custom"}],tabType:"today",dateRange:[],showMoreFilter:!1,dataLoading:!1,dataList:[],reqData:{dateType:"day"},excelOpts:{type:"xls",filename:"销售报表-"+(new Date).getTime()+".xls",fields:u(),datas:[],progress:0}}},mounted(){this.fetchDataList()},methods:{fetchDataList(){this.dataLoading=!0;const e=Object.assign({},this.getReqData());Object(p["a"])("report/sales/getReportData",e,{functionName:"xundapc"}).then(t=>{this.dataLoading=!1,this.dataList=t.data||[],this.$refs.salesLineChart.renderData(this.dataList,e)},e=>{this.dataLoading=!1})},getReqData(){const e=Object.assign({},this.reqData),{startDay:t,endDay:a}=this.getReqDateRange();return e.startDay=t,e.endDay=a,e},getReqDateRange(){if("custom"!==this.tabType)return this.$common.getDateRange(this.tabType);{const e=this.dateRange||[];if(e.length>0)return{startDay:m()(e[0]).valueOf(),endDay:m()(e[1]).valueOf()}}},async fetchExcelData(){return c(this.dataList)},summaryMethod({columns:e,data:t}){const a=[];return e.forEach((e,n)=>{if(0===n)return void(a[n]="合计");if(!["sales_total_amount","sales_total_count","sales_total_cost","sales_profit_amount","sales_extend_fee","refund_total_amount","refund_total_count","refund_extend_fee"].includes(e.property))return void(a[n]=" ");const s=t.map(t=>Number(t[e.property]));s.every(e=>isNaN(e))?a[n]="":(a[n]=s.reduce((e,t)=>e+t,0),["sales_total_amount","sales_total_cost","sales_profit_amount","sales_extend_fee","refund_total_amount","refund_extend_fee"].includes(e.property)&&(a[n]=(a[n]/100).toFixed(2)))}),a},changeCustomDate(){this.fetchDataList()},handleTabSelect(e){this.tabType=e,this.autoSetDateType(),"custom"!==e&&this.fetchDataList()},autoSetDateType(){const{startDay:e,endDay:t}=this.getReqDateRange();this.reqData.dateType=t-e>82944e5?"month":"day"}}},S=$,L=(a("6381"),Object(D["a"])(S,n,s,!1,null,null,null));t["default"]=L.exports}}]);