(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-55e511d2"],{"48d8":function(e,t,a){"use strict";a("f8cb")},"77e5":function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"app-container"},[a("div",{staticClass:"aux-card"},[a("div",{staticClass:"header"},[a("div",{staticClass:"left"},[a("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){return e.$refs.printerDialog.open()}}},[e._v("新增设备")])],1),a("div",{staticClass:"right"},[a("el-select",{staticClass:"margin-right-sm",staticStyle:{width:"100px"},attrs:{clearable:""},on:{change:e.changeState},model:{value:e.reqData.state,callback:function(t){e.$set(e.reqData,"state",t)},expression:"reqData.state"}},e._l(e.states,(function(e,t){return a("el-option",{key:e.value,attrs:{value:e.value,label:e.name}})})),1),a("el-input",{staticStyle:{width:"320px"},attrs:{"prefix-icon":"el-icon-search",clearable:"",placeholder:"请输入关键词搜索"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.changeKeyword(t)}},model:{value:e.reqData.keyword,callback:function(t){e.$set(e.reqData,"keyword",t)},expression:"reqData.keyword"}})],1)]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataLoading,expression:"dataLoading"}],staticClass:"aux-table",attrs:{data:e.dataList,border:""}},[a("el-table-column",{attrs:{type:"selection",width:"55",align:"center"}}),a("el-table-column",{attrs:{align:"left",width:"160",label:"打印机名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.name))]}}])}),a("el-table-column",{attrs:{align:"left",label:"服务地址"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.service_url))]}}])}),a("el-table-column",{attrs:{align:"left",label:"设备编号"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.device_id))]}}])}),a("el-table-column",{attrs:{align:"left",label:"设备说明"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.row.desc))]}}])}),a("el-table-column",{attrs:{width:"90",align:"center",label:"状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e._f("formatStateText")(t.row.state||1)))])]}}])}),a("el-table-column",{attrs:{width:"260",align:"center",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.editPrinter(t.row,t.$index)}}},[e._v("编辑")]),a("el-button",{attrs:{type:"text"},on:{click:function(a){return e.deletePrinter(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"padding dflex-c"},[a("el-pagination",{attrs:{background:"","page-size":e.pagination.pageSize,total:e.pagination.totalCount,"current-page":e.pagination.pageNo,"page-sizes":[15,20,50],layout:"total, prev, pager, next","hide-on-single-page":""},on:{"size-change":e.changePageSize,"current-change":e.changePageNo}})],1)],1),a("printerDialog",{ref:"printerDialog",on:{change:e.fetchDataList}})],1)},n=[],r=a("2197"),l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"新增云打印设备",visible:e.dialogVisible,width:"500px"},on:{"update:visible":function(t){e.dialogVisible=t}}},[a("el-form",{ref:"elForm",staticClass:"demo-formData",attrs:{model:e.formData,"status-icon":"",rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"打印机名称",prop:"name"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请填写打印设备名称",clearable:""},model:{value:e.formData.name,callback:function(t){e.$set(e.formData,"name",t)},expression:"formData.name"}})],1),a("el-form-item",{attrs:{label:"服务地址",prop:"service_url"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请填写打印设备服务地址",clearable:""},model:{value:e.formData.service_url,callback:function(t){e.$set(e.formData,"service_url",t)},expression:"formData.service_url"}})],1),a("el-form-item",{attrs:{label:"设备编号",prop:"device_id"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请填写打印设备编号",clearable:""},model:{value:e.formData.device_id,callback:function(t){e.$set(e.formData,"device_id",t)},expression:"formData.device_id"}})],1),a("el-form-item",{attrs:{label:"备注说明",prop:"desc"}},[a("el-input",{staticStyle:{width:"90%"},attrs:{placeholder:"请填写备注说明",clearable:""},model:{value:e.formData.desc,callback:function(t){e.$set(e.formData,"desc",t)},expression:"formData.desc"}})],1)],1),a("div",{staticClass:"dflex-e padding-top-sm"},[a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("保存")]),a("el-button",{attrs:{type:"default"},on:{click:e.close}},[e._v("取消")])],1)],1)},s=[],o={name:"PrinterDialog",props:{},data(){return{dialogVisible:!1,dataLoading:!1,printerId:"",formData:{_id:"",name:"",desc:"",type:"cloud-trans",service_url:"",device_id:""},rules:{name:[{required:!0,message:"请填写打印设备名称",trigger:"blur"},{min:2,max:16,message:"长度在 2 到 16 个字符",trigger:"blur"}],service_url:[{required:!0,message:"请填写打印设备服务地址",trigger:"blur"}],device_id:[{required:!0,message:"请填写打印设备编号",trigger:"blur"}]}}},computed:{},methods:{async fetchData(){this.dataLoading=!0,Object(r["a"])("printer/getPrinter",{printerId:this.printerId},{functionName:"xunda"}).then(e=>{this.dataLoading=!1,this.formData=e.data})},submit(){this.$refs["elForm"].validate(e=>{e&&Object(r["a"])("printer/savePrinter",this.formData,{functionName:"xunda"}).then(e=>{this.$message.success("保存成功"),setTimeout(()=>{this.$emit("change"),this.close()},300)})})},open(e={}){e._id&&(this.formData={_id:e._id,name:e.name,desc:e.desc||"",type:"cloud-trans",service_url:e.service_url||"",device_id:e.device_id||""}),this.dialogVisible=!0},close(){this.dialogVisible=!1}}},c=o,d=(a("48d8"),a("2877")),u=Object(d["a"])(c,l,s,!1,null,null,null),p=u.exports,f={components:{printerDialog:p},filters:{formatStateText(e){return 1==e||0==e?"正常":"停用"}},data(){return{permission:"printer-query",states:[{name:"全部",value:""},{name:"启用",value:1},{name:"禁用",value:2}],dataLoading:!1,dataList:[],pagination:{totalCount:1,pageSize:12,pageNo:1},reqData:{state:"",keyword:""}}},mounted(){this.fetchDataList()},methods:{fetchDataList(){this.dataLoading=!0;const e=Object.assign({},this.reqData,this.pagination);Object(r["a"])("printer/listPrinter",e,{functionName:"xunda"}).then(e=>{this.dataList=e.data||[],1==this.pagination.pageNo&&(this.pagination.totalCount=e.totalCount),this.dataLoading=!1})},changeState(){this.$common.debounce(()=>this.fetchDataList(),300,this)()},changeKeyword(){this.fetchDataList()},changePageNo(e){this.pagination.pageNo=e,this.fetchDataList()},changePageSize(e){this.pagination.pageNo=1,this.pagination.pageSize=e,this.fetchDataList()},editPrinter(e,t){this.$refs.printerDialog.open(e)},deletePrinter(e,t){this.$confirm("确定要删除该设备？","警告提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(r["a"])("printer/deletePrinter",{printerId:e._id},{functionName:"xunda"}).then(e=>{this.fetchDataList(),this.$message({type:"success",message:"删除成功!"})})})}}},m=f,g=Object(d["a"])(m,i,n,!1,null,null,null);t["default"]=g.exports},f8cb:function(e,t,a){}}]);