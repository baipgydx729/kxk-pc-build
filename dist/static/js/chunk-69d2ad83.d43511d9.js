(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-69d2ad83"],{"777c":function(e,s){s.tabList=[{name:"销售",values:[],children:["menu-sales-index","menu-sales-orders-create","menu-sales-orders-list","menu-sales-orders-refund","menu-sales-stats","menu-sales-report"]},{name:"商品",values:[],children:["menu-basic-index","menu-goods-list","menu-goods-edit","menu-goods-category","menu-goods-brand","menu-goods-units"]},{name:"进货",values:[],children:["menu-purchase-index","menu-purchase-orders-create","menu-purchase-orders-list","menu-purchase-orders-refund","menu-supplier-list"]},{name:"库存",values:[],children:["menu-stock-index","menu-stock-goods","menu-stock-into","menu-stock-out","menu-stock-transfer","menu-stock-warehouse","menu-stock-inventory"]},{name:"客户",values:[],children:["menu-store-index","menu-store-list","menu-store-edit"]},{name:"财务",values:[],children:["menu-account-index","menu-settle-index","menu-receipt-orders-create","menu-receipt-orders-index","menu-payment-orders-create","menu-payment-orders-index","menu-payment-expenses-create","menu-payment-expenses-index"]},{name:"功能",values:[],children:["menu-xcode-index"]}],s.menus=[{menu_id:"menu-store-index",name:"客户管理",url:"/pages/store/store-list",permission:["store-manage","store-query","store-edit","store-delete","store-query-all"]},{menu_id:"menu-store-edit",name:"客户设置",url:"/pages/store/store-setting",permission:["store-setting"]},{menu_id:"menu-basic-index",name:"基础档案",url:"/pages/basic/basic-index",permission:["basic-manage"]},{menu_id:"menu-goods-list",name:"商品信息",url:"/pages_goods/goods-list",permission:["goods-query","goods-edit","goods-delete"]},{menu_id:"menu-goods-category",name:"商品分类",url:"/pages_goods/goods-category-list",permission:["goods-category-query","goods-category-edit","goods-category-delete"]},{menu_id:"menu-goods-brand",name:"商品品牌",url:"/pages_goods/goods-brand",permission:["goods-brand-query","goods-brand-edit","goods-brand-delete"]},{menu_id:"menu-goods-units",name:"单位设置",url:"/pages_goods/goods-unit",permission:["goods-units-query","goods-units-edit","goods-units-delete"]},{menu_id:"menu-sales-index",name:"销售管理",url:"/pages/sales/sales-index",permission:["sales-manage"]},{menu_id:"menu-sales-orders-create",name:"销售开单",url:"/pages_sales/orders/orders-list",permission:["sales-orders-query","sales-orders-query-all","sales-orders-create","sales-orders-delete","sales-orders-export","sales-orders-print","sales-orders-approve","sales-orders-deliver","sales-orders-share","sales-orders-outstock","sales-orders-outstock-cancel"]},{menu_id:"menu-sales-orders-refund",name:"销售退货",url:"/pages_sales/orders/orders-refund",permission:["sales-orders-refund-query","sales-orders-refund-query-all","sales-orders-refund-create","sales-orders-refund-delete","sales-orders-refund-intostock","sales-orders-refund-intostock-cancel"]},{menu_id:"menu-sales-stats",name:"销售统计",url:"/pages_sales/sales-stats",permission:["sales-stats","sales-stats-all","sales-store-stats"]},{menu_id:"menu-sales-report",name:"销售报表",url:"/pages_sales/sales-report",permission:["sales-report","sales-report-all","sales-store-report","sales-goods-report","sales-category-report","sales-brand-report","sales-member-report"]},{menu_id:"menu-purchase-index",name:"采购管理",url:"/pages/purchase/purchase-index",permission:["purchase-manage"]},{menu_id:"menu-purchase-orders-create",name:"采购开单",url:"/pages_purchase/purchase-orders-list",permission:["purchase-orders-query","purchase-orders-query-all","purchase-orders-create","purchase-orders-delete","purchase-orders-intostock","purchase-orders-intostock-cancel"]},{menu_id:"menu-purchase-orders-refund",name:"销售退货",url:"/pages_purchase/purchase-orders-refund-list",permission:["purchase-orders-refund-query","purchase-orders-refund-query-all","purchase-orders-refund-create","purchase-orders-refund-delete","purchase-orders-refund-outstock","purchase-orders-refund-outstock-cancel"]},{menu_id:"menu-supplier-list",name:"供 应 商",url:"/pages_purchase/supplier/supplier-list",permission:["supplier-query","supplier-create","supplier-delete"]},{menu_id:"menu-stock-index",name:"库存管理",url:"/pages/stock/stock-index",permission:["stock-manage"]},{menu_id:"menu-stock-goods",name:"库存查询",url:"/pages_stock/stock-goods",permission:["stock-query","stock-stream"]},{menu_id:"menu-stock-into",name:"商品入库",url:"/pages_stock/stock-into",permission:["stock-into"]},{menu_id:"menu-stock-out",name:"商品出库",url:"/pages_stock/stock-out",permission:["stock-out"]},{menu_id:"menu-stock-transfer",name:"库存调拨",url:"/pages_stock/transfer-orders-list",permission:["stock-transfer-orders","stock-transfer-orders-query","stock-transfer-orders-create","stock-transfer-orders-cancel","stock-transfer-orders-delete"]},{menu_id:"menu-stock-warehouse",name:"库存仓库",url:"/pages_stock/stock-warehouse",permission:["stock-warehouse","stock-warehouse-query","stock-warehouse-create","stock-warehouse-delete"]},{menu_id:"menu-stock-inventory",name:"库存盘点",url:"/pages_stock/stock-warehouse",permission:["stock-inventory","stock-inventory-query","stock-inventory-create","stock-inventory-delete"]},{menu_id:"menu-account-index",name:"财务分析",url:"/pages/accounting/accounting-index",permission:["account-manage","account-stats"]},{menu_id:"menu-receipt-orders-create",name:"收款",url:"/pages_settle/receipt/receipt-orders-create",permission:["receipt-orders-query","receipt-orders-create","receipt-orders-delete"]},{menu_id:"menu-receipt-orders-index",name:"收款统计",url:"/pages_settle/receipt/receipt-orders-index",permission:["receipt-orders-stats"]},{menu_id:"menu-payment-orders-create",name:"付款",url:"/pages_settle/payment/payment-orders-create",permission:["payment-orders-query","payment-orders-create","payment-orders-delete"]},{menu_id:"menu-payment-orders-index",name:"付款统计",url:"/pages_settle/payment/payment-orders-index",permission:["payment-orders-stats"]},{menu_id:"menu-payment-expenses-create",name:"费用",url:"/pages_settle/payment/payment-expenses-create",permission:["payment-expenses-query","payment-expenses-create","payment-expenses-delete"]},{menu_id:"menu-payment-expenses-index",name:"费用统计",url:"/pages_settle/payment/payment-expenses-index",permission:["payment-expenses-stats"]},{menu_id:"menu-settle-index",name:"欠款明细",url:"/pages/settle/settle-index",permission:["settle-manage","settle-stats","settle-store-stats","settle-supplier-stats"]},{menu_id:"menu-xcode-index",name:"条码查询",url:"/pages_basic/xcode/xcode-index",permission:["xcode-query"]}],s.permissions=[{permission_id:"store-manage",permission_name:"管理"},{permission_id:"store-query",permission_name:"查询"},{permission_id:"store-edit",permission_name:"新增/编辑"},{permission_id:"store-delete",permission_name:"删除"},{permission_id:"store-setting",permission_name:"设置"},{permission_id:"store-query-all",permission_name:"查询全部客户"},{permission_id:"basic-manage",permission_name:"档案管理"},{permission_id:"goods-query",permission_name:"查询"},{permission_id:"goods-edit",permission_name:"新增/编辑"},{permission_id:"goods-delete",permission_name:"删除"},{permission_id:"goods-category-query",permission_name:"查询"},{permission_id:"goods-category-edit",permission_name:"新增/编辑"},{permission_id:"goods-category-delete",permission_name:"删除"},{permission_id:"goods-brand-query",permission_name:"查询"},{permission_id:"goods-brand-edit",permission_name:"新增/编辑"},{permission_id:"goods-brand-delete",permission_name:"删除"},{permission_id:"goods-units-query",permission_name:"查询"},{permission_id:"goods-units-edit",permission_name:"新增/编辑"},{permission_id:"goods-units-delete",permission_name:"删除"},{permission_id:"sales-manage",permission_name:"查看销售管理"},{permission_id:"sales-orders-query",permission_name:"查询"},{permission_id:"sales-orders-create",permission_name:"新增"},{permission_id:"sales-orders-delete",permission_name:"作废"},{permission_id:"sales-orders-approve",permission_name:"审核"},{permission_id:"sales-orders-deliver",permission_name:"发货"},{permission_id:"sales-orders-export",permission_name:"导出"},{permission_id:"sales-orders-print",permission_name:"打印"},{permission_id:"sales-orders-share",permission_name:"发送单据"},{permission_id:"sales-orders-outstock",permission_name:"出库"},{permission_id:"sales-orders-outstock-cancel",permission_name:"撤销出库"},{permission_id:"sales-orders-query-all",permission_name:"其他成员订单"},{permission_id:"sales-orders-refund-query",permission_name:"查询"},{permission_id:"sales-orders-refund-create",permission_name:"新增"},{permission_id:"sales-orders-refund-delete",permission_name:"作废"},{permission_id:"sales-orders-refund-intostock",permission_name:"入库"},{permission_id:"sales-orders-refund-intostock-cancel",permission_name:"入库撤销"},{permission_id:"sales-orders-refund-query-all",permission_name:"其他成员订单"},{permission_id:"sales-stats",permission_name:"销售统计"},{permission_id:"sales-stats-all",permission_name:"全部成员统计"},{permission_id:"sales-store-stats",permission_name:"客户销售统计"},{permission_id:"sales-all-stats",permission_name:"客户销售统计"},{permission_id:"sales-report",permission_name:"查看报表"},{permission_id:"sales-report-all",permission_name:"全部成员报表"},{permission_id:"sales-store-report",permission_name:"客户报表"},{permission_id:"sales-goods-report",permission_name:"商品报表"},{permission_id:"sales-category-report",permission_name:"类目报表"},{permission_id:"sales-brand-report",permission_name:"品牌报表"},{permission_id:"sales-member-report",permission_name:"员工报表"},{permission_id:"purchase-manage",permission_name:"采购管理"},{permission_id:"purchase-orders-query",permission_name:"查询"},{permission_id:"purchase-orders-create",permission_name:"新增"},{permission_id:"purchase-orders-delete",permission_name:"作废"},{permission_id:"purchase-orders-intostock",permission_name:"入库"},{permission_id:"purchase-orders-intostock-cancel",permission_name:"入库撤销"},{permission_id:"purchase-orders-query-all",permission_name:"其他成员订单"},{permission_id:"purchase-orders-refund-query",permission_name:"查询"},{permission_id:"purchase-orders-refund-create",permission_name:"新增"},{permission_id:"purchase-orders-refund-delete",permission_name:"作废"},{permission_id:"purchase-orders-refund-outstock",permission_name:"出库"},{permission_id:"purchase-orders-refund-outstock-cancel",permission_name:"出库撤销"},{permission_id:"purchase-orders-refund-query-all",permission_name:"其他成员订单"},{permission_id:"supplier-query",permission_name:"查询"},{permission_id:"supplier-create",permission_name:"新增"},{permission_id:"supplier-delete",permission_name:"删除"},{permission_id:"stock-manage",permission_name:"库存管理"},{permission_id:"stock-query",permission_name:"库存查询"},{permission_id:"stock-stream",permission_name:"变动明细"},{permission_id:"stock-into-query",permission_name:"查询"},{permission_id:"stock-into",permission_name:"入库操作"},{permission_id:"stock-out",permission_name:"出库操作"},{permission_id:"stock-warehouse",permission_name:"管理"},{permission_id:"stock-warehouse-query",permission_name:"查询"},{permission_id:"stock-warehouse-create",permission_name:"新增/编辑"},{permission_id:"stock-warehouse-delete",permission_name:"删除"},{permission_id:"stock-inventory",permission_name:"管理"},{permission_id:"stock-inventory-query",permission_name:"查询"},{permission_id:"stock-inventory-create",permission_name:"新增/编辑"},{permission_id:"stock-inventory-delete",permission_name:"删除"},{permission_id:"stock-transfer-orders",permission_name:"管理"},{permission_id:"stock-transfer-orders-query",permission_name:"查询"},{permission_id:"stock-transfer-orders-create",permission_name:"新增"},{permission_id:"stock-transfer-orders-cancel",permission_name:"撤销调拨"},{permission_id:"stock-transfer-orders-delete",permission_name:"作废"},{permission_id:"receipt-orders-query",permission_name:"查询"},{permission_id:"receipt-orders-create",permission_name:"新增"},{permission_id:"receipt-orders-delete",permission_name:"作废"},{permission_id:"payment-orders-query",permission_name:"查询"},{permission_id:"payment-orders-create",permission_name:"新增"},{permission_id:"payment-orders-delete",permission_name:"作废"},{permission_id:"payment-expenses-query",permission_name:"查询"},{permission_id:"payment-expenses-create",permission_name:"新增"},{permission_id:"payment-expenses-delete",permission_name:"作废"},{permission_id:"receipt-orders-stats",permission_name:"收款统计"},{permission_id:"payment-orders-stats",permission_name:"付款统计"},{permission_id:"payment-expenses-stats",permission_name:"费用统计"},{permission_id:"account-manage",permission_name:"财务管理"},{permission_id:"account-stats",permission_name:"财务统计"},{permission_id:"settle-manage",permission_name:"欠款管理"},{permission_id:"settle-stats",permission_name:"欠款统计"},{permission_id:"settle-store-stats",permission_name:"客户结算统计"},{permission_id:"settle-supplier-stats",permission_name:"供应商结算统计"},{permission_id:"xcode-query",permission_name:"条码查询"}],s.sysRole={saler:["store-manage","store-query","sales-manage","sales-orders-create","sales-orders-delete","sales-orders-query","sales-orders-refund-create","sales-orders-refund-query","sales-orders-refund-delete","sales-report","sales-store-report","stock-query","goods-query","xcode-query"],purchaser:["purchase-manage","purchase-orders-create","purchase-orders-delete","purchase-orders-query","purchase-orders-query-all","payment-orders-query","settle-supplier-stats","goods-query","supplier-create","supplier-delete","supplier-query"],stocker:["sales-orders-query","sales-orders-query-all","sales-orders-outstock","sales-orders-refund-query","sales-orders-refund-query-all","sales-orders-refund-intostock","sales-orders-refund-intostock-cancel","purchase-manage","purchase-orders-query","purchase-orders-intostock","purchase-orders-intostock-cancel","stock-manage","stock-query","stock-into","stock-stream","stock-warehouse","stock-inventory","stock-transfer-orders","stock-transfer-orders-cancel","stock-transfer-orders-delete","xcode-query"],finance:["store-manage","store-query","store-query-all","sales-manage","sales-orders-query","sales-orders-query-all","sales-stats","sales-stats-all","sales-store-stats","sales-report","sales-report-all","sales-store-report","sales-goods-report","sales-category-report","sales-brand-report","sales-member-report","purchase-manage","purchase-orders-query","stock-query","account-manage","account-stats","receipt-orders-create","receipt-orders-delete","receipt-orders-query","receipt-orders-stats","payment-orders-create","payment-orders-delete","payment-orders-query","payment-orders-stats","payment-expenses-create","payment-expenses-delete","payment-expenses-query","payment-expenses-stats","settle-manage","settle-stats","settle-store-stats","settle-supplier-stats","goods-query","xcode-query"]}},"82eb":function(e,s,r){"use strict";r.r(s);var n=function(){var e=this,s=e.$createElement,r=e._self._c||s;return r("div",{staticClass:"app-container"},[r("el-form",{ref:"formData",attrs:{"label-width":"90px","label-align":"left",inline:!0}},[r("div",{staticClass:"aux-card"},[r("div",{staticClass:"header"},[r("div",{staticClass:"left title"},[e._v(" 角色权限配置 "),r("span",{staticClass:"ft-primary"},[e._v("("+e._s(e.formData.role_name)+")")])]),r("div",{staticClass:"right"},[r("el-dropdown",{staticClass:"margin-right-sm",on:{command:e.batchSetPermission}},[r("el-button",{attrs:{type:"defaunt"}},[e._v(" 一键自动设置 "),r("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),r("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},e._l(e.autoRoles,(function(s,n){return r("el-dropdown-item",{key:n,attrs:{command:s}},[e._v(e._s(s.text))])})),1)],1),r("el-button",{attrs:{type:"default",icon:"el-icon-tickets"},on:{click:function(s){return e.$common.closePage()}}},[e._v("取消")]),r("el-button",{attrs:{type:"primary",icon:"el-icon-document-checked"},on:{click:e.handleSave}},[e._v("保存")])],1)]),r("el-table",{staticClass:"cu-tables",attrs:{data:e.tabList,"span-method":e.objectSpanMethod,border:""}},[r("el-table-column",{attrs:{align:"left",width:"150",label:"一级"},scopedSlots:e._u([{key:"default",fn:function(s){return[r("el-checkbox",{attrs:{indeterminate:e.getIndeterminateOne(s.row),label:s.row.name},on:{change:function(r){return e.handleCheckAllOne(s.row)}},model:{value:s.row.checkAll,callback:function(r){e.$set(s.row,"checkAll",r)},expression:"scope.row.checkAll"}},[e._v(e._s(s.row.name))])]}}])}),r("el-table-column",{attrs:{align:"left",width:"200",label:"二级"},scopedSlots:e._u([{key:"default",fn:function(s){return[r("el-table",{staticClass:"aux-table",attrs:{data:e.getMenus(s.row),"show-header":!1,stripe:""}},[r("el-table-column",{attrs:{align:"left",width:"200",label:"二级"},scopedSlots:e._u([{key:"default",fn:function(s){return[r("el-checkbox",{attrs:{indeterminate:e.getIndeterminateTwo(s.row),label:s.row.menu_id},on:{change:function(r){return e.handleCheckAllTwo(s.row)}},model:{value:s.row.checkAll,callback:function(r){e.$set(s.row,"checkAll",r)},expression:"scopev.row.checkAll"}},[e._v(e._s(s.row.name))])]}}],null,!0)}),r("el-table-column",{attrs:{align:"left",label:"权限配置"},scopedSlots:e._u([{key:"default",fn:function(s){return[r("div",{staticClass:"padding-lr-sm"},[r("el-checkbox-group",{model:{value:e.formData.permission,callback:function(s){e.$set(e.formData,"permission",s)},expression:"formData.permission"}},e._l(e.getPermissions(s.row),(function(s){return r("el-checkbox",{key:s.permission_id,attrs:{label:s.permission_id}},[e._v(e._s(s.permission_name))])})),1)],1)]}}],null,!0)})],1)]}}])}),r("el-table-column",{attrs:{align:"left",label:"权限配置明细"}})],1)],1)])],1)},i=[],o=r("2909"),t=(r("d81d"),r("4de4"),r("d3b7"),r("caad"),r("2532"),r("159b"),r("2197")),a=r("777c"),m={data:function(){return{permission:"admin",tabList:[],roleId:"",formData:{role_name:"",permission:[],remark:""},autoRoles:[{text:"销售权限",permissions:a["sysRole"].saler},{text:"采购权限",permissions:a["sysRole"].purchaser},{text:"仓管权限",permissions:a["sysRole"].stocker},{text:"财务权限",permissions:a["sysRole"].finance}]}},mounted:function(){var e=this.$route.params.roleId;this.roleId=e,this.fetchRoleInfo(),this.tabList=a["tabList"].map((function(e){return e.checkAll=!1,e}))},methods:{fetchRoleInfo:function(){var e=this;Object(t["a"])("member/getRole",{roleId:this.roleId},{functionName:"xunda"}).then((function(s){e.formData=Object.assign({permission:[]},s.data)}))},batchSetPermission:function(e){this.formData.permission=Object(o["a"])(e.permissions),this.$message.success("自动设置完成")},getMenus:function(e){var s=e.children||[];return a["menus"].filter((function(e){return s.includes(e.menu_id)})).map((function(e){return e.checkAll=!0,e}))},getPermissions:function(e){var s=e.permission||[];return a["permissions"].filter((function(e){return s.includes(e.permission_id)}))},handleSave:function(){var e=this,s={roleId:this.roleId,permission:this.formData.permission};Object(t["a"])("member/saveRolePermission",s,{functionName:"xunda"}).then((function(s){e.$message.success("保存成功"),setTimeout((function(){return e.$common.closePage()}),300)}))},handleCheckAllOne:function(e){var s=this,r=[];this.getMenus(e).forEach((function(e){return r.push.apply(r,Object(o["a"])(e.permission))})),this.formData.permission=this.formData.permission||[],this.$nextTick((function(){e.checkAll?s.formData.permission=s.formData.permission.filter((function(e){return!r.includes(e)})):r.forEach((function(e){s.formData.permission.includes(e)||s.formData.permission.push(e)}))}))},getIndeterminateOne:function(e){var s=[];this.getMenus(e).forEach((function(e){return s.push.apply(s,Object(o["a"])(e.permission))}));var r=this.existPermission(s);return e.checkAll=r.checkAll,r.checked},handleCheckAllTwo:function(e){var s=this;this.$nextTick((function(){e.checkAll?s.formData.permission=s.formData.permission.filter((function(s){return!e.permission.includes(s)})):e.permission.forEach((function(e){s.formData.permission.includes(e)||s.formData.permission.push(e)}))}))},getIndeterminateTwo:function(e){var s=this.existPermission(e.permission);return e.checkAll=s.checkAll,s.checked},existPermission:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],s=0,r=this.formData.permission||[];return e.forEach((function(e){r.includes(e)&&s++})),{checked:s>0&&s<e.length,checkAll:s===e.length}},objectSpanMethod:function(e){e.row,e.column,e.rowIndex;var s=e.columnIndex;return 1===s?[1,2]:1===s?[0,0]:void 0}}},d=m,p=(r("c2ff"),r("2877")),l=Object(p["a"])(d,n,i,!1,null,null,null);s["default"]=l.exports},"85e9":function(e,s,r){},c2ff:function(e,s,r){"use strict";r("85e9")}}]);